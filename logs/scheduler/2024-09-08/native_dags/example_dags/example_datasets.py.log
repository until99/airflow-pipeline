[2024-09-08T15:26:49.195-0300] {processor.py:186} INFO - Started process (PID=31786) to work on /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T15:26:49.196-0300] {processor.py:914} INFO - Processing file /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py for tasks to queue
[2024-09-08T15:26:49.197-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:26:49.197-0300] {dagbag.py:587} INFO - Filling up the DagBag from /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T15:26:49.206-0300] {processor.py:925} INFO - DAG(s) 'dataset_produces_2', 'consume_1_or_both_2_and_3_with_dataset_expressions', 'conditional_dataset_and_time_based_timetable', 'dataset_consumes_1_never_scheduled', 'consume_1_or_2_with_dataset_expressions', 'consume_1_and_2_with_dataset_expressions', 'dataset_produces_1', 'dataset_consumes_unknown_never_scheduled', 'dataset_consumes_1', 'dataset_consumes_1_and_2' retrieved from /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T15:26:49.229-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:26:49.229-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T15:26:49.318-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:26:49.318-0300] {dag.py:4156} INFO - Setting next_dagrun for conditional_dataset_and_time_based_timetable to 2024-09-04 01:00:00+00:00, run_after=2024-09-04 01:00:00+00:00
[2024-09-08T15:26:49.321-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:26:49.321-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_and_2_with_dataset_expressions to None, run_after=None
[2024-09-08T15:26:49.321-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:26:49.321-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_2_with_dataset_expressions to None, run_after=None
[2024-09-08T15:26:49.322-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:26:49.322-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_both_2_and_3_with_dataset_expressions to None, run_after=None
[2024-09-08T15:26:49.322-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:26:49.322-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1 to None, run_after=None
[2024-09-08T15:26:49.323-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:26:49.323-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_and_2 to None, run_after=None
[2024-09-08T15:26:49.324-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:26:49.323-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_never_scheduled to None, run_after=None
[2024-09-08T15:26:49.324-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:26:49.324-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_unknown_never_scheduled to None, run_after=None
[2024-09-08T15:26:49.325-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:26:49.325-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_1 to 2024-09-07 00:00:00+00:00, run_after=2024-09-08 00:00:00+00:00
[2024-09-08T15:26:49.326-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:26:49.326-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_2 to None, run_after=None
[2024-09-08T15:26:49.349-0300] {processor.py:208} INFO - Processing /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py took 0.157 seconds
[2024-09-08T15:27:47.496-0300] {processor.py:186} INFO - Started process (PID=32128) to work on /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T15:27:47.500-0300] {processor.py:914} INFO - Processing file /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py for tasks to queue
[2024-09-08T15:27:47.502-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:27:47.502-0300] {dagbag.py:587} INFO - Filling up the DagBag from /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T15:27:47.513-0300] {processor.py:925} INFO - DAG(s) 'consume_1_or_both_2_and_3_with_dataset_expressions', 'dataset_consumes_1_and_2', 'dataset_consumes_1', 'consume_1_or_2_with_dataset_expressions', 'dataset_consumes_unknown_never_scheduled', 'dataset_produces_2', 'conditional_dataset_and_time_based_timetable', 'dataset_produces_1', 'dataset_consumes_1_never_scheduled', 'consume_1_and_2_with_dataset_expressions' retrieved from /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T15:27:47.539-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:27:47.539-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T15:27:47.556-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:27:47.556-0300] {dag.py:4156} INFO - Setting next_dagrun for conditional_dataset_and_time_based_timetable to 2024-09-04 01:00:00+00:00, run_after=2024-09-04 01:00:00+00:00
[2024-09-08T15:27:47.559-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:27:47.559-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_and_2_with_dataset_expressions to None, run_after=None
[2024-09-08T15:27:47.561-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:27:47.561-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_2_with_dataset_expressions to None, run_after=None
[2024-09-08T15:27:47.561-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:27:47.561-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_both_2_and_3_with_dataset_expressions to None, run_after=None
[2024-09-08T15:27:47.562-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:27:47.562-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1 to None, run_after=None
[2024-09-08T15:27:47.562-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:27:47.562-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_and_2 to None, run_after=None
[2024-09-08T15:27:47.563-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:27:47.563-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_never_scheduled to None, run_after=None
[2024-09-08T15:27:47.563-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:27:47.563-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_unknown_never_scheduled to None, run_after=None
[2024-09-08T15:27:47.565-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:27:47.565-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_1 to 2024-09-07 00:00:00+00:00, run_after=2024-09-08 00:00:00+00:00
[2024-09-08T15:27:47.565-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:27:47.565-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_2 to None, run_after=None
[2024-09-08T15:27:47.591-0300] {processor.py:208} INFO - Processing /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py took 0.099 seconds
[2024-09-08T15:29:04.898-0300] {processor.py:186} INFO - Started process (PID=32347) to work on /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T15:29:04.899-0300] {processor.py:914} INFO - Processing file /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py for tasks to queue
[2024-09-08T15:29:04.901-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:29:04.900-0300] {dagbag.py:587} INFO - Filling up the DagBag from /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T15:29:04.910-0300] {processor.py:925} INFO - DAG(s) 'consume_1_or_2_with_dataset_expressions', 'consume_1_or_both_2_and_3_with_dataset_expressions', 'consume_1_and_2_with_dataset_expressions', 'dataset_consumes_unknown_never_scheduled', 'dataset_consumes_1_and_2', 'conditional_dataset_and_time_based_timetable', 'dataset_consumes_1_never_scheduled', 'dataset_produces_1', 'dataset_produces_2', 'dataset_consumes_1' retrieved from /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T15:29:04.931-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:29:04.931-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T15:29:04.948-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:29:04.948-0300] {dag.py:4156} INFO - Setting next_dagrun for conditional_dataset_and_time_based_timetable to 2024-09-04 01:00:00+00:00, run_after=2024-09-04 01:00:00+00:00
[2024-09-08T15:29:04.951-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:29:04.950-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_and_2_with_dataset_expressions to None, run_after=None
[2024-09-08T15:29:04.951-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:29:04.951-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_2_with_dataset_expressions to None, run_after=None
[2024-09-08T15:29:04.952-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:29:04.952-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_both_2_and_3_with_dataset_expressions to None, run_after=None
[2024-09-08T15:29:04.952-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:29:04.952-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1 to None, run_after=None
[2024-09-08T15:29:04.953-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:29:04.953-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_and_2 to None, run_after=None
[2024-09-08T15:29:04.954-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:29:04.954-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_never_scheduled to None, run_after=None
[2024-09-08T15:29:04.955-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:29:04.954-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_unknown_never_scheduled to None, run_after=None
[2024-09-08T15:29:04.956-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:29:04.956-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_1 to 2024-09-07 00:00:00+00:00, run_after=2024-09-08 00:00:00+00:00
[2024-09-08T15:29:04.957-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:29:04.957-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_2 to None, run_after=None
[2024-09-08T15:29:04.982-0300] {processor.py:208} INFO - Processing /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py took 0.087 seconds
[2024-09-08T15:30:21.825-0300] {processor.py:186} INFO - Started process (PID=32646) to work on /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T15:30:21.832-0300] {processor.py:914} INFO - Processing file /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py for tasks to queue
[2024-09-08T15:30:21.834-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:30:21.833-0300] {dagbag.py:587} INFO - Filling up the DagBag from /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T15:30:21.844-0300] {processor.py:925} INFO - DAG(s) 'dataset_consumes_1_never_scheduled', 'dataset_produces_2', 'consume_1_or_2_with_dataset_expressions', 'dataset_consumes_unknown_never_scheduled', 'dataset_consumes_1_and_2', 'conditional_dataset_and_time_based_timetable', 'dataset_consumes_1', 'consume_1_or_both_2_and_3_with_dataset_expressions', 'dataset_produces_1', 'consume_1_and_2_with_dataset_expressions' retrieved from /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T15:30:21.868-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:30:21.868-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T15:30:21.885-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:30:21.884-0300] {dag.py:4156} INFO - Setting next_dagrun for conditional_dataset_and_time_based_timetable to 2024-09-04 01:00:00+00:00, run_after=2024-09-04 01:00:00+00:00
[2024-09-08T15:30:21.887-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:30:21.887-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_and_2_with_dataset_expressions to None, run_after=None
[2024-09-08T15:30:21.888-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:30:21.888-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_2_with_dataset_expressions to None, run_after=None
[2024-09-08T15:30:21.888-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:30:21.888-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_both_2_and_3_with_dataset_expressions to None, run_after=None
[2024-09-08T15:30:21.889-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:30:21.889-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1 to None, run_after=None
[2024-09-08T15:30:21.889-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:30:21.889-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_and_2 to None, run_after=None
[2024-09-08T15:30:21.890-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:30:21.890-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_never_scheduled to None, run_after=None
[2024-09-08T15:30:21.890-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:30:21.890-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_unknown_never_scheduled to None, run_after=None
[2024-09-08T15:30:21.892-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:30:21.892-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_1 to 2024-09-07 00:00:00+00:00, run_after=2024-09-08 00:00:00+00:00
[2024-09-08T15:30:21.893-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:30:21.892-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_2 to None, run_after=None
[2024-09-08T15:30:21.918-0300] {processor.py:208} INFO - Processing /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py took 0.096 seconds
[2024-09-08T15:31:34.930-0300] {processor.py:186} INFO - Started process (PID=32869) to work on /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T15:31:34.931-0300] {processor.py:914} INFO - Processing file /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py for tasks to queue
[2024-09-08T15:31:34.932-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:31:34.932-0300] {dagbag.py:587} INFO - Filling up the DagBag from /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T15:31:34.943-0300] {processor.py:925} INFO - DAG(s) 'consume_1_or_both_2_and_3_with_dataset_expressions', 'conditional_dataset_and_time_based_timetable', 'dataset_consumes_unknown_never_scheduled', 'dataset_consumes_1_never_scheduled', 'consume_1_and_2_with_dataset_expressions', 'dataset_produces_2', 'dataset_consumes_1_and_2', 'dataset_consumes_1', 'consume_1_or_2_with_dataset_expressions', 'dataset_produces_1' retrieved from /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T15:31:34.976-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:31:34.976-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T15:31:34.995-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:31:34.995-0300] {dag.py:4156} INFO - Setting next_dagrun for conditional_dataset_and_time_based_timetable to 2024-09-04 01:00:00+00:00, run_after=2024-09-04 01:00:00+00:00
[2024-09-08T15:31:34.998-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:31:34.998-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_and_2_with_dataset_expressions to None, run_after=None
[2024-09-08T15:31:34.998-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:31:34.998-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_2_with_dataset_expressions to None, run_after=None
[2024-09-08T15:31:34.999-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:31:34.999-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_both_2_and_3_with_dataset_expressions to None, run_after=None
[2024-09-08T15:31:35.000-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:31:35.000-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1 to None, run_after=None
[2024-09-08T15:31:35.000-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:31:35.000-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_and_2 to None, run_after=None
[2024-09-08T15:31:35.001-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:31:35.001-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_never_scheduled to None, run_after=None
[2024-09-08T15:31:35.001-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:31:35.001-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_unknown_never_scheduled to None, run_after=None
[2024-09-08T15:31:35.003-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:31:35.003-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_1 to 2024-09-07 00:00:00+00:00, run_after=2024-09-08 00:00:00+00:00
[2024-09-08T15:31:35.003-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:31:35.003-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_2 to None, run_after=None
[2024-09-08T15:31:35.032-0300] {processor.py:208} INFO - Processing /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py took 0.108 seconds
[2024-09-08T15:32:47.862-0300] {processor.py:186} INFO - Started process (PID=33067) to work on /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T15:32:47.862-0300] {processor.py:914} INFO - Processing file /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py for tasks to queue
[2024-09-08T15:32:47.863-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:32:47.863-0300] {dagbag.py:587} INFO - Filling up the DagBag from /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T15:32:47.875-0300] {processor.py:925} INFO - DAG(s) 'dataset_consumes_1', 'dataset_produces_2', 'consume_1_or_both_2_and_3_with_dataset_expressions', 'consume_1_and_2_with_dataset_expressions', 'dataset_consumes_unknown_never_scheduled', 'dataset_produces_1', 'consume_1_or_2_with_dataset_expressions', 'conditional_dataset_and_time_based_timetable', 'dataset_consumes_1_and_2', 'dataset_consumes_1_never_scheduled' retrieved from /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T15:32:47.899-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:32:47.899-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T15:32:47.917-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:32:47.917-0300] {dag.py:4156} INFO - Setting next_dagrun for conditional_dataset_and_time_based_timetable to 2024-09-04 01:00:00+00:00, run_after=2024-09-04 01:00:00+00:00
[2024-09-08T15:32:47.920-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:32:47.920-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_and_2_with_dataset_expressions to None, run_after=None
[2024-09-08T15:32:47.921-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:32:47.920-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_2_with_dataset_expressions to None, run_after=None
[2024-09-08T15:32:47.921-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:32:47.921-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_both_2_and_3_with_dataset_expressions to None, run_after=None
[2024-09-08T15:32:47.922-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:32:47.922-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1 to None, run_after=None
[2024-09-08T15:32:47.923-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:32:47.923-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_and_2 to None, run_after=None
[2024-09-08T15:32:47.925-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:32:47.924-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_never_scheduled to None, run_after=None
[2024-09-08T15:32:47.927-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:32:47.926-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_unknown_never_scheduled to None, run_after=None
[2024-09-08T15:32:47.929-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:32:47.929-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_1 to 2024-09-07 00:00:00+00:00, run_after=2024-09-08 00:00:00+00:00
[2024-09-08T15:32:47.929-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:32:47.929-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_2 to None, run_after=None
[2024-09-08T15:32:47.954-0300] {processor.py:208} INFO - Processing /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py took 0.098 seconds
[2024-09-08T15:34:00.906-0300] {processor.py:186} INFO - Started process (PID=33420) to work on /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T15:34:00.907-0300] {processor.py:914} INFO - Processing file /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py for tasks to queue
[2024-09-08T15:34:00.908-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:34:00.907-0300] {dagbag.py:587} INFO - Filling up the DagBag from /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T15:34:00.918-0300] {processor.py:925} INFO - DAG(s) 'dataset_consumes_1_and_2', 'dataset_produces_2', 'consume_1_or_both_2_and_3_with_dataset_expressions', 'conditional_dataset_and_time_based_timetable', 'dataset_consumes_1', 'dataset_consumes_unknown_never_scheduled', 'dataset_produces_1', 'dataset_consumes_1_never_scheduled', 'consume_1_and_2_with_dataset_expressions', 'consume_1_or_2_with_dataset_expressions' retrieved from /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T15:34:00.940-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:34:00.940-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T15:34:00.957-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:34:00.957-0300] {dag.py:4156} INFO - Setting next_dagrun for conditional_dataset_and_time_based_timetable to 2024-09-04 01:00:00+00:00, run_after=2024-09-04 01:00:00+00:00
[2024-09-08T15:34:00.960-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:34:00.959-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_and_2_with_dataset_expressions to None, run_after=None
[2024-09-08T15:34:00.960-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:34:00.960-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_2_with_dataset_expressions to None, run_after=None
[2024-09-08T15:34:00.961-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:34:00.961-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_both_2_and_3_with_dataset_expressions to None, run_after=None
[2024-09-08T15:34:00.961-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:34:00.961-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1 to None, run_after=None
[2024-09-08T15:34:00.962-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:34:00.962-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_and_2 to None, run_after=None
[2024-09-08T15:34:00.963-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:34:00.963-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_never_scheduled to None, run_after=None
[2024-09-08T15:34:00.963-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:34:00.963-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_unknown_never_scheduled to None, run_after=None
[2024-09-08T15:34:00.965-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:34:00.964-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_1 to 2024-09-07 00:00:00+00:00, run_after=2024-09-08 00:00:00+00:00
[2024-09-08T15:34:00.965-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:34:00.965-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_2 to None, run_after=None
[2024-09-08T15:34:01.005-0300] {processor.py:208} INFO - Processing /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py took 0.102 seconds
[2024-09-08T15:36:01.286-0300] {processor.py:186} INFO - Started process (PID=33926) to work on /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T15:36:01.287-0300] {processor.py:914} INFO - Processing file /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py for tasks to queue
[2024-09-08T15:36:01.289-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:36:01.289-0300] {dagbag.py:587} INFO - Filling up the DagBag from /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T15:36:01.301-0300] {processor.py:925} INFO - DAG(s) 'consume_1_or_2_with_dataset_expressions', 'conditional_dataset_and_time_based_timetable', 'dataset_consumes_unknown_never_scheduled', 'dataset_consumes_1_never_scheduled', 'dataset_produces_2', 'consume_1_or_both_2_and_3_with_dataset_expressions', 'dataset_consumes_1', 'dataset_produces_1', 'consume_1_and_2_with_dataset_expressions', 'dataset_consumes_1_and_2' retrieved from /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T15:36:01.334-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:36:01.334-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T15:36:01.358-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:36:01.358-0300] {dag.py:4156} INFO - Setting next_dagrun for conditional_dataset_and_time_based_timetable to 2024-09-04 01:00:00+00:00, run_after=2024-09-04 01:00:00+00:00
[2024-09-08T15:36:01.361-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:36:01.361-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_and_2_with_dataset_expressions to None, run_after=None
[2024-09-08T15:36:01.362-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:36:01.361-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_2_with_dataset_expressions to None, run_after=None
[2024-09-08T15:36:01.362-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:36:01.362-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_both_2_and_3_with_dataset_expressions to None, run_after=None
[2024-09-08T15:36:01.363-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:36:01.363-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1 to None, run_after=None
[2024-09-08T15:36:01.363-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:36:01.363-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_and_2 to None, run_after=None
[2024-09-08T15:36:01.364-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:36:01.364-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_never_scheduled to None, run_after=None
[2024-09-08T15:36:01.364-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:36:01.364-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_unknown_never_scheduled to None, run_after=None
[2024-09-08T15:36:01.366-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:36:01.366-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_1 to 2024-09-07 00:00:00+00:00, run_after=2024-09-08 00:00:00+00:00
[2024-09-08T15:36:01.366-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:36:01.366-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_2 to None, run_after=None
[2024-09-08T15:36:01.394-0300] {processor.py:208} INFO - Processing /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py took 0.112 seconds
[2024-09-08T15:36:56.186-0300] {processor.py:186} INFO - Started process (PID=34056) to work on /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T15:36:56.187-0300] {processor.py:914} INFO - Processing file /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py for tasks to queue
[2024-09-08T15:36:56.188-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:36:56.188-0300] {dagbag.py:587} INFO - Filling up the DagBag from /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T15:36:56.199-0300] {processor.py:925} INFO - DAG(s) 'consume_1_or_both_2_and_3_with_dataset_expressions', 'conditional_dataset_and_time_based_timetable', 'dataset_consumes_1_never_scheduled', 'dataset_consumes_1', 'dataset_produces_2', 'dataset_consumes_unknown_never_scheduled', 'dataset_consumes_1_and_2', 'consume_1_or_2_with_dataset_expressions', 'dataset_produces_1', 'consume_1_and_2_with_dataset_expressions' retrieved from /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T15:36:56.224-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:36:56.223-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T15:36:56.241-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:36:56.241-0300] {dag.py:4156} INFO - Setting next_dagrun for conditional_dataset_and_time_based_timetable to 2024-09-04 01:00:00+00:00, run_after=2024-09-04 01:00:00+00:00
[2024-09-08T15:36:56.244-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:36:56.244-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_and_2_with_dataset_expressions to None, run_after=None
[2024-09-08T15:36:56.245-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:36:56.245-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_2_with_dataset_expressions to None, run_after=None
[2024-09-08T15:36:56.246-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:36:56.246-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_both_2_and_3_with_dataset_expressions to None, run_after=None
[2024-09-08T15:36:56.246-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:36:56.246-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1 to None, run_after=None
[2024-09-08T15:36:56.247-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:36:56.247-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_and_2 to None, run_after=None
[2024-09-08T15:36:56.248-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:36:56.248-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_never_scheduled to None, run_after=None
[2024-09-08T15:36:56.248-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:36:56.248-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_unknown_never_scheduled to None, run_after=None
[2024-09-08T15:36:56.250-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:36:56.250-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_1 to 2024-09-07 00:00:00+00:00, run_after=2024-09-08 00:00:00+00:00
[2024-09-08T15:36:56.251-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:36:56.250-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_2 to None, run_after=None
[2024-09-08T15:36:56.276-0300] {processor.py:208} INFO - Processing /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py took 0.093 seconds
[2024-09-08T15:38:09.535-0300] {processor.py:186} INFO - Started process (PID=34325) to work on /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T15:38:09.536-0300] {processor.py:914} INFO - Processing file /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py for tasks to queue
[2024-09-08T15:38:09.537-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:38:09.537-0300] {dagbag.py:587} INFO - Filling up the DagBag from /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T15:38:09.548-0300] {processor.py:925} INFO - DAG(s) 'dataset_consumes_1_never_scheduled', 'conditional_dataset_and_time_based_timetable', 'consume_1_or_both_2_and_3_with_dataset_expressions', 'dataset_consumes_unknown_never_scheduled', 'dataset_consumes_1_and_2', 'dataset_produces_1', 'dataset_consumes_1', 'dataset_produces_2', 'consume_1_and_2_with_dataset_expressions', 'consume_1_or_2_with_dataset_expressions' retrieved from /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T15:38:09.573-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:38:09.573-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T15:38:09.590-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:38:09.590-0300] {dag.py:4156} INFO - Setting next_dagrun for conditional_dataset_and_time_based_timetable to 2024-09-04 01:00:00+00:00, run_after=2024-09-04 01:00:00+00:00
[2024-09-08T15:38:09.593-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:38:09.593-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_and_2_with_dataset_expressions to None, run_after=None
[2024-09-08T15:38:09.593-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:38:09.593-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_2_with_dataset_expressions to None, run_after=None
[2024-09-08T15:38:09.594-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:38:09.594-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_both_2_and_3_with_dataset_expressions to None, run_after=None
[2024-09-08T15:38:09.595-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:38:09.595-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1 to None, run_after=None
[2024-09-08T15:38:09.596-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:38:09.595-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_and_2 to None, run_after=None
[2024-09-08T15:38:09.596-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:38:09.596-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_never_scheduled to None, run_after=None
[2024-09-08T15:38:09.597-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:38:09.597-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_unknown_never_scheduled to None, run_after=None
[2024-09-08T15:38:09.598-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:38:09.598-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_1 to 2024-09-07 00:00:00+00:00, run_after=2024-09-08 00:00:00+00:00
[2024-09-08T15:38:09.599-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:38:09.599-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_2 to None, run_after=None
[2024-09-08T15:38:09.625-0300] {processor.py:208} INFO - Processing /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py took 0.093 seconds
[2024-09-08T15:39:06.474-0300] {processor.py:186} INFO - Started process (PID=34686) to work on /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T15:39:06.475-0300] {processor.py:914} INFO - Processing file /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py for tasks to queue
[2024-09-08T15:39:06.476-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:39:06.476-0300] {dagbag.py:587} INFO - Filling up the DagBag from /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T15:39:06.485-0300] {processor.py:925} INFO - DAG(s) 'dataset_consumes_1_never_scheduled', 'conditional_dataset_and_time_based_timetable', 'dataset_consumes_1_and_2', 'dataset_produces_1', 'consume_1_and_2_with_dataset_expressions', 'consume_1_or_2_with_dataset_expressions', 'dataset_produces_2', 'dataset_consumes_unknown_never_scheduled', 'dataset_consumes_1', 'consume_1_or_both_2_and_3_with_dataset_expressions' retrieved from /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T15:39:06.509-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:39:06.508-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T15:39:06.526-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:39:06.526-0300] {dag.py:4156} INFO - Setting next_dagrun for conditional_dataset_and_time_based_timetable to 2024-09-04 01:00:00+00:00, run_after=2024-09-04 01:00:00+00:00
[2024-09-08T15:39:06.529-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:39:06.529-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_and_2_with_dataset_expressions to None, run_after=None
[2024-09-08T15:39:06.530-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:39:06.530-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_2_with_dataset_expressions to None, run_after=None
[2024-09-08T15:39:06.530-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:39:06.530-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_both_2_and_3_with_dataset_expressions to None, run_after=None
[2024-09-08T15:39:06.531-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:39:06.531-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1 to None, run_after=None
[2024-09-08T15:39:06.532-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:39:06.532-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_and_2 to None, run_after=None
[2024-09-08T15:39:06.533-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:39:06.533-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_never_scheduled to None, run_after=None
[2024-09-08T15:39:06.533-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:39:06.533-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_unknown_never_scheduled to None, run_after=None
[2024-09-08T15:39:06.535-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:39:06.535-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_1 to 2024-09-07 00:00:00+00:00, run_after=2024-09-08 00:00:00+00:00
[2024-09-08T15:39:06.536-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:39:06.535-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_2 to None, run_after=None
[2024-09-08T15:39:06.560-0300] {processor.py:208} INFO - Processing /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py took 0.089 seconds
[2024-09-08T15:40:22.545-0300] {processor.py:186} INFO - Started process (PID=35045) to work on /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T15:40:22.546-0300] {processor.py:914} INFO - Processing file /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py for tasks to queue
[2024-09-08T15:40:22.548-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:40:22.548-0300] {dagbag.py:587} INFO - Filling up the DagBag from /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T15:40:22.561-0300] {processor.py:925} INFO - DAG(s) 'dataset_consumes_1_and_2', 'consume_1_or_both_2_and_3_with_dataset_expressions', 'dataset_produces_1', 'dataset_consumes_1', 'dataset_produces_2', 'dataset_consumes_1_never_scheduled', 'consume_1_or_2_with_dataset_expressions', 'dataset_consumes_unknown_never_scheduled', 'conditional_dataset_and_time_based_timetable', 'consume_1_and_2_with_dataset_expressions' retrieved from /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T15:40:22.584-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:40:22.584-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T15:40:22.674-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:40:22.674-0300] {dag.py:4156} INFO - Setting next_dagrun for conditional_dataset_and_time_based_timetable to 2024-09-04 01:00:00+00:00, run_after=2024-09-04 01:00:00+00:00
[2024-09-08T15:40:22.676-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:40:22.676-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_and_2_with_dataset_expressions to None, run_after=None
[2024-09-08T15:40:22.677-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:40:22.677-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_2_with_dataset_expressions to None, run_after=None
[2024-09-08T15:40:22.678-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:40:22.678-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_both_2_and_3_with_dataset_expressions to None, run_after=None
[2024-09-08T15:40:22.679-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:40:22.679-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1 to None, run_after=None
[2024-09-08T15:40:22.679-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:40:22.679-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_and_2 to None, run_after=None
[2024-09-08T15:40:22.680-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:40:22.680-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_never_scheduled to None, run_after=None
[2024-09-08T15:40:22.680-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:40:22.680-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_unknown_never_scheduled to None, run_after=None
[2024-09-08T15:40:22.682-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:40:22.682-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_1 to 2024-09-07 00:00:00+00:00, run_after=2024-09-08 00:00:00+00:00
[2024-09-08T15:40:22.683-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:40:22.683-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_2 to None, run_after=None
[2024-09-08T15:40:22.707-0300] {processor.py:208} INFO - Processing /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py took 0.165 seconds
[2024-09-08T15:41:40.274-0300] {processor.py:186} INFO - Started process (PID=35534) to work on /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T15:41:40.275-0300] {processor.py:914} INFO - Processing file /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py for tasks to queue
[2024-09-08T15:41:40.276-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:41:40.276-0300] {dagbag.py:587} INFO - Filling up the DagBag from /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T15:41:40.287-0300] {processor.py:925} INFO - DAG(s) 'conditional_dataset_and_time_based_timetable', 'dataset_consumes_1_never_scheduled', 'dataset_consumes_1_and_2', 'consume_1_or_2_with_dataset_expressions', 'dataset_consumes_1', 'dataset_produces_2', 'consume_1_or_both_2_and_3_with_dataset_expressions', 'dataset_consumes_unknown_never_scheduled', 'consume_1_and_2_with_dataset_expressions', 'dataset_produces_1' retrieved from /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T15:41:40.315-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:41:40.315-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T15:41:40.332-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:41:40.331-0300] {dag.py:4156} INFO - Setting next_dagrun for conditional_dataset_and_time_based_timetable to 2024-09-04 01:00:00+00:00, run_after=2024-09-04 01:00:00+00:00
[2024-09-08T15:41:40.334-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:41:40.334-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_and_2_with_dataset_expressions to None, run_after=None
[2024-09-08T15:41:40.335-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:41:40.335-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_2_with_dataset_expressions to None, run_after=None
[2024-09-08T15:41:40.336-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:41:40.335-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_both_2_and_3_with_dataset_expressions to None, run_after=None
[2024-09-08T15:41:40.336-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:41:40.336-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1 to None, run_after=None
[2024-09-08T15:41:40.337-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:41:40.337-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_and_2 to None, run_after=None
[2024-09-08T15:41:40.338-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:41:40.337-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_never_scheduled to None, run_after=None
[2024-09-08T15:41:40.338-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:41:40.338-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_unknown_never_scheduled to None, run_after=None
[2024-09-08T15:41:40.340-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:41:40.340-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_1 to 2024-09-07 00:00:00+00:00, run_after=2024-09-08 00:00:00+00:00
[2024-09-08T15:41:40.340-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:41:40.340-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_2 to None, run_after=None
[2024-09-08T15:41:40.367-0300] {processor.py:208} INFO - Processing /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py took 0.097 seconds
[2024-09-08T15:42:58.026-0300] {processor.py:186} INFO - Started process (PID=35766) to work on /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T15:42:58.027-0300] {processor.py:914} INFO - Processing file /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py for tasks to queue
[2024-09-08T15:42:58.028-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:42:58.028-0300] {dagbag.py:587} INFO - Filling up the DagBag from /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T15:42:58.039-0300] {processor.py:925} INFO - DAG(s) 'consume_1_or_both_2_and_3_with_dataset_expressions', 'dataset_consumes_1_and_2', 'conditional_dataset_and_time_based_timetable', 'dataset_consumes_unknown_never_scheduled', 'dataset_consumes_1', 'dataset_produces_1', 'dataset_consumes_1_never_scheduled', 'consume_1_and_2_with_dataset_expressions', 'dataset_produces_2', 'consume_1_or_2_with_dataset_expressions' retrieved from /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T15:42:58.062-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:42:58.062-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T15:42:58.079-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:42:58.079-0300] {dag.py:4156} INFO - Setting next_dagrun for conditional_dataset_and_time_based_timetable to 2024-09-04 01:00:00+00:00, run_after=2024-09-04 01:00:00+00:00
[2024-09-08T15:42:58.082-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:42:58.082-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_and_2_with_dataset_expressions to None, run_after=None
[2024-09-08T15:42:58.083-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:42:58.083-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_2_with_dataset_expressions to None, run_after=None
[2024-09-08T15:42:58.083-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:42:58.083-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_both_2_and_3_with_dataset_expressions to None, run_after=None
[2024-09-08T15:42:58.084-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:42:58.084-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1 to None, run_after=None
[2024-09-08T15:42:58.084-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:42:58.084-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_and_2 to None, run_after=None
[2024-09-08T15:42:58.085-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:42:58.085-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_never_scheduled to None, run_after=None
[2024-09-08T15:42:58.085-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:42:58.085-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_unknown_never_scheduled to None, run_after=None
[2024-09-08T15:42:58.087-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:42:58.087-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_1 to 2024-09-07 00:00:00+00:00, run_after=2024-09-08 00:00:00+00:00
[2024-09-08T15:42:58.087-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:42:58.087-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_2 to None, run_after=None
[2024-09-08T15:42:58.112-0300] {processor.py:208} INFO - Processing /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py took 0.089 seconds
[2024-09-08T15:44:17.123-0300] {processor.py:186} INFO - Started process (PID=36112) to work on /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T15:44:17.124-0300] {processor.py:914} INFO - Processing file /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py for tasks to queue
[2024-09-08T15:44:17.126-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:44:17.125-0300] {dagbag.py:587} INFO - Filling up the DagBag from /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T15:44:17.140-0300] {processor.py:925} INFO - DAG(s) 'dataset_consumes_1', 'dataset_produces_1', 'dataset_consumes_1_and_2', 'consume_1_and_2_with_dataset_expressions', 'dataset_consumes_unknown_never_scheduled', 'conditional_dataset_and_time_based_timetable', 'consume_1_or_2_with_dataset_expressions', 'dataset_consumes_1_never_scheduled', 'consume_1_or_both_2_and_3_with_dataset_expressions', 'dataset_produces_2' retrieved from /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T15:44:17.173-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:44:17.173-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T15:44:17.198-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:44:17.198-0300] {dag.py:4156} INFO - Setting next_dagrun for conditional_dataset_and_time_based_timetable to 2024-09-04 01:00:00+00:00, run_after=2024-09-04 01:00:00+00:00
[2024-09-08T15:44:17.201-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:44:17.201-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_and_2_with_dataset_expressions to None, run_after=None
[2024-09-08T15:44:17.202-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:44:17.202-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_2_with_dataset_expressions to None, run_after=None
[2024-09-08T15:44:17.203-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:44:17.203-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_both_2_and_3_with_dataset_expressions to None, run_after=None
[2024-09-08T15:44:17.204-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:44:17.204-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1 to None, run_after=None
[2024-09-08T15:44:17.205-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:44:17.204-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_and_2 to None, run_after=None
[2024-09-08T15:44:17.205-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:44:17.205-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_never_scheduled to None, run_after=None
[2024-09-08T15:44:17.206-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:44:17.206-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_unknown_never_scheduled to None, run_after=None
[2024-09-08T15:44:17.207-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:44:17.207-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_1 to 2024-09-07 00:00:00+00:00, run_after=2024-09-08 00:00:00+00:00
[2024-09-08T15:44:17.209-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:44:17.208-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_2 to None, run_after=None
[2024-09-08T15:44:17.238-0300] {processor.py:208} INFO - Processing /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py took 0.120 seconds
[2024-09-08T15:45:33.446-0300] {processor.py:186} INFO - Started process (PID=36340) to work on /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T15:45:33.447-0300] {processor.py:914} INFO - Processing file /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py for tasks to queue
[2024-09-08T15:45:33.449-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:45:33.449-0300] {dagbag.py:587} INFO - Filling up the DagBag from /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T15:45:33.467-0300] {processor.py:925} INFO - DAG(s) 'dataset_consumes_1', 'dataset_produces_1', 'dataset_consumes_1_and_2', 'consume_1_and_2_with_dataset_expressions', 'dataset_consumes_1_never_scheduled', 'consume_1_or_both_2_and_3_with_dataset_expressions', 'dataset_consumes_unknown_never_scheduled', 'conditional_dataset_and_time_based_timetable', 'dataset_produces_2', 'consume_1_or_2_with_dataset_expressions' retrieved from /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T15:45:33.499-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:45:33.499-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T15:45:33.527-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:45:33.527-0300] {dag.py:4156} INFO - Setting next_dagrun for conditional_dataset_and_time_based_timetable to 2024-09-04 01:00:00+00:00, run_after=2024-09-04 01:00:00+00:00
[2024-09-08T15:45:33.529-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:45:33.529-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_and_2_with_dataset_expressions to None, run_after=None
[2024-09-08T15:45:33.530-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:45:33.530-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_2_with_dataset_expressions to None, run_after=None
[2024-09-08T15:45:33.531-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:45:33.530-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_both_2_and_3_with_dataset_expressions to None, run_after=None
[2024-09-08T15:45:33.531-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:45:33.531-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1 to None, run_after=None
[2024-09-08T15:45:33.532-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:45:33.532-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_and_2 to None, run_after=None
[2024-09-08T15:45:33.533-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:45:33.533-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_never_scheduled to None, run_after=None
[2024-09-08T15:45:33.535-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:45:33.535-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_unknown_never_scheduled to None, run_after=None
[2024-09-08T15:45:33.538-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:45:33.538-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_1 to 2024-09-07 00:00:00+00:00, run_after=2024-09-08 00:00:00+00:00
[2024-09-08T15:45:33.539-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:45:33.539-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_2 to None, run_after=None
[2024-09-08T15:45:33.572-0300] {processor.py:208} INFO - Processing /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py took 0.130 seconds
[2024-09-08T15:46:28.778-0300] {processor.py:186} INFO - Started process (PID=36534) to work on /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T15:46:28.778-0300] {processor.py:914} INFO - Processing file /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py for tasks to queue
[2024-09-08T15:46:28.780-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:46:28.779-0300] {dagbag.py:587} INFO - Filling up the DagBag from /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T15:46:28.790-0300] {processor.py:925} INFO - DAG(s) 'consume_1_or_2_with_dataset_expressions', 'dataset_consumes_1_never_scheduled', 'consume_1_and_2_with_dataset_expressions', 'dataset_consumes_1_and_2', 'dataset_produces_1', 'dataset_produces_2', 'dataset_consumes_unknown_never_scheduled', 'consume_1_or_both_2_and_3_with_dataset_expressions', 'dataset_consumes_1', 'conditional_dataset_and_time_based_timetable' retrieved from /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T15:46:28.812-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:46:28.812-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T15:46:28.828-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:46:28.828-0300] {dag.py:4156} INFO - Setting next_dagrun for conditional_dataset_and_time_based_timetable to 2024-09-04 01:00:00+00:00, run_after=2024-09-04 01:00:00+00:00
[2024-09-08T15:46:28.830-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:46:28.830-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_and_2_with_dataset_expressions to None, run_after=None
[2024-09-08T15:46:28.831-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:46:28.831-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_2_with_dataset_expressions to None, run_after=None
[2024-09-08T15:46:28.832-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:46:28.831-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_both_2_and_3_with_dataset_expressions to None, run_after=None
[2024-09-08T15:46:28.832-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:46:28.832-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1 to None, run_after=None
[2024-09-08T15:46:28.833-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:46:28.833-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_and_2 to None, run_after=None
[2024-09-08T15:46:28.833-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:46:28.833-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_never_scheduled to None, run_after=None
[2024-09-08T15:46:28.834-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:46:28.834-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_unknown_never_scheduled to None, run_after=None
[2024-09-08T15:46:28.835-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:46:28.835-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_1 to 2024-09-07 00:00:00+00:00, run_after=2024-09-08 00:00:00+00:00
[2024-09-08T15:46:28.836-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:46:28.836-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_2 to None, run_after=None
[2024-09-08T15:46:28.861-0300] {processor.py:208} INFO - Processing /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py took 0.087 seconds
[2024-09-08T15:47:47.543-0300] {processor.py:186} INFO - Started process (PID=36777) to work on /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T15:47:47.555-0300] {processor.py:914} INFO - Processing file /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py for tasks to queue
[2024-09-08T15:47:47.557-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:47:47.557-0300] {dagbag.py:587} INFO - Filling up the DagBag from /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T15:47:47.571-0300] {processor.py:925} INFO - DAG(s) 'dataset_produces_1', 'consume_1_and_2_with_dataset_expressions', 'dataset_consumes_1_and_2', 'dataset_consumes_unknown_never_scheduled', 'dataset_produces_2', 'consume_1_or_2_with_dataset_expressions', 'dataset_consumes_1_never_scheduled', 'conditional_dataset_and_time_based_timetable', 'consume_1_or_both_2_and_3_with_dataset_expressions', 'dataset_consumes_1' retrieved from /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T15:47:47.598-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:47:47.598-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T15:47:47.618-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:47:47.618-0300] {dag.py:4156} INFO - Setting next_dagrun for conditional_dataset_and_time_based_timetable to 2024-09-04 01:00:00+00:00, run_after=2024-09-04 01:00:00+00:00
[2024-09-08T15:47:47.620-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:47:47.620-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_and_2_with_dataset_expressions to None, run_after=None
[2024-09-08T15:47:47.621-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:47:47.621-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_2_with_dataset_expressions to None, run_after=None
[2024-09-08T15:47:47.622-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:47:47.622-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_both_2_and_3_with_dataset_expressions to None, run_after=None
[2024-09-08T15:47:47.622-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:47:47.622-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1 to None, run_after=None
[2024-09-08T15:47:47.623-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:47:47.623-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_and_2 to None, run_after=None
[2024-09-08T15:47:47.623-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:47:47.623-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_never_scheduled to None, run_after=None
[2024-09-08T15:47:47.624-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:47:47.624-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_unknown_never_scheduled to None, run_after=None
[2024-09-08T15:47:47.626-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:47:47.625-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_1 to 2024-09-07 00:00:00+00:00, run_after=2024-09-08 00:00:00+00:00
[2024-09-08T15:47:47.626-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:47:47.626-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_2 to None, run_after=None
[2024-09-08T15:47:47.655-0300] {processor.py:208} INFO - Processing /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py took 0.115 seconds
[2024-09-08T15:48:44.352-0300] {processor.py:186} INFO - Started process (PID=37132) to work on /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T15:48:44.353-0300] {processor.py:914} INFO - Processing file /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py for tasks to queue
[2024-09-08T15:48:44.355-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:48:44.355-0300] {dagbag.py:587} INFO - Filling up the DagBag from /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T15:48:44.376-0300] {processor.py:925} INFO - DAG(s) 'consume_1_or_2_with_dataset_expressions', 'consume_1_or_both_2_and_3_with_dataset_expressions', 'dataset_produces_2', 'dataset_consumes_1_never_scheduled', 'dataset_consumes_unknown_never_scheduled', 'dataset_produces_1', 'conditional_dataset_and_time_based_timetable', 'consume_1_and_2_with_dataset_expressions', 'dataset_consumes_1', 'dataset_consumes_1_and_2' retrieved from /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T15:48:44.549-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:48:44.548-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T15:48:44.560-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:48:44.560-0300] {dag.py:3252} INFO - Creating ORM DAG for conditional_dataset_and_time_based_timetable
[2024-09-08T15:48:44.561-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:48:44.561-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_and_2_with_dataset_expressions
[2024-09-08T15:48:44.570-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:48:44.570-0300] {dag.py:4156} INFO - Setting next_dagrun for conditional_dataset_and_time_based_timetable to 2024-09-04 01:00:00+00:00, run_after=2024-09-04 01:00:00+00:00
[2024-09-08T15:48:44.571-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:48:44.571-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_and_2_with_dataset_expressions to None, run_after=None
[2024-09-08T15:48:44.571-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:48:44.571-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_2_with_dataset_expressions to None, run_after=None
[2024-09-08T15:48:44.573-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:48:44.573-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_both_2_and_3_with_dataset_expressions to None, run_after=None
[2024-09-08T15:48:44.574-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:48:44.574-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1 to None, run_after=None
[2024-09-08T15:48:44.575-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:48:44.574-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_and_2 to None, run_after=None
[2024-09-08T15:48:44.575-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:48:44.575-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_never_scheduled to None, run_after=None
[2024-09-08T15:48:44.576-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:48:44.576-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_unknown_never_scheduled to None, run_after=None
[2024-09-08T15:48:44.578-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:48:44.577-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_1 to 2024-09-07 00:00:00+00:00, run_after=2024-09-08 00:00:00+00:00
[2024-09-08T15:48:44.579-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:48:44.578-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_2 to None, run_after=None
[2024-09-08T15:48:44.609-0300] {processor.py:208} INFO - Processing /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py took 0.265 seconds
[2024-09-08T15:49:37.880-0300] {processor.py:186} INFO - Started process (PID=37702) to work on /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T15:49:37.881-0300] {processor.py:914} INFO - Processing file /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py for tasks to queue
[2024-09-08T15:49:37.884-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:49:37.883-0300] {dagbag.py:587} INFO - Filling up the DagBag from /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T15:49:37.904-0300] {processor.py:925} INFO - DAG(s) 'dataset_produces_2', 'dataset_produces_1', 'dataset_consumes_unknown_never_scheduled', 'consume_1_or_both_2_and_3_with_dataset_expressions', 'dataset_consumes_1_never_scheduled', 'consume_1_or_2_with_dataset_expressions', 'dataset_consumes_1', 'dataset_consumes_1_and_2', 'conditional_dataset_and_time_based_timetable', 'consume_1_and_2_with_dataset_expressions' retrieved from /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T15:49:38.100-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:49:38.100-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T15:49:38.114-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:49:38.114-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_both_2_and_3_with_dataset_expressions
[2024-09-08T15:49:38.115-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:49:38.114-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_2_with_dataset_expressions
[2024-09-08T15:49:38.115-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:49:38.115-0300] {dag.py:3252} INFO - Creating ORM DAG for conditional_dataset_and_time_based_timetable
[2024-09-08T15:49:38.116-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:49:38.115-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_and_2_with_dataset_expressions
[2024-09-08T15:49:38.126-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:49:38.126-0300] {dag.py:4156} INFO - Setting next_dagrun for conditional_dataset_and_time_based_timetable to 2024-09-04 01:00:00+00:00, run_after=2024-09-04 01:00:00+00:00
[2024-09-08T15:49:38.127-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:49:38.127-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_and_2_with_dataset_expressions to None, run_after=None
[2024-09-08T15:49:38.128-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:49:38.128-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_2_with_dataset_expressions to None, run_after=None
[2024-09-08T15:49:38.128-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:49:38.128-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_both_2_and_3_with_dataset_expressions to None, run_after=None
[2024-09-08T15:49:38.129-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:49:38.129-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1 to None, run_after=None
[2024-09-08T15:49:38.132-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:49:38.132-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_and_2 to None, run_after=None
[2024-09-08T15:49:38.133-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:49:38.133-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_never_scheduled to None, run_after=None
[2024-09-08T15:49:38.133-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:49:38.133-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_unknown_never_scheduled to None, run_after=None
[2024-09-08T15:49:38.135-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:49:38.135-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_1 to 2024-09-07 00:00:00+00:00, run_after=2024-09-08 00:00:00+00:00
[2024-09-08T15:49:38.136-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:49:38.136-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_2 to None, run_after=None
[2024-09-08T15:49:38.179-0300] {processor.py:208} INFO - Processing /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py took 0.308 seconds
[2024-09-08T15:50:57.254-0300] {processor.py:186} INFO - Started process (PID=38615) to work on /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T15:50:57.254-0300] {processor.py:914} INFO - Processing file /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py for tasks to queue
[2024-09-08T15:50:57.256-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:50:57.255-0300] {dagbag.py:587} INFO - Filling up the DagBag from /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T15:50:57.266-0300] {processor.py:925} INFO - DAG(s) 'consume_1_and_2_with_dataset_expressions', 'consume_1_or_both_2_and_3_with_dataset_expressions', 'dataset_produces_2', 'consume_1_or_2_with_dataset_expressions', 'dataset_consumes_unknown_never_scheduled', 'conditional_dataset_and_time_based_timetable', 'dataset_consumes_1_never_scheduled', 'dataset_produces_1', 'dataset_consumes_1', 'dataset_consumes_1_and_2' retrieved from /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T15:50:57.382-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:50:57.382-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T15:50:57.392-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:50:57.391-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_both_2_and_3_with_dataset_expressions
[2024-09-08T15:50:57.392-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:50:57.392-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_2_with_dataset_expressions
[2024-09-08T15:50:57.392-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:50:57.392-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_and_2_with_dataset_expressions
[2024-09-08T15:50:57.393-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:50:57.393-0300] {dag.py:3252} INFO - Creating ORM DAG for conditional_dataset_and_time_based_timetable
[2024-09-08T15:50:57.400-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:50:57.400-0300] {dag.py:4156} INFO - Setting next_dagrun for conditional_dataset_and_time_based_timetable to 2024-09-04 01:00:00+00:00, run_after=2024-09-04 01:00:00+00:00
[2024-09-08T15:50:57.401-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:50:57.401-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_and_2_with_dataset_expressions to None, run_after=None
[2024-09-08T15:50:57.401-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:50:57.401-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_2_with_dataset_expressions to None, run_after=None
[2024-09-08T15:50:57.401-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:50:57.401-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_both_2_and_3_with_dataset_expressions to None, run_after=None
[2024-09-08T15:50:57.402-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:50:57.402-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1 to None, run_after=None
[2024-09-08T15:50:57.404-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:50:57.404-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_and_2 to None, run_after=None
[2024-09-08T15:50:57.405-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:50:57.405-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_never_scheduled to None, run_after=None
[2024-09-08T15:50:57.405-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:50:57.405-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_unknown_never_scheduled to None, run_after=None
[2024-09-08T15:50:57.407-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:50:57.407-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_1 to 2024-09-07 00:00:00+00:00, run_after=2024-09-08 00:00:00+00:00
[2024-09-08T15:50:57.408-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:50:57.408-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_2 to None, run_after=None
[2024-09-08T15:50:57.439-0300] {processor.py:208} INFO - Processing /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py took 0.190 seconds
[2024-09-08T15:52:11.801-0300] {processor.py:186} INFO - Started process (PID=39182) to work on /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T15:52:11.803-0300] {processor.py:914} INFO - Processing file /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py for tasks to queue
[2024-09-08T15:52:11.805-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:52:11.805-0300] {dagbag.py:587} INFO - Filling up the DagBag from /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T15:52:11.815-0300] {processor.py:925} INFO - DAG(s) 'consume_1_or_2_with_dataset_expressions', 'conditional_dataset_and_time_based_timetable', 'dataset_consumes_1_never_scheduled', 'consume_1_and_2_with_dataset_expressions', 'consume_1_or_both_2_and_3_with_dataset_expressions', 'dataset_consumes_1', 'dataset_produces_2', 'dataset_consumes_unknown_never_scheduled', 'dataset_consumes_1_and_2', 'dataset_produces_1' retrieved from /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T15:52:11.838-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:52:11.838-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T15:52:11.854-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:52:11.854-0300] {dag.py:4156} INFO - Setting next_dagrun for conditional_dataset_and_time_based_timetable to 2024-09-04 01:00:00+00:00, run_after=2024-09-04 01:00:00+00:00
[2024-09-08T15:52:11.856-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:52:11.856-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_and_2_with_dataset_expressions to None, run_after=None
[2024-09-08T15:52:11.857-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:52:11.857-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_2_with_dataset_expressions to None, run_after=None
[2024-09-08T15:52:11.857-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:52:11.857-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_both_2_and_3_with_dataset_expressions to None, run_after=None
[2024-09-08T15:52:11.858-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:52:11.858-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1 to None, run_after=None
[2024-09-08T15:52:11.858-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:52:11.858-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_and_2 to None, run_after=None
[2024-09-08T15:52:11.859-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:52:11.859-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_never_scheduled to None, run_after=None
[2024-09-08T15:52:11.860-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:52:11.859-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_unknown_never_scheduled to None, run_after=None
[2024-09-08T15:52:11.861-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:52:11.861-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_1 to 2024-09-07 00:00:00+00:00, run_after=2024-09-08 00:00:00+00:00
[2024-09-08T15:52:11.861-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:52:11.861-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_2 to None, run_after=None
[2024-09-08T15:52:11.886-0300] {processor.py:208} INFO - Processing /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py took 0.089 seconds
[2024-09-08T15:53:26.636-0300] {processor.py:186} INFO - Started process (PID=40011) to work on /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T15:53:26.637-0300] {processor.py:914} INFO - Processing file /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py for tasks to queue
[2024-09-08T15:53:26.638-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:53:26.638-0300] {dagbag.py:587} INFO - Filling up the DagBag from /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T15:53:26.649-0300] {processor.py:925} INFO - DAG(s) 'consume_1_or_both_2_and_3_with_dataset_expressions', 'dataset_consumes_1_never_scheduled', 'dataset_consumes_1_and_2', 'dataset_consumes_unknown_never_scheduled', 'dataset_produces_1', 'consume_1_and_2_with_dataset_expressions', 'consume_1_or_2_with_dataset_expressions', 'conditional_dataset_and_time_based_timetable', 'dataset_consumes_1', 'dataset_produces_2' retrieved from /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T15:53:26.673-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:53:26.672-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T15:53:26.690-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:53:26.690-0300] {dag.py:4156} INFO - Setting next_dagrun for conditional_dataset_and_time_based_timetable to 2024-09-04 01:00:00+00:00, run_after=2024-09-04 01:00:00+00:00
[2024-09-08T15:53:26.693-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:53:26.692-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_and_2_with_dataset_expressions to None, run_after=None
[2024-09-08T15:53:26.694-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:53:26.694-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_2_with_dataset_expressions to None, run_after=None
[2024-09-08T15:53:26.695-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:53:26.695-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_both_2_and_3_with_dataset_expressions to None, run_after=None
[2024-09-08T15:53:26.696-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:53:26.696-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1 to None, run_after=None
[2024-09-08T15:53:26.697-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:53:26.696-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_and_2 to None, run_after=None
[2024-09-08T15:53:26.697-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:53:26.697-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_never_scheduled to None, run_after=None
[2024-09-08T15:53:26.698-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:53:26.698-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_unknown_never_scheduled to None, run_after=None
[2024-09-08T15:53:26.700-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:53:26.699-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_1 to 2024-09-07 00:00:00+00:00, run_after=2024-09-08 00:00:00+00:00
[2024-09-08T15:53:26.700-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:53:26.700-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_2 to None, run_after=None
[2024-09-08T15:53:26.726-0300] {processor.py:208} INFO - Processing /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py took 0.093 seconds
[2024-09-08T15:54:40.711-0300] {processor.py:186} INFO - Started process (PID=41098) to work on /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T15:54:40.712-0300] {processor.py:914} INFO - Processing file /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py for tasks to queue
[2024-09-08T15:54:40.713-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:54:40.713-0300] {dagbag.py:587} INFO - Filling up the DagBag from /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T15:54:40.723-0300] {processor.py:925} INFO - DAG(s) 'dataset_produces_1', 'consume_1_and_2_with_dataset_expressions', 'dataset_consumes_1', 'dataset_consumes_unknown_never_scheduled', 'conditional_dataset_and_time_based_timetable', 'consume_1_or_both_2_and_3_with_dataset_expressions', 'dataset_consumes_1_never_scheduled', 'dataset_produces_2', 'consume_1_or_2_with_dataset_expressions', 'dataset_consumes_1_and_2' retrieved from /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T15:54:40.744-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:54:40.744-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T15:54:40.761-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:54:40.761-0300] {dag.py:4156} INFO - Setting next_dagrun for conditional_dataset_and_time_based_timetable to 2024-09-04 01:00:00+00:00, run_after=2024-09-04 01:00:00+00:00
[2024-09-08T15:54:40.763-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:54:40.763-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_and_2_with_dataset_expressions to None, run_after=None
[2024-09-08T15:54:40.764-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:54:40.764-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_2_with_dataset_expressions to None, run_after=None
[2024-09-08T15:54:40.764-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:54:40.764-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_both_2_and_3_with_dataset_expressions to None, run_after=None
[2024-09-08T15:54:40.765-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:54:40.765-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1 to None, run_after=None
[2024-09-08T15:54:40.765-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:54:40.765-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_and_2 to None, run_after=None
[2024-09-08T15:54:40.766-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:54:40.766-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_never_scheduled to None, run_after=None
[2024-09-08T15:54:40.766-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:54:40.766-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_unknown_never_scheduled to None, run_after=None
[2024-09-08T15:54:40.768-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:54:40.768-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_1 to 2024-09-07 00:00:00+00:00, run_after=2024-09-08 00:00:00+00:00
[2024-09-08T15:54:40.768-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:54:40.768-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_2 to None, run_after=None
[2024-09-08T15:54:40.791-0300] {processor.py:208} INFO - Processing /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py took 0.083 seconds
[2024-09-08T15:56:10.421-0300] {processor.py:186} INFO - Started process (PID=41639) to work on /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T15:56:10.422-0300] {processor.py:914} INFO - Processing file /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py for tasks to queue
[2024-09-08T15:56:10.424-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:56:10.424-0300] {dagbag.py:587} INFO - Filling up the DagBag from /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T15:56:10.435-0300] {processor.py:925} INFO - DAG(s) 'consume_1_or_both_2_and_3_with_dataset_expressions', 'dataset_consumes_1_and_2', 'dataset_produces_2', 'dataset_consumes_1', 'conditional_dataset_and_time_based_timetable', 'dataset_consumes_1_never_scheduled', 'dataset_consumes_unknown_never_scheduled', 'dataset_produces_1', 'consume_1_and_2_with_dataset_expressions', 'consume_1_or_2_with_dataset_expressions' retrieved from /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T15:56:10.457-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:56:10.457-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T15:56:10.466-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:56:10.466-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_both_2_and_3_with_dataset_expressions
[2024-09-08T15:56:10.466-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:56:10.466-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_1
[2024-09-08T15:56:10.467-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:56:10.467-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_unknown_never_scheduled
[2024-09-08T15:56:10.467-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:56:10.467-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_2_with_dataset_expressions
[2024-09-08T15:56:10.467-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:56:10.467-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1
[2024-09-08T15:56:10.468-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:56:10.468-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_never_scheduled
[2024-09-08T15:56:10.468-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:56:10.468-0300] {dag.py:3252} INFO - Creating ORM DAG for conditional_dataset_and_time_based_timetable
[2024-09-08T15:56:10.468-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:56:10.468-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_and_2_with_dataset_expressions
[2024-09-08T15:56:10.469-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:56:10.469-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_2
[2024-09-08T15:56:10.469-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:56:10.469-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_and_2
[2024-09-08T15:56:10.476-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:56:10.476-0300] {dag.py:4156} INFO - Setting next_dagrun for conditional_dataset_and_time_based_timetable to 2024-09-04 01:00:00+00:00, run_after=2024-09-04 01:00:00+00:00
[2024-09-08T15:56:10.476-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:56:10.476-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_and_2_with_dataset_expressions to None, run_after=None
[2024-09-08T15:56:10.476-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:56:10.476-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_2_with_dataset_expressions to None, run_after=None
[2024-09-08T15:56:10.477-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:56:10.477-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_both_2_and_3_with_dataset_expressions to None, run_after=None
[2024-09-08T15:56:10.477-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:56:10.477-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1 to None, run_after=None
[2024-09-08T15:56:10.477-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:56:10.477-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_and_2 to None, run_after=None
[2024-09-08T15:56:10.478-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:56:10.477-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_never_scheduled to None, run_after=None
[2024-09-08T15:56:10.478-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:56:10.478-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_unknown_never_scheduled to None, run_after=None
[2024-09-08T15:56:10.479-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:56:10.479-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_1 to 2024-09-07 00:00:00+00:00, run_after=2024-09-08 00:00:00+00:00
[2024-09-08T15:56:10.479-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:56:10.479-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_2 to None, run_after=None
[2024-09-08T15:56:10.640-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:56:10.638-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T15:56:10.641-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:56:10.641-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T15:56:10.642-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:56:10.642-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T15:56:10.643-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:56:10.643-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T15:56:10.644-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:56:10.644-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T15:56:10.645-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:56:10.645-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T15:56:10.646-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:56:10.646-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T15:56:10.647-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:56:10.646-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T15:56:10.648-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:56:10.647-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T15:56:10.649-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:56:10.648-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T15:56:10.649-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:56:10.649-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T15:56:10.650-0300] {processor.py:211} ERROR - Got an exception! Propagating...
Traceback (most recent call last):
  File "/home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 207, in _run_file_processor
    _handle_dag_file_processing()
  File "/home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 188, in _handle_dag_file_processing
    result: tuple[int, int, int] = dag_file_processor.process_file(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 942, in process_file
    serialize_errors = DagFileProcessor.save_dag_to_db(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/api_internal/internal_api_call.py", line 139, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 982, in save_dag_to_db
    import_errors = DagBag._sync_to_db(dags=dags, processor_subdir=dag_directory, session=session)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/models/dagbag.py", line 707, in _sync_to_db
    for attempt in run_with_db_retries(logger=log):
  File "/home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/tenacity/__init__.py", line 443, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/models/dagbag.py", line 723, in _sync_to_db
    DAG.bulk_write_to_db(dags.values(), processor_subdir=processor_subdir, session=session)
  File "/home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/airflow/models/dag.py", line 3242, in bulk_write_to_db
    orm_dags: list[DagModel] = session.scalars(query).unique().all()
                               ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1778, in scalars
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/share/pipx/venvs/apache-airflow/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T15:58:21.101-0300] {processor.py:186} INFO - Started process (PID=43013) to work on /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T15:58:21.102-0300] {processor.py:914} INFO - Processing file /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py for tasks to queue
[2024-09-08T15:58:21.103-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:58:21.103-0300] {dagbag.py:587} INFO - Filling up the DagBag from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T15:58:21.113-0300] {processor.py:925} INFO - DAG(s) 'consume_1_or_2_with_dataset_expressions', 'dataset_produces_2', 'dataset_consumes_1_and_2', 'dataset_consumes_1_never_scheduled', 'dataset_consumes_1', 'conditional_dataset_and_time_based_timetable', 'dataset_consumes_unknown_never_scheduled', 'dataset_produces_1', 'consume_1_and_2_with_dataset_expressions', 'consume_1_or_both_2_and_3_with_dataset_expressions' retrieved from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T15:58:21.256-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:58:21.256-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T15:58:21.263-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:58:21.263-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_never_scheduled
[2024-09-08T15:58:21.263-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:58:21.263-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_and_2
[2024-09-08T15:58:21.264-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:58:21.264-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_unknown_never_scheduled
[2024-09-08T15:58:21.264-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:58:21.264-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_2_with_dataset_expressions
[2024-09-08T15:58:21.264-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:58:21.264-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_2
[2024-09-08T15:58:21.265-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:58:21.265-0300] {dag.py:3252} INFO - Creating ORM DAG for conditional_dataset_and_time_based_timetable
[2024-09-08T15:58:21.265-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:58:21.265-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_1
[2024-09-08T15:58:21.265-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:58:21.265-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_and_2_with_dataset_expressions
[2024-09-08T15:58:21.266-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:58:21.266-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1
[2024-09-08T15:58:21.266-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:58:21.266-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_both_2_and_3_with_dataset_expressions
[2024-09-08T15:58:21.273-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:58:21.273-0300] {dag.py:4156} INFO - Setting next_dagrun for conditional_dataset_and_time_based_timetable to 2024-09-04 01:00:00+00:00, run_after=2024-09-04 01:00:00+00:00
[2024-09-08T15:58:21.273-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:58:21.273-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_and_2_with_dataset_expressions to None, run_after=None
[2024-09-08T15:58:21.273-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:58:21.273-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_2_with_dataset_expressions to None, run_after=None
[2024-09-08T15:58:21.274-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:58:21.274-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_both_2_and_3_with_dataset_expressions to None, run_after=None
[2024-09-08T15:58:21.274-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:58:21.274-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1 to None, run_after=None
[2024-09-08T15:58:21.274-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:58:21.274-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_and_2 to None, run_after=None
[2024-09-08T15:58:21.275-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:58:21.274-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_never_scheduled to None, run_after=None
[2024-09-08T15:58:21.275-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:58:21.275-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_unknown_never_scheduled to None, run_after=None
[2024-09-08T15:58:21.276-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:58:21.276-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_1 to 2024-09-07 00:00:00+00:00, run_after=2024-09-08 00:00:00+00:00
[2024-09-08T15:58:21.276-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:58:21.276-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_2 to None, run_after=None
[2024-09-08T15:58:21.310-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:58:21.309-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T15:58:21.311-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:58:21.311-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T15:58:21.312-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:58:21.312-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T15:58:21.313-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:58:21.313-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T15:58:21.314-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:58:21.313-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T15:58:21.315-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:58:21.314-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T15:58:21.316-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:58:21.316-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T15:58:21.317-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:58:21.316-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T15:58:21.318-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:58:21.317-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T15:58:21.319-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:58:21.318-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T15:58:21.319-0300] {logging_mixin.py:190} INFO - [2024-09-08T15:58:21.319-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T15:58:21.320-0300] {processor.py:211} ERROR - Got an exception! Propagating...
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 207, in _run_file_processor
    _handle_dag_file_processing()
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 188, in _handle_dag_file_processing
    result: tuple[int, int, int] = dag_file_processor.process_file(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 942, in process_file
    serialize_errors = DagFileProcessor.save_dag_to_db(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/api_internal/internal_api_call.py", line 139, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 982, in save_dag_to_db
    import_errors = DagBag._sync_to_db(dags=dags, processor_subdir=dag_directory, session=session)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 707, in _sync_to_db
    for attempt in run_with_db_retries(logger=log):
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 443, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 723, in _sync_to_db
    DAG.bulk_write_to_db(dags.values(), processor_subdir=processor_subdir, session=session)
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dag.py", line 3242, in bulk_write_to_db
    orm_dags: list[DagModel] = session.scalars(query).unique().all()
                               ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1778, in scalars
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:01:56.511-0300] {processor.py:186} INFO - Started process (PID=45243) to work on /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T16:01:56.512-0300] {processor.py:914} INFO - Processing file /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py for tasks to queue
[2024-09-08T16:01:56.514-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:01:56.514-0300] {dagbag.py:587} INFO - Filling up the DagBag from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T16:01:56.534-0300] {processor.py:925} INFO - DAG(s) 'dataset_consumes_unknown_never_scheduled', 'dataset_consumes_1_and_2', 'dataset_produces_1', 'consume_1_or_2_with_dataset_expressions', 'conditional_dataset_and_time_based_timetable', 'consume_1_and_2_with_dataset_expressions', 'dataset_consumes_1', 'dataset_consumes_1_never_scheduled', 'dataset_produces_2', 'consume_1_or_both_2_and_3_with_dataset_expressions' retrieved from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T16:01:56.899-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:01:56.899-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T16:01:56.909-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:01:56.909-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_never_scheduled
[2024-09-08T16:01:56.910-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:01:56.910-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_and_2
[2024-09-08T16:01:56.911-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:01:56.910-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_unknown_never_scheduled
[2024-09-08T16:01:56.911-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:01:56.911-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_2_with_dataset_expressions
[2024-09-08T16:01:56.911-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:01:56.911-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_2
[2024-09-08T16:01:56.912-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:01:56.912-0300] {dag.py:3252} INFO - Creating ORM DAG for conditional_dataset_and_time_based_timetable
[2024-09-08T16:01:56.912-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:01:56.912-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_1
[2024-09-08T16:01:56.913-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:01:56.913-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_and_2_with_dataset_expressions
[2024-09-08T16:01:56.913-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:01:56.913-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1
[2024-09-08T16:01:56.913-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:01:56.913-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_both_2_and_3_with_dataset_expressions
[2024-09-08T16:01:56.926-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:01:56.926-0300] {dag.py:4156} INFO - Setting next_dagrun for conditional_dataset_and_time_based_timetable to 2024-09-04 01:00:00+00:00, run_after=2024-09-04 01:00:00+00:00
[2024-09-08T16:01:56.928-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:01:56.928-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_and_2_with_dataset_expressions to None, run_after=None
[2024-09-08T16:01:56.929-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:01:56.929-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_2_with_dataset_expressions to None, run_after=None
[2024-09-08T16:01:56.930-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:01:56.929-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_both_2_and_3_with_dataset_expressions to None, run_after=None
[2024-09-08T16:01:56.930-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:01:56.930-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1 to None, run_after=None
[2024-09-08T16:01:56.931-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:01:56.931-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_and_2 to None, run_after=None
[2024-09-08T16:01:56.931-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:01:56.931-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_never_scheduled to None, run_after=None
[2024-09-08T16:01:56.932-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:01:56.932-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_unknown_never_scheduled to None, run_after=None
[2024-09-08T16:01:56.934-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:01:56.934-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_1 to 2024-09-07 00:00:00+00:00, run_after=2024-09-08 00:00:00+00:00
[2024-09-08T16:01:56.935-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:01:56.934-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_2 to None, run_after=None
[2024-09-08T16:01:57.290-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:01:57.288-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:01:57.291-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:01:57.291-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:01:57.292-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:01:57.292-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:01:57.293-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:01:57.293-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:01:57.294-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:01:57.294-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:01:57.295-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:01:57.295-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:01:57.296-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:01:57.295-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:01:57.297-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:01:57.296-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:01:57.298-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:01:57.297-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:01:57.299-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:01:57.298-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:01:57.299-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:01:57.299-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T16:01:57.300-0300] {processor.py:211} ERROR - Got an exception! Propagating...
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 207, in _run_file_processor
    _handle_dag_file_processing()
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 188, in _handle_dag_file_processing
    result: tuple[int, int, int] = dag_file_processor.process_file(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 942, in process_file
    serialize_errors = DagFileProcessor.save_dag_to_db(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/api_internal/internal_api_call.py", line 139, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 982, in save_dag_to_db
    import_errors = DagBag._sync_to_db(dags=dags, processor_subdir=dag_directory, session=session)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 707, in _sync_to_db
    for attempt in run_with_db_retries(logger=log):
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 443, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 723, in _sync_to_db
    DAG.bulk_write_to_db(dags.values(), processor_subdir=processor_subdir, session=session)
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dag.py", line 3242, in bulk_write_to_db
    orm_dags: list[DagModel] = session.scalars(query).unique().all()
                               ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1778, in scalars
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:05:07.132-0300] {processor.py:186} INFO - Started process (PID=47069) to work on /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T16:05:07.133-0300] {processor.py:914} INFO - Processing file /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py for tasks to queue
[2024-09-08T16:05:07.134-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:05:07.134-0300] {dagbag.py:587} INFO - Filling up the DagBag from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T16:05:07.144-0300] {processor.py:925} INFO - DAG(s) 'conditional_dataset_and_time_based_timetable', 'dataset_produces_1', 'dataset_consumes_1_never_scheduled', 'consume_1_or_2_with_dataset_expressions', 'dataset_consumes_1', 'consume_1_or_both_2_and_3_with_dataset_expressions', 'consume_1_and_2_with_dataset_expressions', 'dataset_consumes_unknown_never_scheduled', 'dataset_produces_2', 'dataset_consumes_1_and_2' retrieved from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T16:05:07.323-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:05:07.323-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T16:05:07.415-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:05:07.415-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_never_scheduled
[2024-09-08T16:05:07.416-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:05:07.416-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_and_2
[2024-09-08T16:05:07.416-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:05:07.416-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_unknown_never_scheduled
[2024-09-08T16:05:07.417-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:05:07.417-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_2_with_dataset_expressions
[2024-09-08T16:05:07.417-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:05:07.417-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_2
[2024-09-08T16:05:07.418-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:05:07.417-0300] {dag.py:3252} INFO - Creating ORM DAG for conditional_dataset_and_time_based_timetable
[2024-09-08T16:05:07.418-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:05:07.418-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_1
[2024-09-08T16:05:07.418-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:05:07.418-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_and_2_with_dataset_expressions
[2024-09-08T16:05:07.419-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:05:07.419-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1
[2024-09-08T16:05:07.419-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:05:07.419-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_both_2_and_3_with_dataset_expressions
[2024-09-08T16:05:07.425-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:05:07.425-0300] {dag.py:4156} INFO - Setting next_dagrun for conditional_dataset_and_time_based_timetable to 2024-09-04 01:00:00+00:00, run_after=2024-09-04 01:00:00+00:00
[2024-09-08T16:05:07.426-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:05:07.425-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_and_2_with_dataset_expressions to None, run_after=None
[2024-09-08T16:05:07.426-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:05:07.426-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_2_with_dataset_expressions to None, run_after=None
[2024-09-08T16:05:07.426-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:05:07.426-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_both_2_and_3_with_dataset_expressions to None, run_after=None
[2024-09-08T16:05:07.426-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:05:07.426-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1 to None, run_after=None
[2024-09-08T16:05:07.427-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:05:07.427-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_and_2 to None, run_after=None
[2024-09-08T16:05:07.427-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:05:07.427-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_never_scheduled to None, run_after=None
[2024-09-08T16:05:07.427-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:05:07.427-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_unknown_never_scheduled to None, run_after=None
[2024-09-08T16:05:07.429-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:05:07.429-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_1 to 2024-09-07 00:00:00+00:00, run_after=2024-09-08 00:00:00+00:00
[2024-09-08T16:05:07.429-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:05:07.429-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_2 to None, run_after=None
[2024-09-08T16:05:07.795-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:05:07.793-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:05:07.797-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:05:07.796-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:05:07.798-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:05:07.798-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:05:07.800-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:05:07.799-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:05:07.802-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:05:07.801-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:05:07.804-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:05:07.803-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:05:07.805-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:05:07.805-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:05:07.807-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:05:07.806-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:05:07.808-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:05:07.807-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:05:07.809-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:05:07.808-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:05:07.809-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:05:07.809-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T16:05:07.810-0300] {processor.py:211} ERROR - Got an exception! Propagating...
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 207, in _run_file_processor
    _handle_dag_file_processing()
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 188, in _handle_dag_file_processing
    result: tuple[int, int, int] = dag_file_processor.process_file(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 942, in process_file
    serialize_errors = DagFileProcessor.save_dag_to_db(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/api_internal/internal_api_call.py", line 139, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 982, in save_dag_to_db
    import_errors = DagBag._sync_to_db(dags=dags, processor_subdir=dag_directory, session=session)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 707, in _sync_to_db
    for attempt in run_with_db_retries(logger=log):
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 443, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 723, in _sync_to_db
    DAG.bulk_write_to_db(dags.values(), processor_subdir=processor_subdir, session=session)
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dag.py", line 3242, in bulk_write_to_db
    orm_dags: list[DagModel] = session.scalars(query).unique().all()
                               ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1778, in scalars
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:08:10.185-0300] {processor.py:186} INFO - Started process (PID=48634) to work on /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T16:08:10.186-0300] {processor.py:914} INFO - Processing file /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py for tasks to queue
[2024-09-08T16:08:10.189-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:08:10.188-0300] {dagbag.py:587} INFO - Filling up the DagBag from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T16:08:10.201-0300] {processor.py:925} INFO - DAG(s) 'dataset_consumes_1_and_2', 'consume_1_or_both_2_and_3_with_dataset_expressions', 'dataset_produces_2', 'dataset_consumes_unknown_never_scheduled', 'dataset_consumes_1_never_scheduled', 'dataset_produces_1', 'conditional_dataset_and_time_based_timetable', 'consume_1_and_2_with_dataset_expressions', 'consume_1_or_2_with_dataset_expressions', 'dataset_consumes_1' retrieved from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T16:08:10.469-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:08:10.468-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T16:08:10.478-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:08:10.478-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_never_scheduled
[2024-09-08T16:08:10.479-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:08:10.479-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_and_2
[2024-09-08T16:08:10.479-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:08:10.479-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_unknown_never_scheduled
[2024-09-08T16:08:10.479-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:08:10.479-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_2_with_dataset_expressions
[2024-09-08T16:08:10.480-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:08:10.480-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_2
[2024-09-08T16:08:10.480-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:08:10.480-0300] {dag.py:3252} INFO - Creating ORM DAG for conditional_dataset_and_time_based_timetable
[2024-09-08T16:08:10.481-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:08:10.481-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_1
[2024-09-08T16:08:10.481-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:08:10.481-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_and_2_with_dataset_expressions
[2024-09-08T16:08:10.482-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:08:10.481-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1
[2024-09-08T16:08:10.482-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:08:10.482-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_both_2_and_3_with_dataset_expressions
[2024-09-08T16:08:10.491-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:08:10.491-0300] {dag.py:4156} INFO - Setting next_dagrun for conditional_dataset_and_time_based_timetable to 2024-09-04 01:00:00+00:00, run_after=2024-09-04 01:00:00+00:00
[2024-09-08T16:08:10.491-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:08:10.491-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_and_2_with_dataset_expressions to None, run_after=None
[2024-09-08T16:08:10.492-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:08:10.492-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_2_with_dataset_expressions to None, run_after=None
[2024-09-08T16:08:10.492-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:08:10.492-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_both_2_and_3_with_dataset_expressions to None, run_after=None
[2024-09-08T16:08:10.492-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:08:10.492-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1 to None, run_after=None
[2024-09-08T16:08:10.493-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:08:10.493-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_and_2 to None, run_after=None
[2024-09-08T16:08:10.493-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:08:10.493-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_never_scheduled to None, run_after=None
[2024-09-08T16:08:10.493-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:08:10.493-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_unknown_never_scheduled to None, run_after=None
[2024-09-08T16:08:10.495-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:08:10.495-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_1 to 2024-09-07 00:00:00+00:00, run_after=2024-09-08 00:00:00+00:00
[2024-09-08T16:08:10.495-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:08:10.495-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_2 to None, run_after=None
[2024-09-08T16:08:10.556-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:08:10.555-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:08:10.557-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:08:10.557-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:08:10.558-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:08:10.558-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:08:10.559-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:08:10.559-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:08:10.560-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:08:10.560-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:08:10.561-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:08:10.561-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:08:10.562-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:08:10.562-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:08:10.563-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:08:10.563-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:08:10.564-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:08:10.564-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:08:10.565-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:08:10.565-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:08:10.566-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:08:10.566-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T16:08:10.567-0300] {processor.py:211} ERROR - Got an exception! Propagating...
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 207, in _run_file_processor
    _handle_dag_file_processing()
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 188, in _handle_dag_file_processing
    result: tuple[int, int, int] = dag_file_processor.process_file(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 942, in process_file
    serialize_errors = DagFileProcessor.save_dag_to_db(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/api_internal/internal_api_call.py", line 139, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 982, in save_dag_to_db
    import_errors = DagBag._sync_to_db(dags=dags, processor_subdir=dag_directory, session=session)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 707, in _sync_to_db
    for attempt in run_with_db_retries(logger=log):
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 443, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 723, in _sync_to_db
    DAG.bulk_write_to_db(dags.values(), processor_subdir=processor_subdir, session=session)
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dag.py", line 3242, in bulk_write_to_db
    orm_dags: list[DagModel] = session.scalars(query).unique().all()
                               ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1778, in scalars
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:11:20.981-0300] {processor.py:186} INFO - Started process (PID=50546) to work on /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T16:11:20.982-0300] {processor.py:914} INFO - Processing file /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py for tasks to queue
[2024-09-08T16:11:20.983-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:11:20.983-0300] {dagbag.py:587} INFO - Filling up the DagBag from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T16:11:20.999-0300] {processor.py:925} INFO - DAG(s) 'dataset_consumes_unknown_never_scheduled', 'dataset_consumes_1_and_2', 'dataset_consumes_1', 'consume_1_and_2_with_dataset_expressions', 'dataset_produces_2', 'dataset_consumes_1_never_scheduled', 'dataset_produces_1', 'consume_1_or_both_2_and_3_with_dataset_expressions', 'conditional_dataset_and_time_based_timetable', 'consume_1_or_2_with_dataset_expressions' retrieved from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T16:11:21.238-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:11:21.238-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T16:11:21.245-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:11:21.245-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_never_scheduled
[2024-09-08T16:11:21.246-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:11:21.246-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_and_2
[2024-09-08T16:11:21.246-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:11:21.246-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_unknown_never_scheduled
[2024-09-08T16:11:21.247-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:11:21.246-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_2_with_dataset_expressions
[2024-09-08T16:11:21.247-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:11:21.247-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_2
[2024-09-08T16:11:21.248-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:11:21.248-0300] {dag.py:3252} INFO - Creating ORM DAG for conditional_dataset_and_time_based_timetable
[2024-09-08T16:11:21.248-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:11:21.248-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_1
[2024-09-08T16:11:21.249-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:11:21.249-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_and_2_with_dataset_expressions
[2024-09-08T16:11:21.249-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:11:21.249-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1
[2024-09-08T16:11:21.250-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:11:21.249-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_both_2_and_3_with_dataset_expressions
[2024-09-08T16:11:21.257-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:11:21.257-0300] {dag.py:4156} INFO - Setting next_dagrun for conditional_dataset_and_time_based_timetable to 2024-09-04 01:00:00+00:00, run_after=2024-09-04 01:00:00+00:00
[2024-09-08T16:11:21.257-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:11:21.257-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_and_2_with_dataset_expressions to None, run_after=None
[2024-09-08T16:11:21.258-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:11:21.258-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_2_with_dataset_expressions to None, run_after=None
[2024-09-08T16:11:21.258-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:11:21.258-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_both_2_and_3_with_dataset_expressions to None, run_after=None
[2024-09-08T16:11:21.258-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:11:21.258-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1 to None, run_after=None
[2024-09-08T16:11:21.259-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:11:21.259-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_and_2 to None, run_after=None
[2024-09-08T16:11:21.259-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:11:21.259-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_never_scheduled to None, run_after=None
[2024-09-08T16:11:21.260-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:11:21.259-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_unknown_never_scheduled to None, run_after=None
[2024-09-08T16:11:21.261-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:11:21.261-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_1 to 2024-09-07 00:00:00+00:00, run_after=2024-09-08 00:00:00+00:00
[2024-09-08T16:11:21.261-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:11:21.261-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_2 to None, run_after=None
[2024-09-08T16:11:21.559-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:11:21.558-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:11:21.560-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:11:21.560-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:11:21.561-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:11:21.560-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:11:21.562-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:11:21.561-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:11:21.563-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:11:21.562-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:11:21.563-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:11:21.563-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:11:21.564-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:11:21.564-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:11:21.565-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:11:21.565-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:11:21.567-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:11:21.566-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:11:21.568-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:11:21.567-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:11:21.569-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:11:21.569-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T16:11:21.570-0300] {processor.py:211} ERROR - Got an exception! Propagating...
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 207, in _run_file_processor
    _handle_dag_file_processing()
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 188, in _handle_dag_file_processing
    result: tuple[int, int, int] = dag_file_processor.process_file(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 942, in process_file
    serialize_errors = DagFileProcessor.save_dag_to_db(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/api_internal/internal_api_call.py", line 139, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 982, in save_dag_to_db
    import_errors = DagBag._sync_to_db(dags=dags, processor_subdir=dag_directory, session=session)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 707, in _sync_to_db
    for attempt in run_with_db_retries(logger=log):
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 443, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 723, in _sync_to_db
    DAG.bulk_write_to_db(dags.values(), processor_subdir=processor_subdir, session=session)
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dag.py", line 3242, in bulk_write_to_db
    orm_dags: list[DagModel] = session.scalars(query).unique().all()
                               ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1778, in scalars
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:14:02.591-0300] {processor.py:186} INFO - Started process (PID=52005) to work on /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T16:14:02.592-0300] {processor.py:914} INFO - Processing file /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py for tasks to queue
[2024-09-08T16:14:02.593-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:14:02.593-0300] {dagbag.py:587} INFO - Filling up the DagBag from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T16:14:02.605-0300] {processor.py:925} INFO - DAG(s) 'consume_1_or_both_2_and_3_with_dataset_expressions', 'dataset_consumes_1', 'conditional_dataset_and_time_based_timetable', 'dataset_consumes_1_never_scheduled', 'consume_1_or_2_with_dataset_expressions', 'dataset_produces_2', 'dataset_consumes_1_and_2', 'consume_1_and_2_with_dataset_expressions', 'dataset_consumes_unknown_never_scheduled', 'dataset_produces_1' retrieved from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T16:14:02.767-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:14:02.766-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T16:14:02.774-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:14:02.774-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_never_scheduled
[2024-09-08T16:14:02.775-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:14:02.774-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_and_2
[2024-09-08T16:14:02.775-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:14:02.775-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_unknown_never_scheduled
[2024-09-08T16:14:02.775-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:14:02.775-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_2_with_dataset_expressions
[2024-09-08T16:14:02.776-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:14:02.776-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_2
[2024-09-08T16:14:02.776-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:14:02.776-0300] {dag.py:3252} INFO - Creating ORM DAG for conditional_dataset_and_time_based_timetable
[2024-09-08T16:14:02.776-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:14:02.776-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_1
[2024-09-08T16:14:02.777-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:14:02.777-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_and_2_with_dataset_expressions
[2024-09-08T16:14:02.777-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:14:02.777-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1
[2024-09-08T16:14:02.778-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:14:02.777-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_both_2_and_3_with_dataset_expressions
[2024-09-08T16:14:02.787-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:14:02.787-0300] {dag.py:4156} INFO - Setting next_dagrun for conditional_dataset_and_time_based_timetable to 2024-09-04 01:00:00+00:00, run_after=2024-09-04 01:00:00+00:00
[2024-09-08T16:14:02.788-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:14:02.788-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_and_2_with_dataset_expressions to None, run_after=None
[2024-09-08T16:14:02.788-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:14:02.788-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_2_with_dataset_expressions to None, run_after=None
[2024-09-08T16:14:02.788-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:14:02.788-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_both_2_and_3_with_dataset_expressions to None, run_after=None
[2024-09-08T16:14:02.788-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:14:02.788-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1 to None, run_after=None
[2024-09-08T16:14:02.789-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:14:02.789-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_and_2 to None, run_after=None
[2024-09-08T16:14:02.789-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:14:02.789-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_never_scheduled to None, run_after=None
[2024-09-08T16:14:02.789-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:14:02.789-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_unknown_never_scheduled to None, run_after=None
[2024-09-08T16:14:02.791-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:14:02.791-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_1 to 2024-09-07 00:00:00+00:00, run_after=2024-09-08 00:00:00+00:00
[2024-09-08T16:14:02.791-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:14:02.791-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_2 to None, run_after=None
[2024-09-08T16:14:03.236-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:14:03.234-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:14:03.237-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:14:03.237-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:14:03.239-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:14:03.238-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:14:03.239-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:14:03.239-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:14:03.240-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:14:03.240-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:14:03.242-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:14:03.241-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:14:03.243-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:14:03.242-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:14:03.243-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:14:03.243-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:14:03.244-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:14:03.244-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:14:03.245-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:14:03.245-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:14:03.246-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:14:03.246-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T16:14:03.246-0300] {processor.py:211} ERROR - Got an exception! Propagating...
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 207, in _run_file_processor
    _handle_dag_file_processing()
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 188, in _handle_dag_file_processing
    result: tuple[int, int, int] = dag_file_processor.process_file(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 942, in process_file
    serialize_errors = DagFileProcessor.save_dag_to_db(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/api_internal/internal_api_call.py", line 139, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 982, in save_dag_to_db
    import_errors = DagBag._sync_to_db(dags=dags, processor_subdir=dag_directory, session=session)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 707, in _sync_to_db
    for attempt in run_with_db_retries(logger=log):
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 443, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 723, in _sync_to_db
    DAG.bulk_write_to_db(dags.values(), processor_subdir=processor_subdir, session=session)
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dag.py", line 3242, in bulk_write_to_db
    orm_dags: list[DagModel] = session.scalars(query).unique().all()
                               ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1778, in scalars
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:15:23.718-0300] {processor.py:186} INFO - Started process (PID=52704) to work on /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T16:15:23.719-0300] {processor.py:914} INFO - Processing file /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py for tasks to queue
[2024-09-08T16:15:23.722-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:15:23.721-0300] {dagbag.py:587} INFO - Filling up the DagBag from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T16:15:23.734-0300] {processor.py:925} INFO - DAG(s) 'dataset_consumes_1', 'consume_1_and_2_with_dataset_expressions', 'conditional_dataset_and_time_based_timetable', 'consume_1_or_both_2_and_3_with_dataset_expressions', 'dataset_produces_1', 'dataset_consumes_1_never_scheduled', 'dataset_produces_2', 'dataset_consumes_1_and_2', 'consume_1_or_2_with_dataset_expressions', 'dataset_consumes_unknown_never_scheduled' retrieved from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T16:15:23.972-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:15:23.972-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T16:15:23.980-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:15:23.979-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_never_scheduled
[2024-09-08T16:15:23.980-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:15:23.980-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_and_2
[2024-09-08T16:15:23.981-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:15:23.981-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_unknown_never_scheduled
[2024-09-08T16:15:23.981-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:15:23.981-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_2_with_dataset_expressions
[2024-09-08T16:15:23.982-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:15:23.981-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_2
[2024-09-08T16:15:23.982-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:15:23.982-0300] {dag.py:3252} INFO - Creating ORM DAG for conditional_dataset_and_time_based_timetable
[2024-09-08T16:15:23.982-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:15:23.982-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_1
[2024-09-08T16:15:23.983-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:15:23.983-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_and_2_with_dataset_expressions
[2024-09-08T16:15:23.983-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:15:23.983-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1
[2024-09-08T16:15:23.983-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:15:23.983-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_both_2_and_3_with_dataset_expressions
[2024-09-08T16:15:23.991-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:15:23.991-0300] {dag.py:4156} INFO - Setting next_dagrun for conditional_dataset_and_time_based_timetable to 2024-09-04 01:00:00+00:00, run_after=2024-09-04 01:00:00+00:00
[2024-09-08T16:15:23.991-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:15:23.991-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_and_2_with_dataset_expressions to None, run_after=None
[2024-09-08T16:15:23.992-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:15:23.991-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_2_with_dataset_expressions to None, run_after=None
[2024-09-08T16:15:23.992-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:15:23.992-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_both_2_and_3_with_dataset_expressions to None, run_after=None
[2024-09-08T16:15:23.992-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:15:23.992-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1 to None, run_after=None
[2024-09-08T16:15:23.992-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:15:23.992-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_and_2 to None, run_after=None
[2024-09-08T16:15:23.993-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:15:23.993-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_never_scheduled to None, run_after=None
[2024-09-08T16:15:23.993-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:15:23.993-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_unknown_never_scheduled to None, run_after=None
[2024-09-08T16:15:23.994-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:15:23.994-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_1 to 2024-09-07 00:00:00+00:00, run_after=2024-09-08 00:00:00+00:00
[2024-09-08T16:15:23.995-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:15:23.995-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_2 to None, run_after=None
[2024-09-08T16:15:24.404-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:15:24.403-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:15:24.406-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:15:24.405-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:15:24.407-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:15:24.406-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:15:24.408-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:15:24.407-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:15:24.409-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:15:24.408-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:15:24.410-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:15:24.409-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:15:24.410-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:15:24.410-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:15:24.411-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:15:24.411-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:15:24.412-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:15:24.412-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:15:24.413-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:15:24.413-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:15:24.414-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:15:24.414-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T16:15:24.415-0300] {processor.py:211} ERROR - Got an exception! Propagating...
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 207, in _run_file_processor
    _handle_dag_file_processing()
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 188, in _handle_dag_file_processing
    result: tuple[int, int, int] = dag_file_processor.process_file(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 942, in process_file
    serialize_errors = DagFileProcessor.save_dag_to_db(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/api_internal/internal_api_call.py", line 139, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 982, in save_dag_to_db
    import_errors = DagBag._sync_to_db(dags=dags, processor_subdir=dag_directory, session=session)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 707, in _sync_to_db
    for attempt in run_with_db_retries(logger=log):
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 443, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 723, in _sync_to_db
    DAG.bulk_write_to_db(dags.values(), processor_subdir=processor_subdir, session=session)
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dag.py", line 3242, in bulk_write_to_db
    orm_dags: list[DagModel] = session.scalars(query).unique().all()
                               ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1778, in scalars
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:16:40.895-0300] {processor.py:186} INFO - Started process (PID=53259) to work on /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T16:16:40.896-0300] {processor.py:914} INFO - Processing file /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py for tasks to queue
[2024-09-08T16:16:40.897-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:16:40.897-0300] {dagbag.py:587} INFO - Filling up the DagBag from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T16:16:40.907-0300] {processor.py:925} INFO - DAG(s) 'conditional_dataset_and_time_based_timetable', 'dataset_consumes_1_and_2', 'dataset_consumes_unknown_never_scheduled', 'dataset_consumes_1_never_scheduled', 'consume_1_or_2_with_dataset_expressions', 'dataset_consumes_1', 'dataset_produces_2', 'dataset_produces_1', 'consume_1_or_both_2_and_3_with_dataset_expressions', 'consume_1_and_2_with_dataset_expressions' retrieved from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T16:16:41.057-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:16:41.057-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T16:16:41.064-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:16:41.064-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_never_scheduled
[2024-09-08T16:16:41.065-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:16:41.065-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_and_2
[2024-09-08T16:16:41.065-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:16:41.065-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_unknown_never_scheduled
[2024-09-08T16:16:41.065-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:16:41.065-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_2_with_dataset_expressions
[2024-09-08T16:16:41.066-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:16:41.066-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_2
[2024-09-08T16:16:41.066-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:16:41.066-0300] {dag.py:3252} INFO - Creating ORM DAG for conditional_dataset_and_time_based_timetable
[2024-09-08T16:16:41.066-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:16:41.066-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_1
[2024-09-08T16:16:41.067-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:16:41.067-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_and_2_with_dataset_expressions
[2024-09-08T16:16:41.067-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:16:41.067-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1
[2024-09-08T16:16:41.067-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:16:41.067-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_both_2_and_3_with_dataset_expressions
[2024-09-08T16:16:41.074-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:16:41.073-0300] {dag.py:4156} INFO - Setting next_dagrun for conditional_dataset_and_time_based_timetable to 2024-09-04 01:00:00+00:00, run_after=2024-09-04 01:00:00+00:00
[2024-09-08T16:16:41.074-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:16:41.074-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_and_2_with_dataset_expressions to None, run_after=None
[2024-09-08T16:16:41.074-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:16:41.074-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_2_with_dataset_expressions to None, run_after=None
[2024-09-08T16:16:41.074-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:16:41.074-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_both_2_and_3_with_dataset_expressions to None, run_after=None
[2024-09-08T16:16:41.075-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:16:41.075-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1 to None, run_after=None
[2024-09-08T16:16:41.075-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:16:41.075-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_and_2 to None, run_after=None
[2024-09-08T16:16:41.075-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:16:41.075-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_never_scheduled to None, run_after=None
[2024-09-08T16:16:41.076-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:16:41.076-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_unknown_never_scheduled to None, run_after=None
[2024-09-08T16:16:41.077-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:16:41.077-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_1 to 2024-09-07 00:00:00+00:00, run_after=2024-09-08 00:00:00+00:00
[2024-09-08T16:16:41.077-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:16:41.077-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_2 to None, run_after=None
[2024-09-08T16:16:41.370-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:16:41.369-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:16:41.371-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:16:41.371-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:16:41.372-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:16:41.372-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:16:41.373-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:16:41.373-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:16:41.374-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:16:41.374-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:16:41.375-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:16:41.375-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:16:41.376-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:16:41.376-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:16:41.377-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:16:41.376-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:16:41.378-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:16:41.377-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:16:41.379-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:16:41.378-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:16:41.379-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:16:41.379-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T16:16:41.380-0300] {processor.py:211} ERROR - Got an exception! Propagating...
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 207, in _run_file_processor
    _handle_dag_file_processing()
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 188, in _handle_dag_file_processing
    result: tuple[int, int, int] = dag_file_processor.process_file(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 942, in process_file
    serialize_errors = DagFileProcessor.save_dag_to_db(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/api_internal/internal_api_call.py", line 139, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 982, in save_dag_to_db
    import_errors = DagBag._sync_to_db(dags=dags, processor_subdir=dag_directory, session=session)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 707, in _sync_to_db
    for attempt in run_with_db_retries(logger=log):
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 443, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 723, in _sync_to_db
    DAG.bulk_write_to_db(dags.values(), processor_subdir=processor_subdir, session=session)
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dag.py", line 3242, in bulk_write_to_db
    orm_dags: list[DagModel] = session.scalars(query).unique().all()
                               ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1778, in scalars
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:17:53.969-0300] {processor.py:186} INFO - Started process (PID=53875) to work on /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T16:17:53.970-0300] {processor.py:914} INFO - Processing file /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py for tasks to queue
[2024-09-08T16:17:53.971-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:17:53.971-0300] {dagbag.py:587} INFO - Filling up the DagBag from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T16:17:53.983-0300] {processor.py:925} INFO - DAG(s) 'dataset_consumes_unknown_never_scheduled', 'consume_1_and_2_with_dataset_expressions', 'dataset_consumes_1', 'dataset_consumes_1_and_2', 'consume_1_or_2_with_dataset_expressions', 'consume_1_or_both_2_and_3_with_dataset_expressions', 'dataset_produces_1', 'dataset_consumes_1_never_scheduled', 'dataset_produces_2', 'conditional_dataset_and_time_based_timetable' retrieved from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T16:17:54.147-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:17:54.147-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T16:17:54.155-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:17:54.155-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_never_scheduled
[2024-09-08T16:17:54.156-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:17:54.156-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_and_2
[2024-09-08T16:17:54.157-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:17:54.156-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_unknown_never_scheduled
[2024-09-08T16:17:54.157-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:17:54.157-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_2_with_dataset_expressions
[2024-09-08T16:17:54.157-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:17:54.157-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_2
[2024-09-08T16:17:54.158-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:17:54.158-0300] {dag.py:3252} INFO - Creating ORM DAG for conditional_dataset_and_time_based_timetable
[2024-09-08T16:17:54.159-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:17:54.158-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_1
[2024-09-08T16:17:54.159-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:17:54.159-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_and_2_with_dataset_expressions
[2024-09-08T16:17:54.160-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:17:54.160-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1
[2024-09-08T16:17:54.160-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:17:54.160-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_both_2_and_3_with_dataset_expressions
[2024-09-08T16:17:54.167-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:17:54.167-0300] {dag.py:4156} INFO - Setting next_dagrun for conditional_dataset_and_time_based_timetable to 2024-09-04 01:00:00+00:00, run_after=2024-09-04 01:00:00+00:00
[2024-09-08T16:17:54.167-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:17:54.167-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_and_2_with_dataset_expressions to None, run_after=None
[2024-09-08T16:17:54.168-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:17:54.168-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_2_with_dataset_expressions to None, run_after=None
[2024-09-08T16:17:54.168-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:17:54.168-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_both_2_and_3_with_dataset_expressions to None, run_after=None
[2024-09-08T16:17:54.168-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:17:54.168-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1 to None, run_after=None
[2024-09-08T16:17:54.168-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:17:54.168-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_and_2 to None, run_after=None
[2024-09-08T16:17:54.169-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:17:54.169-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_never_scheduled to None, run_after=None
[2024-09-08T16:17:54.169-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:17:54.169-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_unknown_never_scheduled to None, run_after=None
[2024-09-08T16:17:54.170-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:17:54.170-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_1 to 2024-09-07 00:00:00+00:00, run_after=2024-09-08 00:00:00+00:00
[2024-09-08T16:17:54.171-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:17:54.171-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_2 to None, run_after=None
[2024-09-08T16:17:54.232-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:17:54.231-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:17:54.233-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:17:54.233-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:17:54.234-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:17:54.234-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:17:54.235-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:17:54.235-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:17:54.236-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:17:54.236-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:17:54.237-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:17:54.237-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:17:54.238-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:17:54.237-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:17:54.239-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:17:54.238-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:17:54.240-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:17:54.239-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:17:54.240-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:17:54.240-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:17:54.241-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:17:54.241-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T16:17:54.242-0300] {processor.py:211} ERROR - Got an exception! Propagating...
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 207, in _run_file_processor
    _handle_dag_file_processing()
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 188, in _handle_dag_file_processing
    result: tuple[int, int, int] = dag_file_processor.process_file(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 942, in process_file
    serialize_errors = DagFileProcessor.save_dag_to_db(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/api_internal/internal_api_call.py", line 139, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 982, in save_dag_to_db
    import_errors = DagBag._sync_to_db(dags=dags, processor_subdir=dag_directory, session=session)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 707, in _sync_to_db
    for attempt in run_with_db_retries(logger=log):
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 443, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 723, in _sync_to_db
    DAG.bulk_write_to_db(dags.values(), processor_subdir=processor_subdir, session=session)
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dag.py", line 3242, in bulk_write_to_db
    orm_dags: list[DagModel] = session.scalars(query).unique().all()
                               ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1778, in scalars
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:19:13.865-0300] {processor.py:186} INFO - Started process (PID=54574) to work on /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T16:19:13.866-0300] {processor.py:914} INFO - Processing file /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py for tasks to queue
[2024-09-08T16:19:13.867-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:19:13.866-0300] {dagbag.py:587} INFO - Filling up the DagBag from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T16:19:13.877-0300] {processor.py:925} INFO - DAG(s) 'dataset_produces_2', 'conditional_dataset_and_time_based_timetable', 'consume_1_and_2_with_dataset_expressions', 'dataset_consumes_unknown_never_scheduled', 'dataset_consumes_1', 'dataset_consumes_1_never_scheduled', 'dataset_consumes_1_and_2', 'consume_1_or_both_2_and_3_with_dataset_expressions', 'consume_1_or_2_with_dataset_expressions', 'dataset_produces_1' retrieved from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T16:19:14.040-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:19:14.040-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T16:19:14.048-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:19:14.048-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_never_scheduled
[2024-09-08T16:19:14.049-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:19:14.048-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_and_2
[2024-09-08T16:19:14.049-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:19:14.049-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_unknown_never_scheduled
[2024-09-08T16:19:14.049-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:19:14.049-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_2_with_dataset_expressions
[2024-09-08T16:19:14.050-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:19:14.050-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_2
[2024-09-08T16:19:14.050-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:19:14.050-0300] {dag.py:3252} INFO - Creating ORM DAG for conditional_dataset_and_time_based_timetable
[2024-09-08T16:19:14.050-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:19:14.050-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_1
[2024-09-08T16:19:14.051-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:19:14.051-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_and_2_with_dataset_expressions
[2024-09-08T16:19:14.051-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:19:14.051-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1
[2024-09-08T16:19:14.052-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:19:14.051-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_both_2_and_3_with_dataset_expressions
[2024-09-08T16:19:14.058-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:19:14.058-0300] {dag.py:4156} INFO - Setting next_dagrun for conditional_dataset_and_time_based_timetable to 2024-09-04 01:00:00+00:00, run_after=2024-09-04 01:00:00+00:00
[2024-09-08T16:19:14.059-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:19:14.059-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_and_2_with_dataset_expressions to None, run_after=None
[2024-09-08T16:19:14.059-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:19:14.059-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_2_with_dataset_expressions to None, run_after=None
[2024-09-08T16:19:14.059-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:19:14.059-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_both_2_and_3_with_dataset_expressions to None, run_after=None
[2024-09-08T16:19:14.059-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:19:14.059-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1 to None, run_after=None
[2024-09-08T16:19:14.060-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:19:14.060-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_and_2 to None, run_after=None
[2024-09-08T16:19:14.060-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:19:14.060-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_never_scheduled to None, run_after=None
[2024-09-08T16:19:14.060-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:19:14.060-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_unknown_never_scheduled to None, run_after=None
[2024-09-08T16:19:14.062-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:19:14.062-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_1 to 2024-09-07 00:00:00+00:00, run_after=2024-09-08 00:00:00+00:00
[2024-09-08T16:19:14.062-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:19:14.062-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_2 to None, run_after=None
[2024-09-08T16:19:14.198-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:19:14.196-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:19:14.199-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:19:14.199-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:19:14.200-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:19:14.199-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:19:14.201-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:19:14.200-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:19:14.202-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:19:14.201-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:19:14.202-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:19:14.202-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:19:14.203-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:19:14.203-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:19:14.204-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:19:14.204-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:19:14.205-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:19:14.205-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:19:14.206-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:19:14.206-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:19:14.207-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:19:14.207-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T16:19:14.207-0300] {processor.py:211} ERROR - Got an exception! Propagating...
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 207, in _run_file_processor
    _handle_dag_file_processing()
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 188, in _handle_dag_file_processing
    result: tuple[int, int, int] = dag_file_processor.process_file(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 942, in process_file
    serialize_errors = DagFileProcessor.save_dag_to_db(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/api_internal/internal_api_call.py", line 139, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 982, in save_dag_to_db
    import_errors = DagBag._sync_to_db(dags=dags, processor_subdir=dag_directory, session=session)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 707, in _sync_to_db
    for attempt in run_with_db_retries(logger=log):
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 443, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 723, in _sync_to_db
    DAG.bulk_write_to_db(dags.values(), processor_subdir=processor_subdir, session=session)
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dag.py", line 3242, in bulk_write_to_db
    orm_dags: list[DagModel] = session.scalars(query).unique().all()
                               ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1778, in scalars
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:20:36.006-0300] {processor.py:186} INFO - Started process (PID=55472) to work on /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T16:20:36.006-0300] {processor.py:914} INFO - Processing file /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py for tasks to queue
[2024-09-08T16:20:36.007-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:20:36.007-0300] {dagbag.py:587} INFO - Filling up the DagBag from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T16:20:36.017-0300] {processor.py:925} INFO - DAG(s) 'consume_1_or_2_with_dataset_expressions', 'dataset_consumes_unknown_never_scheduled', 'dataset_consumes_1_never_scheduled', 'dataset_consumes_1', 'dataset_consumes_1_and_2', 'conditional_dataset_and_time_based_timetable', 'consume_1_and_2_with_dataset_expressions', 'dataset_produces_2', 'consume_1_or_both_2_and_3_with_dataset_expressions', 'dataset_produces_1' retrieved from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T16:20:36.160-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:20:36.160-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T16:20:36.168-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:20:36.168-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_never_scheduled
[2024-09-08T16:20:36.169-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:20:36.169-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_and_2
[2024-09-08T16:20:36.169-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:20:36.169-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_unknown_never_scheduled
[2024-09-08T16:20:36.170-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:20:36.170-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_2_with_dataset_expressions
[2024-09-08T16:20:36.170-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:20:36.170-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_2
[2024-09-08T16:20:36.170-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:20:36.170-0300] {dag.py:3252} INFO - Creating ORM DAG for conditional_dataset_and_time_based_timetable
[2024-09-08T16:20:36.171-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:20:36.171-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_1
[2024-09-08T16:20:36.171-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:20:36.171-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_and_2_with_dataset_expressions
[2024-09-08T16:20:36.171-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:20:36.171-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1
[2024-09-08T16:20:36.172-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:20:36.172-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_both_2_and_3_with_dataset_expressions
[2024-09-08T16:20:36.178-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:20:36.178-0300] {dag.py:4156} INFO - Setting next_dagrun for conditional_dataset_and_time_based_timetable to 2024-09-04 01:00:00+00:00, run_after=2024-09-04 01:00:00+00:00
[2024-09-08T16:20:36.178-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:20:36.178-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_and_2_with_dataset_expressions to None, run_after=None
[2024-09-08T16:20:36.179-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:20:36.179-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_2_with_dataset_expressions to None, run_after=None
[2024-09-08T16:20:36.179-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:20:36.179-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_both_2_and_3_with_dataset_expressions to None, run_after=None
[2024-09-08T16:20:36.179-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:20:36.179-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1 to None, run_after=None
[2024-09-08T16:20:36.179-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:20:36.179-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_and_2 to None, run_after=None
[2024-09-08T16:20:36.180-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:20:36.180-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_never_scheduled to None, run_after=None
[2024-09-08T16:20:36.180-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:20:36.180-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_unknown_never_scheduled to None, run_after=None
[2024-09-08T16:20:36.181-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:20:36.181-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_1 to 2024-09-07 00:00:00+00:00, run_after=2024-09-08 00:00:00+00:00
[2024-09-08T16:20:36.182-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:20:36.182-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_2 to None, run_after=None
[2024-09-08T16:20:36.362-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:20:36.360-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:20:36.363-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:20:36.363-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:20:36.364-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:20:36.364-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:20:36.365-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:20:36.364-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:20:36.366-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:20:36.365-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:20:36.367-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:20:36.366-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:20:36.368-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:20:36.368-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:20:36.370-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:20:36.369-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:20:36.370-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:20:36.370-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:20:36.371-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:20:36.371-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:20:36.372-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:20:36.372-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T16:20:36.373-0300] {processor.py:211} ERROR - Got an exception! Propagating...
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 207, in _run_file_processor
    _handle_dag_file_processing()
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 188, in _handle_dag_file_processing
    result: tuple[int, int, int] = dag_file_processor.process_file(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 942, in process_file
    serialize_errors = DagFileProcessor.save_dag_to_db(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/api_internal/internal_api_call.py", line 139, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 982, in save_dag_to_db
    import_errors = DagBag._sync_to_db(dags=dags, processor_subdir=dag_directory, session=session)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 707, in _sync_to_db
    for attempt in run_with_db_retries(logger=log):
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 443, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 723, in _sync_to_db
    DAG.bulk_write_to_db(dags.values(), processor_subdir=processor_subdir, session=session)
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dag.py", line 3242, in bulk_write_to_db
    orm_dags: list[DagModel] = session.scalars(query).unique().all()
                               ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1778, in scalars
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:21:54.602-0300] {processor.py:186} INFO - Started process (PID=57364) to work on /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T16:21:54.602-0300] {processor.py:914} INFO - Processing file /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py for tasks to queue
[2024-09-08T16:21:54.603-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:21:54.603-0300] {dagbag.py:587} INFO - Filling up the DagBag from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T16:21:54.613-0300] {processor.py:925} INFO - DAG(s) 'dataset_consumes_1_and_2', 'dataset_consumes_1', 'dataset_consumes_1_never_scheduled', 'conditional_dataset_and_time_based_timetable', 'consume_1_or_both_2_and_3_with_dataset_expressions', 'consume_1_and_2_with_dataset_expressions', 'dataset_produces_2', 'dataset_consumes_unknown_never_scheduled', 'dataset_produces_1', 'consume_1_or_2_with_dataset_expressions' retrieved from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T16:21:54.756-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:21:54.756-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T16:21:54.763-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:21:54.763-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_never_scheduled
[2024-09-08T16:21:54.763-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:21:54.763-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_and_2
[2024-09-08T16:21:54.764-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:21:54.764-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_unknown_never_scheduled
[2024-09-08T16:21:54.764-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:21:54.764-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_2_with_dataset_expressions
[2024-09-08T16:21:54.765-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:21:54.764-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_2
[2024-09-08T16:21:54.765-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:21:54.765-0300] {dag.py:3252} INFO - Creating ORM DAG for conditional_dataset_and_time_based_timetable
[2024-09-08T16:21:54.765-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:21:54.765-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_1
[2024-09-08T16:21:54.766-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:21:54.766-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_and_2_with_dataset_expressions
[2024-09-08T16:21:54.766-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:21:54.766-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1
[2024-09-08T16:21:54.766-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:21:54.766-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_both_2_and_3_with_dataset_expressions
[2024-09-08T16:21:54.773-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:21:54.773-0300] {dag.py:4156} INFO - Setting next_dagrun for conditional_dataset_and_time_based_timetable to 2024-09-04 01:00:00+00:00, run_after=2024-09-04 01:00:00+00:00
[2024-09-08T16:21:54.773-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:21:54.773-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_and_2_with_dataset_expressions to None, run_after=None
[2024-09-08T16:21:54.774-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:21:54.774-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_2_with_dataset_expressions to None, run_after=None
[2024-09-08T16:21:54.774-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:21:54.774-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_both_2_and_3_with_dataset_expressions to None, run_after=None
[2024-09-08T16:21:54.774-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:21:54.774-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1 to None, run_after=None
[2024-09-08T16:21:54.774-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:21:54.774-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_and_2 to None, run_after=None
[2024-09-08T16:21:54.775-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:21:54.775-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_never_scheduled to None, run_after=None
[2024-09-08T16:21:54.775-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:21:54.775-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_unknown_never_scheduled to None, run_after=None
[2024-09-08T16:21:54.776-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:21:54.776-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_1 to 2024-09-07 00:00:00+00:00, run_after=2024-09-08 00:00:00+00:00
[2024-09-08T16:21:54.776-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:21:54.776-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_2 to None, run_after=None
[2024-09-08T16:21:55.262-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:21:55.261-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:21:55.263-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:21:55.263-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:21:55.264-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:21:55.264-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:21:55.265-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:21:55.265-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:21:55.266-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:21:55.265-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:21:55.267-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:21:55.266-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:21:55.268-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:21:55.267-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:21:55.268-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:21:55.268-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:21:55.269-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:21:55.269-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:21:55.270-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:21:55.270-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:21:55.271-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:21:55.270-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T16:21:55.271-0300] {processor.py:211} ERROR - Got an exception! Propagating...
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 207, in _run_file_processor
    _handle_dag_file_processing()
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 188, in _handle_dag_file_processing
    result: tuple[int, int, int] = dag_file_processor.process_file(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 942, in process_file
    serialize_errors = DagFileProcessor.save_dag_to_db(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/api_internal/internal_api_call.py", line 139, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 982, in save_dag_to_db
    import_errors = DagBag._sync_to_db(dags=dags, processor_subdir=dag_directory, session=session)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 707, in _sync_to_db
    for attempt in run_with_db_retries(logger=log):
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 443, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 723, in _sync_to_db
    DAG.bulk_write_to_db(dags.values(), processor_subdir=processor_subdir, session=session)
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dag.py", line 3242, in bulk_write_to_db
    orm_dags: list[DagModel] = session.scalars(query).unique().all()
                               ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1778, in scalars
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:23:28.637-0300] {processor.py:186} INFO - Started process (PID=58343) to work on /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T16:23:28.638-0300] {processor.py:914} INFO - Processing file /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py for tasks to queue
[2024-09-08T16:23:28.639-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:23:28.638-0300] {dagbag.py:587} INFO - Filling up the DagBag from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T16:23:28.649-0300] {processor.py:925} INFO - DAG(s) 'dataset_consumes_unknown_never_scheduled', 'dataset_consumes_1', 'consume_1_or_both_2_and_3_with_dataset_expressions', 'dataset_produces_2', 'dataset_consumes_1_never_scheduled', 'dataset_consumes_1_and_2', 'conditional_dataset_and_time_based_timetable', 'consume_1_and_2_with_dataset_expressions', 'consume_1_or_2_with_dataset_expressions', 'dataset_produces_1' retrieved from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T16:23:28.808-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:23:28.807-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T16:23:28.816-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:23:28.815-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_never_scheduled
[2024-09-08T16:23:28.816-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:23:28.816-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_and_2
[2024-09-08T16:23:28.816-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:23:28.816-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_unknown_never_scheduled
[2024-09-08T16:23:28.817-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:23:28.817-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_2_with_dataset_expressions
[2024-09-08T16:23:28.817-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:23:28.817-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_2
[2024-09-08T16:23:28.817-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:23:28.817-0300] {dag.py:3252} INFO - Creating ORM DAG for conditional_dataset_and_time_based_timetable
[2024-09-08T16:23:28.818-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:23:28.818-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_1
[2024-09-08T16:23:28.818-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:23:28.818-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_and_2_with_dataset_expressions
[2024-09-08T16:23:28.818-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:23:28.818-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1
[2024-09-08T16:23:28.819-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:23:28.819-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_both_2_and_3_with_dataset_expressions
[2024-09-08T16:23:28.826-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:23:28.826-0300] {dag.py:4156} INFO - Setting next_dagrun for conditional_dataset_and_time_based_timetable to 2024-09-04 01:00:00+00:00, run_after=2024-09-04 01:00:00+00:00
[2024-09-08T16:23:28.827-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:23:28.826-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_and_2_with_dataset_expressions to None, run_after=None
[2024-09-08T16:23:28.827-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:23:28.827-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_2_with_dataset_expressions to None, run_after=None
[2024-09-08T16:23:28.827-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:23:28.827-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_both_2_and_3_with_dataset_expressions to None, run_after=None
[2024-09-08T16:23:28.827-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:23:28.827-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1 to None, run_after=None
[2024-09-08T16:23:28.828-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:23:28.827-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_and_2 to None, run_after=None
[2024-09-08T16:23:28.828-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:23:28.828-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_never_scheduled to None, run_after=None
[2024-09-08T16:23:28.828-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:23:28.828-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_unknown_never_scheduled to None, run_after=None
[2024-09-08T16:23:28.829-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:23:28.829-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_1 to 2024-09-07 00:00:00+00:00, run_after=2024-09-08 00:00:00+00:00
[2024-09-08T16:23:28.830-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:23:28.830-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_2 to None, run_after=None
[2024-09-08T16:23:29.141-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:23:29.140-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:23:29.142-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:23:29.142-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:23:29.143-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:23:29.143-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:23:29.144-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:23:29.144-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:23:29.145-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:23:29.145-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:23:29.146-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:23:29.145-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:23:29.147-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:23:29.146-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:23:29.147-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:23:29.147-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:23:29.148-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:23:29.148-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:23:29.149-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:23:29.149-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:23:29.150-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:23:29.150-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T16:23:29.150-0300] {processor.py:211} ERROR - Got an exception! Propagating...
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 207, in _run_file_processor
    _handle_dag_file_processing()
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 188, in _handle_dag_file_processing
    result: tuple[int, int, int] = dag_file_processor.process_file(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 942, in process_file
    serialize_errors = DagFileProcessor.save_dag_to_db(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/api_internal/internal_api_call.py", line 139, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 982, in save_dag_to_db
    import_errors = DagBag._sync_to_db(dags=dags, processor_subdir=dag_directory, session=session)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 707, in _sync_to_db
    for attempt in run_with_db_retries(logger=log):
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 443, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 723, in _sync_to_db
    DAG.bulk_write_to_db(dags.values(), processor_subdir=processor_subdir, session=session)
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dag.py", line 3242, in bulk_write_to_db
    orm_dags: list[DagModel] = session.scalars(query).unique().all()
                               ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1778, in scalars
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:24:47.925-0300] {processor.py:186} INFO - Started process (PID=59084) to work on /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T16:24:47.926-0300] {processor.py:914} INFO - Processing file /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py for tasks to queue
[2024-09-08T16:24:47.927-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:24:47.927-0300] {dagbag.py:587} INFO - Filling up the DagBag from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T16:24:47.938-0300] {processor.py:925} INFO - DAG(s) 'dataset_consumes_1_and_2', 'dataset_consumes_1', 'dataset_produces_2', 'dataset_consumes_unknown_never_scheduled', 'dataset_consumes_1_never_scheduled', 'consume_1_or_both_2_and_3_with_dataset_expressions', 'consume_1_or_2_with_dataset_expressions', 'conditional_dataset_and_time_based_timetable', 'consume_1_and_2_with_dataset_expressions', 'dataset_produces_1' retrieved from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T16:24:48.106-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:24:48.106-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T16:24:48.113-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:24:48.113-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_never_scheduled
[2024-09-08T16:24:48.114-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:24:48.114-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_and_2
[2024-09-08T16:24:48.114-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:24:48.114-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_unknown_never_scheduled
[2024-09-08T16:24:48.114-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:24:48.114-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_2_with_dataset_expressions
[2024-09-08T16:24:48.115-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:24:48.115-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_2
[2024-09-08T16:24:48.115-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:24:48.115-0300] {dag.py:3252} INFO - Creating ORM DAG for conditional_dataset_and_time_based_timetable
[2024-09-08T16:24:48.115-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:24:48.115-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_1
[2024-09-08T16:24:48.116-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:24:48.116-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_and_2_with_dataset_expressions
[2024-09-08T16:24:48.116-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:24:48.116-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1
[2024-09-08T16:24:48.117-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:24:48.116-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_both_2_and_3_with_dataset_expressions
[2024-09-08T16:24:48.124-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:24:48.124-0300] {dag.py:4156} INFO - Setting next_dagrun for conditional_dataset_and_time_based_timetable to 2024-09-04 01:00:00+00:00, run_after=2024-09-04 01:00:00+00:00
[2024-09-08T16:24:48.125-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:24:48.125-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_and_2_with_dataset_expressions to None, run_after=None
[2024-09-08T16:24:48.125-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:24:48.125-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_2_with_dataset_expressions to None, run_after=None
[2024-09-08T16:24:48.125-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:24:48.125-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_both_2_and_3_with_dataset_expressions to None, run_after=None
[2024-09-08T16:24:48.126-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:24:48.125-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1 to None, run_after=None
[2024-09-08T16:24:48.126-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:24:48.126-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_and_2 to None, run_after=None
[2024-09-08T16:24:48.126-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:24:48.126-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_never_scheduled to None, run_after=None
[2024-09-08T16:24:48.127-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:24:48.126-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_unknown_never_scheduled to None, run_after=None
[2024-09-08T16:24:48.128-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:24:48.128-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_1 to 2024-09-07 00:00:00+00:00, run_after=2024-09-08 00:00:00+00:00
[2024-09-08T16:24:48.128-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:24:48.128-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_2 to None, run_after=None
[2024-09-08T16:24:48.396-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:24:48.395-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:24:48.397-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:24:48.396-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:24:48.398-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:24:48.397-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:24:48.399-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:24:48.398-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:24:48.400-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:24:48.399-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:24:48.401-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:24:48.400-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:24:48.402-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:24:48.401-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:24:48.403-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:24:48.402-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:24:48.404-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:24:48.403-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:24:48.405-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:24:48.404-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:24:48.405-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:24:48.405-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T16:24:48.406-0300] {processor.py:211} ERROR - Got an exception! Propagating...
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 207, in _run_file_processor
    _handle_dag_file_processing()
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 188, in _handle_dag_file_processing
    result: tuple[int, int, int] = dag_file_processor.process_file(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 942, in process_file
    serialize_errors = DagFileProcessor.save_dag_to_db(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/api_internal/internal_api_call.py", line 139, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 982, in save_dag_to_db
    import_errors = DagBag._sync_to_db(dags=dags, processor_subdir=dag_directory, session=session)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 707, in _sync_to_db
    for attempt in run_with_db_retries(logger=log):
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 443, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 723, in _sync_to_db
    DAG.bulk_write_to_db(dags.values(), processor_subdir=processor_subdir, session=session)
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dag.py", line 3242, in bulk_write_to_db
    orm_dags: list[DagModel] = session.scalars(query).unique().all()
                               ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1778, in scalars
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('dataset-scheduled', 'dataset_produces_2'), ('produces', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:32:18.381-0300] {processor.py:186} INFO - Started process (PID=65966) to work on /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T16:32:18.381-0300] {processor.py:914} INFO - Processing file /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py for tasks to queue
[2024-09-08T16:32:18.383-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:32:18.382-0300] {dagbag.py:587} INFO - Filling up the DagBag from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T16:32:18.394-0300] {processor.py:925} INFO - DAG(s) 'consume_1_or_both_2_and_3_with_dataset_expressions', 'dataset_consumes_1_and_2', 'consume_1_or_2_with_dataset_expressions', 'dataset_produces_2', 'dataset_consumes_1_never_scheduled', 'dataset_consumes_unknown_never_scheduled', 'consume_1_and_2_with_dataset_expressions', 'dataset_consumes_1', 'dataset_produces_1', 'conditional_dataset_and_time_based_timetable' retrieved from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T16:32:18.604-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:32:18.604-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T16:32:18.612-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:32:18.612-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_2_with_dataset_expressions
[2024-09-08T16:32:18.613-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:32:18.612-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_never_scheduled
[2024-09-08T16:32:18.613-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:32:18.613-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1
[2024-09-08T16:32:18.613-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:32:18.613-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_both_2_and_3_with_dataset_expressions
[2024-09-08T16:32:18.614-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:32:18.614-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_and_2_with_dataset_expressions
[2024-09-08T16:32:18.614-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:32:18.614-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_and_2
[2024-09-08T16:32:18.615-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:32:18.614-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_2
[2024-09-08T16:32:18.615-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:32:18.615-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_1
[2024-09-08T16:32:18.615-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:32:18.615-0300] {dag.py:3252} INFO - Creating ORM DAG for conditional_dataset_and_time_based_timetable
[2024-09-08T16:32:18.616-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:32:18.616-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_unknown_never_scheduled
[2024-09-08T16:32:18.624-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:32:18.624-0300] {dag.py:4156} INFO - Setting next_dagrun for conditional_dataset_and_time_based_timetable to 2024-09-04 01:00:00+00:00, run_after=2024-09-04 01:00:00+00:00
[2024-09-08T16:32:18.624-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:32:18.624-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_and_2_with_dataset_expressions to None, run_after=None
[2024-09-08T16:32:18.625-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:32:18.625-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_2_with_dataset_expressions to None, run_after=None
[2024-09-08T16:32:18.625-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:32:18.625-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_both_2_and_3_with_dataset_expressions to None, run_after=None
[2024-09-08T16:32:18.625-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:32:18.625-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1 to None, run_after=None
[2024-09-08T16:32:18.626-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:32:18.625-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_and_2 to None, run_after=None
[2024-09-08T16:32:18.626-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:32:18.626-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_never_scheduled to None, run_after=None
[2024-09-08T16:32:18.626-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:32:18.626-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_unknown_never_scheduled to None, run_after=None
[2024-09-08T16:32:18.627-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:32:18.627-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_1 to 2024-09-07 00:00:00+00:00, run_after=2024-09-08 00:00:00+00:00
[2024-09-08T16:32:18.628-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:32:18.628-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_2 to None, run_after=None
[2024-09-08T16:32:18.749-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:32:18.748-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:32:18.750-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:32:18.750-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:32:18.752-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:32:18.751-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:32:18.753-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:32:18.753-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:32:18.754-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:32:18.754-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:32:18.755-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:32:18.755-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:32:18.756-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:32:18.756-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:32:18.757-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:32:18.757-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:32:18.758-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:32:18.758-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:32:18.759-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:32:18.759-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:32:18.760-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:32:18.759-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T16:32:18.760-0300] {processor.py:211} ERROR - Got an exception! Propagating...
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 207, in _run_file_processor
    _handle_dag_file_processing()
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 188, in _handle_dag_file_processing
    result: tuple[int, int, int] = dag_file_processor.process_file(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 942, in process_file
    serialize_errors = DagFileProcessor.save_dag_to_db(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/api_internal/internal_api_call.py", line 139, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 982, in save_dag_to_db
    import_errors = DagBag._sync_to_db(dags=dags, processor_subdir=dag_directory, session=session)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 707, in _sync_to_db
    for attempt in run_with_db_retries(logger=log):
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 443, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 723, in _sync_to_db
    DAG.bulk_write_to_db(dags.values(), processor_subdir=processor_subdir, session=session)
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dag.py", line 3242, in bulk_write_to_db
    orm_dags: list[DagModel] = session.scalars(query).unique().all()
                               ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1778, in scalars
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:34:11.944-0300] {processor.py:186} INFO - Started process (PID=67581) to work on /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T16:34:11.944-0300] {processor.py:914} INFO - Processing file /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py for tasks to queue
[2024-09-08T16:34:11.946-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:34:11.946-0300] {dagbag.py:587} INFO - Filling up the DagBag from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T16:34:11.957-0300] {processor.py:925} INFO - DAG(s) 'conditional_dataset_and_time_based_timetable', 'consume_1_or_2_with_dataset_expressions', 'dataset_consumes_unknown_never_scheduled', 'consume_1_and_2_with_dataset_expressions', 'consume_1_or_both_2_and_3_with_dataset_expressions', 'dataset_produces_1', 'dataset_consumes_1_never_scheduled', 'dataset_produces_2', 'dataset_consumes_1', 'dataset_consumes_1_and_2' retrieved from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T16:34:12.119-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:34:12.119-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T16:34:12.127-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:34:12.127-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_2_with_dataset_expressions
[2024-09-08T16:34:12.128-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:34:12.128-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_never_scheduled
[2024-09-08T16:34:12.129-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:34:12.128-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1
[2024-09-08T16:34:12.129-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:34:12.129-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_and_2_with_dataset_expressions
[2024-09-08T16:34:12.130-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:34:12.130-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_both_2_and_3_with_dataset_expressions
[2024-09-08T16:34:12.131-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:34:12.131-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_1
[2024-09-08T16:34:12.131-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:34:12.131-0300] {dag.py:3252} INFO - Creating ORM DAG for conditional_dataset_and_time_based_timetable
[2024-09-08T16:34:12.132-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:34:12.132-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_2
[2024-09-08T16:34:12.132-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:34:12.132-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_and_2
[2024-09-08T16:34:12.132-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:34:12.132-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_unknown_never_scheduled
[2024-09-08T16:34:12.139-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:34:12.139-0300] {dag.py:4156} INFO - Setting next_dagrun for conditional_dataset_and_time_based_timetable to 2024-09-04 01:00:00+00:00, run_after=2024-09-04 01:00:00+00:00
[2024-09-08T16:34:12.139-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:34:12.139-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_and_2_with_dataset_expressions to None, run_after=None
[2024-09-08T16:34:12.140-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:34:12.139-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_2_with_dataset_expressions to None, run_after=None
[2024-09-08T16:34:12.140-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:34:12.140-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_both_2_and_3_with_dataset_expressions to None, run_after=None
[2024-09-08T16:34:12.140-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:34:12.140-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1 to None, run_after=None
[2024-09-08T16:34:12.140-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:34:12.140-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_and_2 to None, run_after=None
[2024-09-08T16:34:12.141-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:34:12.141-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_never_scheduled to None, run_after=None
[2024-09-08T16:34:12.141-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:34:12.141-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_unknown_never_scheduled to None, run_after=None
[2024-09-08T16:34:12.142-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:34:12.142-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_1 to 2024-09-07 00:00:00+00:00, run_after=2024-09-08 00:00:00+00:00
[2024-09-08T16:34:12.143-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:34:12.143-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_2 to None, run_after=None
[2024-09-08T16:34:12.201-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:34:12.200-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:34:12.202-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:34:12.202-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:34:12.203-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:34:12.203-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:34:12.204-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:34:12.204-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:34:12.205-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:34:12.205-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:34:12.206-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:34:12.206-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:34:12.207-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:34:12.207-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:34:12.208-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:34:12.208-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:34:12.209-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:34:12.208-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:34:12.210-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:34:12.209-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:34:12.210-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:34:12.210-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T16:34:12.211-0300] {processor.py:211} ERROR - Got an exception! Propagating...
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 207, in _run_file_processor
    _handle_dag_file_processing()
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 188, in _handle_dag_file_processing
    result: tuple[int, int, int] = dag_file_processor.process_file(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 942, in process_file
    serialize_errors = DagFileProcessor.save_dag_to_db(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/api_internal/internal_api_call.py", line 139, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 982, in save_dag_to_db
    import_errors = DagBag._sync_to_db(dags=dags, processor_subdir=dag_directory, session=session)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 707, in _sync_to_db
    for attempt in run_with_db_retries(logger=log):
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 443, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 723, in _sync_to_db
    DAG.bulk_write_to_db(dags.values(), processor_subdir=processor_subdir, session=session)
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dag.py", line 3242, in bulk_write_to_db
    orm_dags: list[DagModel] = session.scalars(query).unique().all()
                               ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1778, in scalars
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:37:51.355-0300] {processor.py:186} INFO - Started process (PID=70619) to work on /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T16:37:51.459-0300] {processor.py:914} INFO - Processing file /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py for tasks to queue
[2024-09-08T16:37:51.461-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:37:51.461-0300] {dagbag.py:587} INFO - Filling up the DagBag from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T16:37:51.471-0300] {processor.py:925} INFO - DAG(s) 'dataset_consumes_unknown_never_scheduled', 'consume_1_or_both_2_and_3_with_dataset_expressions', 'dataset_produces_2', 'dataset_produces_1', 'dataset_consumes_1_never_scheduled', 'consume_1_or_2_with_dataset_expressions', 'dataset_consumes_1', 'consume_1_and_2_with_dataset_expressions', 'conditional_dataset_and_time_based_timetable', 'dataset_consumes_1_and_2' retrieved from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T16:37:51.613-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:37:51.612-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T16:37:51.619-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:37:51.619-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_2_with_dataset_expressions
[2024-09-08T16:37:51.620-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:37:51.620-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_never_scheduled
[2024-09-08T16:37:51.620-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:37:51.620-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1
[2024-09-08T16:37:51.620-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:37:51.620-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_both_2_and_3_with_dataset_expressions
[2024-09-08T16:37:51.621-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:37:51.621-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_and_2_with_dataset_expressions
[2024-09-08T16:37:51.621-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:37:51.621-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_2
[2024-09-08T16:37:51.621-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:37:51.621-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_1
[2024-09-08T16:37:51.622-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:37:51.622-0300] {dag.py:3252} INFO - Creating ORM DAG for conditional_dataset_and_time_based_timetable
[2024-09-08T16:37:51.622-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:37:51.622-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_and_2
[2024-09-08T16:37:51.622-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:37:51.622-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_unknown_never_scheduled
[2024-09-08T16:37:51.629-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:37:51.629-0300] {dag.py:4156} INFO - Setting next_dagrun for conditional_dataset_and_time_based_timetable to 2024-09-04 01:00:00+00:00, run_after=2024-09-04 01:00:00+00:00
[2024-09-08T16:37:51.630-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:37:51.630-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_and_2_with_dataset_expressions to None, run_after=None
[2024-09-08T16:37:51.630-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:37:51.630-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_2_with_dataset_expressions to None, run_after=None
[2024-09-08T16:37:51.630-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:37:51.630-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_both_2_and_3_with_dataset_expressions to None, run_after=None
[2024-09-08T16:37:51.631-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:37:51.630-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1 to None, run_after=None
[2024-09-08T16:37:51.631-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:37:51.631-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_and_2 to None, run_after=None
[2024-09-08T16:37:51.631-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:37:51.631-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_never_scheduled to None, run_after=None
[2024-09-08T16:37:51.632-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:37:51.631-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_unknown_never_scheduled to None, run_after=None
[2024-09-08T16:37:51.633-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:37:51.633-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_1 to 2024-09-07 00:00:00+00:00, run_after=2024-09-08 00:00:00+00:00
[2024-09-08T16:37:51.633-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:37:51.633-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_2 to None, run_after=None
[2024-09-08T16:37:52.019-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:37:52.017-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:37:52.020-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:37:52.019-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:37:52.021-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:37:52.020-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:37:52.021-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:37:52.021-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:37:52.022-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:37:52.022-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:37:52.023-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:37:52.023-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:37:52.024-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:37:52.024-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:37:52.025-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:37:52.025-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:37:52.026-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:37:52.026-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:37:52.027-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:37:52.026-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:37:52.027-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:37:52.027-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T16:37:52.028-0300] {processor.py:211} ERROR - Got an exception! Propagating...
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 207, in _run_file_processor
    _handle_dag_file_processing()
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 188, in _handle_dag_file_processing
    result: tuple[int, int, int] = dag_file_processor.process_file(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 942, in process_file
    serialize_errors = DagFileProcessor.save_dag_to_db(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/api_internal/internal_api_call.py", line 139, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 982, in save_dag_to_db
    import_errors = DagBag._sync_to_db(dags=dags, processor_subdir=dag_directory, session=session)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 707, in _sync_to_db
    for attempt in run_with_db_retries(logger=log):
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 443, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 723, in _sync_to_db
    DAG.bulk_write_to_db(dags.values(), processor_subdir=processor_subdir, session=session)
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dag.py", line 3242, in bulk_write_to_db
    orm_dags: list[DagModel] = session.scalars(query).unique().all()
                               ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1778, in scalars
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:41:25.897-0300] {processor.py:186} INFO - Started process (PID=73574) to work on /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T16:41:25.898-0300] {processor.py:914} INFO - Processing file /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py for tasks to queue
[2024-09-08T16:41:25.899-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:41:25.899-0300] {dagbag.py:587} INFO - Filling up the DagBag from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T16:41:25.909-0300] {processor.py:925} INFO - DAG(s) 'consume_1_or_2_with_dataset_expressions', 'dataset_consumes_1_never_scheduled', 'conditional_dataset_and_time_based_timetable', 'dataset_consumes_1_and_2', 'dataset_consumes_1', 'dataset_produces_2', 'dataset_consumes_unknown_never_scheduled', 'consume_1_or_both_2_and_3_with_dataset_expressions', 'dataset_produces_1', 'consume_1_and_2_with_dataset_expressions' retrieved from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T16:41:26.052-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:41:26.051-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T16:41:26.058-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:41:26.058-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_2_with_dataset_expressions
[2024-09-08T16:41:26.059-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:41:26.059-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_never_scheduled
[2024-09-08T16:41:26.059-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:41:26.059-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1
[2024-09-08T16:41:26.059-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:41:26.059-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_both_2_and_3_with_dataset_expressions
[2024-09-08T16:41:26.060-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:41:26.060-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_and_2_with_dataset_expressions
[2024-09-08T16:41:26.060-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:41:26.060-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_and_2
[2024-09-08T16:41:26.060-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:41:26.060-0300] {dag.py:3252} INFO - Creating ORM DAG for conditional_dataset_and_time_based_timetable
[2024-09-08T16:41:26.061-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:41:26.061-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_2
[2024-09-08T16:41:26.061-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:41:26.061-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_1
[2024-09-08T16:41:26.061-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:41:26.061-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_unknown_never_scheduled
[2024-09-08T16:41:26.067-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:41:26.067-0300] {dag.py:4156} INFO - Setting next_dagrun for conditional_dataset_and_time_based_timetable to 2024-09-04 01:00:00+00:00, run_after=2024-09-04 01:00:00+00:00
[2024-09-08T16:41:26.068-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:41:26.068-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_and_2_with_dataset_expressions to None, run_after=None
[2024-09-08T16:41:26.068-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:41:26.068-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_2_with_dataset_expressions to None, run_after=None
[2024-09-08T16:41:26.068-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:41:26.068-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_both_2_and_3_with_dataset_expressions to None, run_after=None
[2024-09-08T16:41:26.069-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:41:26.068-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1 to None, run_after=None
[2024-09-08T16:41:26.069-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:41:26.069-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_and_2 to None, run_after=None
[2024-09-08T16:41:26.069-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:41:26.069-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_never_scheduled to None, run_after=None
[2024-09-08T16:41:26.070-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:41:26.069-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_unknown_never_scheduled to None, run_after=None
[2024-09-08T16:41:26.071-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:41:26.071-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_1 to 2024-09-07 00:00:00+00:00, run_after=2024-09-08 00:00:00+00:00
[2024-09-08T16:41:26.071-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:41:26.071-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_2 to None, run_after=None
[2024-09-08T16:41:26.460-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:41:26.458-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:41:26.461-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:41:26.460-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:41:26.461-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:41:26.461-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:41:26.462-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:41:26.462-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:41:26.463-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:41:26.463-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:41:26.464-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:41:26.464-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:41:26.465-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:41:26.465-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:41:26.466-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:41:26.465-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:41:26.467-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:41:26.466-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:41:26.468-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:41:26.467-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:41:26.468-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:41:26.468-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T16:41:26.469-0300] {processor.py:211} ERROR - Got an exception! Propagating...
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 207, in _run_file_processor
    _handle_dag_file_processing()
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 188, in _handle_dag_file_processing
    result: tuple[int, int, int] = dag_file_processor.process_file(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 942, in process_file
    serialize_errors = DagFileProcessor.save_dag_to_db(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/api_internal/internal_api_call.py", line 139, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 982, in save_dag_to_db
    import_errors = DagBag._sync_to_db(dags=dags, processor_subdir=dag_directory, session=session)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 707, in _sync_to_db
    for attempt in run_with_db_retries(logger=log):
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 443, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 723, in _sync_to_db
    DAG.bulk_write_to_db(dags.values(), processor_subdir=processor_subdir, session=session)
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dag.py", line 3242, in bulk_write_to_db
    orm_dags: list[DagModel] = session.scalars(query).unique().all()
                               ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1778, in scalars
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:44:56.958-0300] {processor.py:186} INFO - Started process (PID=76491) to work on /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T16:44:56.959-0300] {processor.py:914} INFO - Processing file /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py for tasks to queue
[2024-09-08T16:44:56.960-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:44:56.960-0300] {dagbag.py:587} INFO - Filling up the DagBag from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T16:44:56.970-0300] {processor.py:925} INFO - DAG(s) 'dataset_produces_2', 'dataset_consumes_1', 'consume_1_or_2_with_dataset_expressions', 'consume_1_and_2_with_dataset_expressions', 'consume_1_or_both_2_and_3_with_dataset_expressions', 'conditional_dataset_and_time_based_timetable', 'dataset_consumes_1_never_scheduled', 'dataset_produces_1', 'dataset_consumes_unknown_never_scheduled', 'dataset_consumes_1_and_2' retrieved from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T16:44:57.112-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:44:57.111-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T16:44:57.119-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:44:57.119-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_2_with_dataset_expressions
[2024-09-08T16:44:57.119-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:44:57.119-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_never_scheduled
[2024-09-08T16:44:57.120-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:44:57.120-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1
[2024-09-08T16:44:57.120-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:44:57.120-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_and_2_with_dataset_expressions
[2024-09-08T16:44:57.120-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:44:57.120-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_both_2_and_3_with_dataset_expressions
[2024-09-08T16:44:57.121-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:44:57.121-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_2
[2024-09-08T16:44:57.121-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:44:57.121-0300] {dag.py:3252} INFO - Creating ORM DAG for conditional_dataset_and_time_based_timetable
[2024-09-08T16:44:57.121-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:44:57.121-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_1
[2024-09-08T16:44:57.122-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:44:57.122-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_and_2
[2024-09-08T16:44:57.122-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:44:57.122-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_unknown_never_scheduled
[2024-09-08T16:44:57.128-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:44:57.128-0300] {dag.py:4156} INFO - Setting next_dagrun for conditional_dataset_and_time_based_timetable to 2024-09-04 01:00:00+00:00, run_after=2024-09-04 01:00:00+00:00
[2024-09-08T16:44:57.128-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:44:57.128-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_and_2_with_dataset_expressions to None, run_after=None
[2024-09-08T16:44:57.129-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:44:57.129-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_2_with_dataset_expressions to None, run_after=None
[2024-09-08T16:44:57.129-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:44:57.129-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_both_2_and_3_with_dataset_expressions to None, run_after=None
[2024-09-08T16:44:57.129-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:44:57.129-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1 to None, run_after=None
[2024-09-08T16:44:57.129-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:44:57.129-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_and_2 to None, run_after=None
[2024-09-08T16:44:57.130-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:44:57.130-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_never_scheduled to None, run_after=None
[2024-09-08T16:44:57.130-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:44:57.130-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_unknown_never_scheduled to None, run_after=None
[2024-09-08T16:44:57.131-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:44:57.131-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_1 to 2024-09-07 00:00:00+00:00, run_after=2024-09-08 00:00:00+00:00
[2024-09-08T16:44:57.132-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:44:57.132-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_2 to None, run_after=None
[2024-09-08T16:44:57.289-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:44:57.288-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:44:57.290-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:44:57.290-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:44:57.291-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:44:57.291-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:44:57.292-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:44:57.291-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:44:57.293-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:44:57.292-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:44:57.294-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:44:57.293-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:44:57.294-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:44:57.294-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:44:57.295-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:44:57.295-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:44:57.296-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:44:57.296-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:44:57.297-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:44:57.297-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:44:57.297-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:44:57.297-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T16:44:57.298-0300] {processor.py:211} ERROR - Got an exception! Propagating...
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 207, in _run_file_processor
    _handle_dag_file_processing()
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 188, in _handle_dag_file_processing
    result: tuple[int, int, int] = dag_file_processor.process_file(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 942, in process_file
    serialize_errors = DagFileProcessor.save_dag_to_db(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/api_internal/internal_api_call.py", line 139, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 982, in save_dag_to_db
    import_errors = DagBag._sync_to_db(dags=dags, processor_subdir=dag_directory, session=session)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 707, in _sync_to_db
    for attempt in run_with_db_retries(logger=log):
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 443, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 723, in _sync_to_db
    DAG.bulk_write_to_db(dags.values(), processor_subdir=processor_subdir, session=session)
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dag.py", line 3242, in bulk_write_to_db
    orm_dags: list[DagModel] = session.scalars(query).unique().all()
                               ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1778, in scalars
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:48:30.858-0300] {processor.py:186} INFO - Started process (PID=79433) to work on /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T16:48:30.859-0300] {processor.py:914} INFO - Processing file /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py for tasks to queue
[2024-09-08T16:48:30.860-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:48:30.860-0300] {dagbag.py:587} INFO - Filling up the DagBag from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T16:48:30.870-0300] {processor.py:925} INFO - DAG(s) 'consume_1_or_both_2_and_3_with_dataset_expressions', 'conditional_dataset_and_time_based_timetable', 'dataset_produces_2', 'dataset_consumes_1_never_scheduled', 'consume_1_and_2_with_dataset_expressions', 'consume_1_or_2_with_dataset_expressions', 'dataset_consumes_1', 'dataset_consumes_1_and_2', 'dataset_produces_1', 'dataset_consumes_unknown_never_scheduled' retrieved from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T16:48:31.016-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:48:31.016-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T16:48:31.023-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:48:31.023-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_2_with_dataset_expressions
[2024-09-08T16:48:31.024-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:48:31.024-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_never_scheduled
[2024-09-08T16:48:31.024-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:48:31.024-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1
[2024-09-08T16:48:31.024-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:48:31.024-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_both_2_and_3_with_dataset_expressions
[2024-09-08T16:48:31.025-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:48:31.025-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_and_2_with_dataset_expressions
[2024-09-08T16:48:31.025-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:48:31.025-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_2
[2024-09-08T16:48:31.025-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:48:31.025-0300] {dag.py:3252} INFO - Creating ORM DAG for conditional_dataset_and_time_based_timetable
[2024-09-08T16:48:31.026-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:48:31.026-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_and_2
[2024-09-08T16:48:31.026-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:48:31.026-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_1
[2024-09-08T16:48:31.026-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:48:31.026-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_unknown_never_scheduled
[2024-09-08T16:48:31.033-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:48:31.032-0300] {dag.py:4156} INFO - Setting next_dagrun for conditional_dataset_and_time_based_timetable to 2024-09-04 01:00:00+00:00, run_after=2024-09-04 01:00:00+00:00
[2024-09-08T16:48:31.033-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:48:31.033-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_and_2_with_dataset_expressions to None, run_after=None
[2024-09-08T16:48:31.033-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:48:31.033-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_2_with_dataset_expressions to None, run_after=None
[2024-09-08T16:48:31.033-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:48:31.033-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_both_2_and_3_with_dataset_expressions to None, run_after=None
[2024-09-08T16:48:31.034-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:48:31.034-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1 to None, run_after=None
[2024-09-08T16:48:31.034-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:48:31.034-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_and_2 to None, run_after=None
[2024-09-08T16:48:31.034-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:48:31.034-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_never_scheduled to None, run_after=None
[2024-09-08T16:48:31.035-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:48:31.035-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_unknown_never_scheduled to None, run_after=None
[2024-09-08T16:48:31.036-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:48:31.036-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_1 to 2024-09-07 00:00:00+00:00, run_after=2024-09-08 00:00:00+00:00
[2024-09-08T16:48:31.036-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:48:31.036-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_2 to None, run_after=None
[2024-09-08T16:48:31.450-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:48:31.448-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:48:31.451-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:48:31.450-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:48:31.452-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:48:31.451-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:48:31.452-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:48:31.452-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:48:31.453-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:48:31.453-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:48:31.454-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:48:31.454-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:48:31.455-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:48:31.455-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:48:31.456-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:48:31.456-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:48:31.457-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:48:31.456-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:48:31.458-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:48:31.457-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:48:31.458-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:48:31.458-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T16:48:31.459-0300] {processor.py:211} ERROR - Got an exception! Propagating...
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 207, in _run_file_processor
    _handle_dag_file_processing()
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 188, in _handle_dag_file_processing
    result: tuple[int, int, int] = dag_file_processor.process_file(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 942, in process_file
    serialize_errors = DagFileProcessor.save_dag_to_db(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/api_internal/internal_api_call.py", line 139, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 982, in save_dag_to_db
    import_errors = DagBag._sync_to_db(dags=dags, processor_subdir=dag_directory, session=session)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 707, in _sync_to_db
    for attempt in run_with_db_retries(logger=log):
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 443, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 723, in _sync_to_db
    DAG.bulk_write_to_db(dags.values(), processor_subdir=processor_subdir, session=session)
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dag.py", line 3242, in bulk_write_to_db
    orm_dags: list[DagModel] = session.scalars(query).unique().all()
                               ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1778, in scalars
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:52:01.661-0300] {processor.py:186} INFO - Started process (PID=82370) to work on /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T16:52:01.661-0300] {processor.py:914} INFO - Processing file /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py for tasks to queue
[2024-09-08T16:52:01.663-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:52:01.663-0300] {dagbag.py:587} INFO - Filling up the DagBag from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T16:52:01.672-0300] {processor.py:925} INFO - DAG(s) 'dataset_produces_1', 'dataset_consumes_unknown_never_scheduled', 'consume_1_and_2_with_dataset_expressions', 'dataset_produces_2', 'dataset_consumes_1_and_2', 'dataset_consumes_1_never_scheduled', 'consume_1_or_both_2_and_3_with_dataset_expressions', 'consume_1_or_2_with_dataset_expressions', 'dataset_consumes_1', 'conditional_dataset_and_time_based_timetable' retrieved from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T16:52:01.817-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:52:01.817-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T16:52:01.824-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:52:01.824-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_2_with_dataset_expressions
[2024-09-08T16:52:01.825-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:52:01.825-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_never_scheduled
[2024-09-08T16:52:01.825-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:52:01.825-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1
[2024-09-08T16:52:01.825-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:52:01.825-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_and_2_with_dataset_expressions
[2024-09-08T16:52:01.826-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:52:01.826-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_both_2_and_3_with_dataset_expressions
[2024-09-08T16:52:01.826-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:52:01.826-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_1
[2024-09-08T16:52:01.826-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:52:01.826-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_2
[2024-09-08T16:52:01.827-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:52:01.827-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_and_2
[2024-09-08T16:52:01.827-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:52:01.827-0300] {dag.py:3252} INFO - Creating ORM DAG for conditional_dataset_and_time_based_timetable
[2024-09-08T16:52:01.827-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:52:01.827-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_unknown_never_scheduled
[2024-09-08T16:52:01.833-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:52:01.833-0300] {dag.py:4156} INFO - Setting next_dagrun for conditional_dataset_and_time_based_timetable to 2024-09-04 01:00:00+00:00, run_after=2024-09-04 01:00:00+00:00
[2024-09-08T16:52:01.834-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:52:01.834-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_and_2_with_dataset_expressions to None, run_after=None
[2024-09-08T16:52:01.834-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:52:01.834-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_2_with_dataset_expressions to None, run_after=None
[2024-09-08T16:52:01.834-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:52:01.834-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_both_2_and_3_with_dataset_expressions to None, run_after=None
[2024-09-08T16:52:01.835-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:52:01.834-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1 to None, run_after=None
[2024-09-08T16:52:01.835-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:52:01.835-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_and_2 to None, run_after=None
[2024-09-08T16:52:01.835-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:52:01.835-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_never_scheduled to None, run_after=None
[2024-09-08T16:52:01.835-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:52:01.835-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_unknown_never_scheduled to None, run_after=None
[2024-09-08T16:52:01.837-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:52:01.836-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_1 to 2024-09-07 00:00:00+00:00, run_after=2024-09-08 00:00:00+00:00
[2024-09-08T16:52:01.837-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:52:01.837-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_2 to None, run_after=None
[2024-09-08T16:52:02.053-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:52:02.052-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:52:02.054-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:52:02.054-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:52:02.055-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:52:02.055-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:52:02.056-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:52:02.056-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:52:02.057-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:52:02.056-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:52:02.058-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:52:02.057-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:52:02.059-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:52:02.058-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:52:02.060-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:52:02.059-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:52:02.060-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:52:02.060-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:52:02.061-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:52:02.061-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:52:02.062-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:52:02.062-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T16:52:02.063-0300] {processor.py:211} ERROR - Got an exception! Propagating...
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 207, in _run_file_processor
    _handle_dag_file_processing()
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 188, in _handle_dag_file_processing
    result: tuple[int, int, int] = dag_file_processor.process_file(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 942, in process_file
    serialize_errors = DagFileProcessor.save_dag_to_db(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/api_internal/internal_api_call.py", line 139, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 982, in save_dag_to_db
    import_errors = DagBag._sync_to_db(dags=dags, processor_subdir=dag_directory, session=session)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 707, in _sync_to_db
    for attempt in run_with_db_retries(logger=log):
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 443, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 723, in _sync_to_db
    DAG.bulk_write_to_db(dags.values(), processor_subdir=processor_subdir, session=session)
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dag.py", line 3242, in bulk_write_to_db
    orm_dags: list[DagModel] = session.scalars(query).unique().all()
                               ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1778, in scalars
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:55:35.967-0300] {processor.py:186} INFO - Started process (PID=85453) to work on /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T16:55:35.968-0300] {processor.py:914} INFO - Processing file /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py for tasks to queue
[2024-09-08T16:55:35.970-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:55:35.969-0300] {dagbag.py:587} INFO - Filling up the DagBag from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T16:55:35.979-0300] {processor.py:925} INFO - DAG(s) 'dataset_consumes_1_and_2', 'consume_1_or_2_with_dataset_expressions', 'dataset_consumes_unknown_never_scheduled', 'dataset_produces_2', 'dataset_consumes_1_never_scheduled', 'conditional_dataset_and_time_based_timetable', 'consume_1_and_2_with_dataset_expressions', 'dataset_consumes_1', 'dataset_produces_1', 'consume_1_or_both_2_and_3_with_dataset_expressions' retrieved from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T16:55:36.124-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:55:36.124-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T16:55:36.131-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:55:36.131-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_2_with_dataset_expressions
[2024-09-08T16:55:36.132-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:55:36.132-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_never_scheduled
[2024-09-08T16:55:36.132-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:55:36.132-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1
[2024-09-08T16:55:36.132-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:55:36.132-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_and_2_with_dataset_expressions
[2024-09-08T16:55:36.133-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:55:36.133-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_both_2_and_3_with_dataset_expressions
[2024-09-08T16:55:36.133-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:55:36.133-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_and_2
[2024-09-08T16:55:36.133-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:55:36.133-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_2
[2024-09-08T16:55:36.134-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:55:36.134-0300] {dag.py:3252} INFO - Creating ORM DAG for conditional_dataset_and_time_based_timetable
[2024-09-08T16:55:36.134-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:55:36.134-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_1
[2024-09-08T16:55:36.134-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:55:36.134-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_unknown_never_scheduled
[2024-09-08T16:55:36.141-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:55:36.141-0300] {dag.py:4156} INFO - Setting next_dagrun for conditional_dataset_and_time_based_timetable to 2024-09-04 01:00:00+00:00, run_after=2024-09-04 01:00:00+00:00
[2024-09-08T16:55:36.141-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:55:36.141-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_and_2_with_dataset_expressions to None, run_after=None
[2024-09-08T16:55:36.141-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:55:36.141-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_2_with_dataset_expressions to None, run_after=None
[2024-09-08T16:55:36.142-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:55:36.141-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_both_2_and_3_with_dataset_expressions to None, run_after=None
[2024-09-08T16:55:36.142-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:55:36.142-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1 to None, run_after=None
[2024-09-08T16:55:36.142-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:55:36.142-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_and_2 to None, run_after=None
[2024-09-08T16:55:36.142-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:55:36.142-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_never_scheduled to None, run_after=None
[2024-09-08T16:55:36.143-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:55:36.143-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_unknown_never_scheduled to None, run_after=None
[2024-09-08T16:55:36.144-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:55:36.144-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_1 to 2024-09-07 00:00:00+00:00, run_after=2024-09-08 00:00:00+00:00
[2024-09-08T16:55:36.144-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:55:36.144-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_2 to None, run_after=None
[2024-09-08T16:55:36.618-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:55:36.617-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:55:36.619-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:55:36.619-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:55:36.620-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:55:36.620-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:55:36.621-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:55:36.620-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:55:36.622-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:55:36.621-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:55:36.623-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:55:36.622-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:55:36.623-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:55:36.623-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:55:36.624-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:55:36.624-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:55:36.625-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:55:36.625-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:55:36.626-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:55:36.626-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:55:36.627-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:55:36.626-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T16:55:36.627-0300] {processor.py:211} ERROR - Got an exception! Propagating...
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 207, in _run_file_processor
    _handle_dag_file_processing()
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 188, in _handle_dag_file_processing
    result: tuple[int, int, int] = dag_file_processor.process_file(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 942, in process_file
    serialize_errors = DagFileProcessor.save_dag_to_db(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/api_internal/internal_api_call.py", line 139, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 982, in save_dag_to_db
    import_errors = DagBag._sync_to_db(dags=dags, processor_subdir=dag_directory, session=session)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 707, in _sync_to_db
    for attempt in run_with_db_retries(logger=log):
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 443, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 723, in _sync_to_db
    DAG.bulk_write_to_db(dags.values(), processor_subdir=processor_subdir, session=session)
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dag.py", line 3242, in bulk_write_to_db
    orm_dags: list[DagModel] = session.scalars(query).unique().all()
                               ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1778, in scalars
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:59:04.042-0300] {processor.py:186} INFO - Started process (PID=88190) to work on /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T16:59:04.043-0300] {processor.py:914} INFO - Processing file /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py for tasks to queue
[2024-09-08T16:59:04.044-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:59:04.044-0300] {dagbag.py:587} INFO - Filling up the DagBag from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T16:59:04.054-0300] {processor.py:925} INFO - DAG(s) 'dataset_produces_1', 'dataset_consumes_1_never_scheduled', 'dataset_consumes_1', 'consume_1_and_2_with_dataset_expressions', 'dataset_consumes_1_and_2', 'consume_1_or_both_2_and_3_with_dataset_expressions', 'conditional_dataset_and_time_based_timetable', 'consume_1_or_2_with_dataset_expressions', 'dataset_produces_2', 'dataset_consumes_unknown_never_scheduled' retrieved from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T16:59:04.198-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:59:04.197-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T16:59:04.205-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:59:04.204-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_2_with_dataset_expressions
[2024-09-08T16:59:04.205-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:59:04.205-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_never_scheduled
[2024-09-08T16:59:04.205-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:59:04.205-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1
[2024-09-08T16:59:04.206-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:59:04.206-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_and_2_with_dataset_expressions
[2024-09-08T16:59:04.206-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:59:04.206-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_both_2_and_3_with_dataset_expressions
[2024-09-08T16:59:04.207-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:59:04.206-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_1
[2024-09-08T16:59:04.207-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:59:04.207-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_and_2
[2024-09-08T16:59:04.207-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:59:04.207-0300] {dag.py:3252} INFO - Creating ORM DAG for conditional_dataset_and_time_based_timetable
[2024-09-08T16:59:04.208-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:59:04.207-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_2
[2024-09-08T16:59:04.208-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:59:04.208-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_unknown_never_scheduled
[2024-09-08T16:59:04.214-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:59:04.214-0300] {dag.py:4156} INFO - Setting next_dagrun for conditional_dataset_and_time_based_timetable to 2024-09-04 01:00:00+00:00, run_after=2024-09-04 01:00:00+00:00
[2024-09-08T16:59:04.214-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:59:04.214-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_and_2_with_dataset_expressions to None, run_after=None
[2024-09-08T16:59:04.214-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:59:04.214-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_2_with_dataset_expressions to None, run_after=None
[2024-09-08T16:59:04.215-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:59:04.215-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_both_2_and_3_with_dataset_expressions to None, run_after=None
[2024-09-08T16:59:04.215-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:59:04.215-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1 to None, run_after=None
[2024-09-08T16:59:04.215-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:59:04.215-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_and_2 to None, run_after=None
[2024-09-08T16:59:04.216-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:59:04.216-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_never_scheduled to None, run_after=None
[2024-09-08T16:59:04.216-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:59:04.216-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_unknown_never_scheduled to None, run_after=None
[2024-09-08T16:59:04.217-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:59:04.217-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_1 to 2024-09-07 00:00:00+00:00, run_after=2024-09-08 00:00:00+00:00
[2024-09-08T16:59:04.217-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:59:04.217-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_2 to None, run_after=None
[2024-09-08T16:59:04.267-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:59:04.266-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:59:04.268-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:59:04.268-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:59:04.269-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:59:04.269-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:59:04.270-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:59:04.270-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:59:04.271-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:59:04.270-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:59:04.272-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:59:04.271-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:59:04.273-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:59:04.272-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:59:04.274-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:59:04.273-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:59:04.274-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:59:04.274-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:59:04.275-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:59:04.275-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T16:59:04.276-0300] {logging_mixin.py:190} INFO - [2024-09-08T16:59:04.276-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T16:59:04.276-0300] {processor.py:211} ERROR - Got an exception! Propagating...
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 207, in _run_file_processor
    _handle_dag_file_processing()
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 188, in _handle_dag_file_processing
    result: tuple[int, int, int] = dag_file_processor.process_file(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 942, in process_file
    serialize_errors = DagFileProcessor.save_dag_to_db(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/api_internal/internal_api_call.py", line 139, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 982, in save_dag_to_db
    import_errors = DagBag._sync_to_db(dags=dags, processor_subdir=dag_directory, session=session)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 707, in _sync_to_db
    for attempt in run_with_db_retries(logger=log):
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 443, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 723, in _sync_to_db
    DAG.bulk_write_to_db(dags.values(), processor_subdir=processor_subdir, session=session)
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dag.py", line 3242, in bulk_write_to_db
    orm_dags: list[DagModel] = session.scalars(query).unique().all()
                               ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1778, in scalars
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:02:28.962-0300] {processor.py:186} INFO - Started process (PID=90879) to work on /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T17:02:28.963-0300] {processor.py:914} INFO - Processing file /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py for tasks to queue
[2024-09-08T17:02:28.964-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:02:28.964-0300] {dagbag.py:587} INFO - Filling up the DagBag from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T17:02:28.974-0300] {processor.py:925} INFO - DAG(s) 'dataset_produces_2', 'consume_1_and_2_with_dataset_expressions', 'dataset_consumes_unknown_never_scheduled', 'dataset_consumes_1', 'consume_1_or_both_2_and_3_with_dataset_expressions', 'dataset_consumes_1_never_scheduled', 'consume_1_or_2_with_dataset_expressions', 'conditional_dataset_and_time_based_timetable', 'dataset_produces_1', 'dataset_consumes_1_and_2' retrieved from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T17:02:29.117-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:02:29.116-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T17:02:29.124-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:02:29.123-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_2_with_dataset_expressions
[2024-09-08T17:02:29.124-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:02:29.124-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_never_scheduled
[2024-09-08T17:02:29.124-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:02:29.124-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1
[2024-09-08T17:02:29.125-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:02:29.125-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_and_2_with_dataset_expressions
[2024-09-08T17:02:29.125-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:02:29.125-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_both_2_and_3_with_dataset_expressions
[2024-09-08T17:02:29.125-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:02:29.125-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_2
[2024-09-08T17:02:29.126-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:02:29.126-0300] {dag.py:3252} INFO - Creating ORM DAG for conditional_dataset_and_time_based_timetable
[2024-09-08T17:02:29.126-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:02:29.126-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_1
[2024-09-08T17:02:29.126-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:02:29.126-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_and_2
[2024-09-08T17:02:29.127-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:02:29.127-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_unknown_never_scheduled
[2024-09-08T17:02:29.134-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:02:29.134-0300] {dag.py:4156} INFO - Setting next_dagrun for conditional_dataset_and_time_based_timetable to 2024-09-04 01:00:00+00:00, run_after=2024-09-04 01:00:00+00:00
[2024-09-08T17:02:29.134-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:02:29.134-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_and_2_with_dataset_expressions to None, run_after=None
[2024-09-08T17:02:29.134-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:02:29.134-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_2_with_dataset_expressions to None, run_after=None
[2024-09-08T17:02:29.135-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:02:29.135-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_both_2_and_3_with_dataset_expressions to None, run_after=None
[2024-09-08T17:02:29.135-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:02:29.135-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1 to None, run_after=None
[2024-09-08T17:02:29.135-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:02:29.135-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_and_2 to None, run_after=None
[2024-09-08T17:02:29.135-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:02:29.135-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_never_scheduled to None, run_after=None
[2024-09-08T17:02:29.136-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:02:29.136-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_unknown_never_scheduled to None, run_after=None
[2024-09-08T17:02:29.137-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:02:29.137-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_1 to 2024-09-07 00:00:00+00:00, run_after=2024-09-08 00:00:00+00:00
[2024-09-08T17:02:29.137-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:02:29.137-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_2 to None, run_after=None
[2024-09-08T17:02:29.483-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:02:29.482-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:02:29.484-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:02:29.484-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:02:29.485-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:02:29.485-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:02:29.486-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:02:29.486-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:02:29.487-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:02:29.487-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:02:29.488-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:02:29.488-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:02:29.489-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:02:29.489-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:02:29.490-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:02:29.489-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:02:29.491-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:02:29.490-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:02:29.492-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:02:29.491-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:02:29.492-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:02:29.492-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T17:02:29.493-0300] {processor.py:211} ERROR - Got an exception! Propagating...
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 207, in _run_file_processor
    _handle_dag_file_processing()
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 188, in _handle_dag_file_processing
    result: tuple[int, int, int] = dag_file_processor.process_file(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 942, in process_file
    serialize_errors = DagFileProcessor.save_dag_to_db(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/api_internal/internal_api_call.py", line 139, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 982, in save_dag_to_db
    import_errors = DagBag._sync_to_db(dags=dags, processor_subdir=dag_directory, session=session)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 707, in _sync_to_db
    for attempt in run_with_db_retries(logger=log):
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 443, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 723, in _sync_to_db
    DAG.bulk_write_to_db(dags.values(), processor_subdir=processor_subdir, session=session)
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dag.py", line 3242, in bulk_write_to_db
    orm_dags: list[DagModel] = session.scalars(query).unique().all()
                               ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1778, in scalars
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:06:00.062-0300] {processor.py:186} INFO - Started process (PID=93662) to work on /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T17:06:00.063-0300] {processor.py:914} INFO - Processing file /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py for tasks to queue
[2024-09-08T17:06:00.065-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:06:00.064-0300] {dagbag.py:587} INFO - Filling up the DagBag from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T17:06:00.075-0300] {processor.py:925} INFO - DAG(s) 'dataset_consumes_1_and_2', 'conditional_dataset_and_time_based_timetable', 'consume_1_or_both_2_and_3_with_dataset_expressions', 'dataset_consumes_1', 'consume_1_or_2_with_dataset_expressions', 'consume_1_and_2_with_dataset_expressions', 'dataset_consumes_1_never_scheduled', 'dataset_produces_2', 'dataset_consumes_unknown_never_scheduled', 'dataset_produces_1' retrieved from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T17:06:00.219-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:06:00.219-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T17:06:00.227-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:06:00.227-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_2_with_dataset_expressions
[2024-09-08T17:06:00.227-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:06:00.227-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_never_scheduled
[2024-09-08T17:06:00.228-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:06:00.228-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1
[2024-09-08T17:06:00.228-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:06:00.228-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_both_2_and_3_with_dataset_expressions
[2024-09-08T17:06:00.228-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:06:00.228-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_and_2_with_dataset_expressions
[2024-09-08T17:06:00.229-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:06:00.229-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_and_2
[2024-09-08T17:06:00.229-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:06:00.229-0300] {dag.py:3252} INFO - Creating ORM DAG for conditional_dataset_and_time_based_timetable
[2024-09-08T17:06:00.229-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:06:00.229-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_2
[2024-09-08T17:06:00.230-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:06:00.230-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_1
[2024-09-08T17:06:00.230-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:06:00.230-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_unknown_never_scheduled
[2024-09-08T17:06:00.237-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:06:00.236-0300] {dag.py:4156} INFO - Setting next_dagrun for conditional_dataset_and_time_based_timetable to 2024-09-04 01:00:00+00:00, run_after=2024-09-04 01:00:00+00:00
[2024-09-08T17:06:00.237-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:06:00.237-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_and_2_with_dataset_expressions to None, run_after=None
[2024-09-08T17:06:00.237-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:06:00.237-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_2_with_dataset_expressions to None, run_after=None
[2024-09-08T17:06:00.238-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:06:00.237-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_both_2_and_3_with_dataset_expressions to None, run_after=None
[2024-09-08T17:06:00.238-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:06:00.238-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1 to None, run_after=None
[2024-09-08T17:06:00.238-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:06:00.238-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_and_2 to None, run_after=None
[2024-09-08T17:06:00.238-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:06:00.238-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_never_scheduled to None, run_after=None
[2024-09-08T17:06:00.239-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:06:00.239-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_unknown_never_scheduled to None, run_after=None
[2024-09-08T17:06:00.240-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:06:00.240-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_1 to 2024-09-07 00:00:00+00:00, run_after=2024-09-08 00:00:00+00:00
[2024-09-08T17:06:00.240-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:06:00.240-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_2 to None, run_after=None
[2024-09-08T17:06:00.404-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:06:00.402-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:06:00.405-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:06:00.404-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:06:00.406-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:06:00.405-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:06:00.407-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:06:00.406-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:06:00.408-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:06:00.407-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:06:00.408-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:06:00.408-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:06:00.409-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:06:00.409-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:06:00.410-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:06:00.410-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:06:00.411-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:06:00.411-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:06:00.412-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:06:00.411-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:06:00.412-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:06:00.412-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T17:06:00.413-0300] {processor.py:211} ERROR - Got an exception! Propagating...
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 207, in _run_file_processor
    _handle_dag_file_processing()
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 188, in _handle_dag_file_processing
    result: tuple[int, int, int] = dag_file_processor.process_file(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 942, in process_file
    serialize_errors = DagFileProcessor.save_dag_to_db(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/api_internal/internal_api_call.py", line 139, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 982, in save_dag_to_db
    import_errors = DagBag._sync_to_db(dags=dags, processor_subdir=dag_directory, session=session)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 707, in _sync_to_db
    for attempt in run_with_db_retries(logger=log):
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 443, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 723, in _sync_to_db
    DAG.bulk_write_to_db(dags.values(), processor_subdir=processor_subdir, session=session)
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dag.py", line 3242, in bulk_write_to_db
    orm_dags: list[DagModel] = session.scalars(query).unique().all()
                               ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1778, in scalars
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:09:26.136-0300] {processor.py:186} INFO - Started process (PID=96345) to work on /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T17:09:26.137-0300] {processor.py:914} INFO - Processing file /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py for tasks to queue
[2024-09-08T17:09:26.138-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:09:26.138-0300] {dagbag.py:587} INFO - Filling up the DagBag from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T17:09:26.148-0300] {processor.py:925} INFO - DAG(s) 'consume_1_and_2_with_dataset_expressions', 'dataset_consumes_unknown_never_scheduled', 'dataset_produces_1', 'dataset_produces_2', 'dataset_consumes_1_never_scheduled', 'consume_1_or_2_with_dataset_expressions', 'consume_1_or_both_2_and_3_with_dataset_expressions', 'conditional_dataset_and_time_based_timetable', 'dataset_consumes_1', 'dataset_consumes_1_and_2' retrieved from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T17:09:26.290-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:09:26.290-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T17:09:26.297-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:09:26.297-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_2_with_dataset_expressions
[2024-09-08T17:09:26.297-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:09:26.297-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_never_scheduled
[2024-09-08T17:09:26.298-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:09:26.298-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1
[2024-09-08T17:09:26.298-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:09:26.298-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_and_2_with_dataset_expressions
[2024-09-08T17:09:26.298-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:09:26.298-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_both_2_and_3_with_dataset_expressions
[2024-09-08T17:09:26.299-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:09:26.299-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_1
[2024-09-08T17:09:26.299-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:09:26.299-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_2
[2024-09-08T17:09:26.299-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:09:26.299-0300] {dag.py:3252} INFO - Creating ORM DAG for conditional_dataset_and_time_based_timetable
[2024-09-08T17:09:26.300-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:09:26.300-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_and_2
[2024-09-08T17:09:26.300-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:09:26.300-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_unknown_never_scheduled
[2024-09-08T17:09:26.306-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:09:26.306-0300] {dag.py:4156} INFO - Setting next_dagrun for conditional_dataset_and_time_based_timetable to 2024-09-04 01:00:00+00:00, run_after=2024-09-04 01:00:00+00:00
[2024-09-08T17:09:26.307-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:09:26.306-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_and_2_with_dataset_expressions to None, run_after=None
[2024-09-08T17:09:26.307-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:09:26.307-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_2_with_dataset_expressions to None, run_after=None
[2024-09-08T17:09:26.307-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:09:26.307-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_both_2_and_3_with_dataset_expressions to None, run_after=None
[2024-09-08T17:09:26.307-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:09:26.307-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1 to None, run_after=None
[2024-09-08T17:09:26.308-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:09:26.308-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_and_2 to None, run_after=None
[2024-09-08T17:09:26.308-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:09:26.308-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_never_scheduled to None, run_after=None
[2024-09-08T17:09:26.308-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:09:26.308-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_unknown_never_scheduled to None, run_after=None
[2024-09-08T17:09:26.310-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:09:26.309-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_1 to 2024-09-07 00:00:00+00:00, run_after=2024-09-08 00:00:00+00:00
[2024-09-08T17:09:26.310-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:09:26.310-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_2 to None, run_after=None
[2024-09-08T17:09:26.664-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:09:26.662-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:09:26.665-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:09:26.664-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:09:26.666-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:09:26.665-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:09:26.666-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:09:26.666-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:09:26.667-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:09:26.667-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:09:26.668-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:09:26.668-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:09:26.669-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:09:26.669-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:09:26.670-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:09:26.670-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:09:26.671-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:09:26.670-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:09:26.672-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:09:26.671-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:09:26.672-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:09:26.672-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T17:09:26.673-0300] {processor.py:211} ERROR - Got an exception! Propagating...
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 207, in _run_file_processor
    _handle_dag_file_processing()
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 188, in _handle_dag_file_processing
    result: tuple[int, int, int] = dag_file_processor.process_file(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 942, in process_file
    serialize_errors = DagFileProcessor.save_dag_to_db(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/api_internal/internal_api_call.py", line 139, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 982, in save_dag_to_db
    import_errors = DagBag._sync_to_db(dags=dags, processor_subdir=dag_directory, session=session)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 707, in _sync_to_db
    for attempt in run_with_db_retries(logger=log):
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 443, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 723, in _sync_to_db
    DAG.bulk_write_to_db(dags.values(), processor_subdir=processor_subdir, session=session)
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dag.py", line 3242, in bulk_write_to_db
    orm_dags: list[DagModel] = session.scalars(query).unique().all()
                               ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1778, in scalars
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:12:54.320-0300] {processor.py:186} INFO - Started process (PID=99080) to work on /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T17:12:54.321-0300] {processor.py:914} INFO - Processing file /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py for tasks to queue
[2024-09-08T17:12:54.322-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:12:54.322-0300] {dagbag.py:587} INFO - Filling up the DagBag from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T17:12:54.332-0300] {processor.py:925} INFO - DAG(s) 'dataset_consumes_1_and_2', 'dataset_consumes_1', 'consume_1_and_2_with_dataset_expressions', 'conditional_dataset_and_time_based_timetable', 'dataset_consumes_1_never_scheduled', 'consume_1_or_2_with_dataset_expressions', 'dataset_consumes_unknown_never_scheduled', 'dataset_produces_2', 'dataset_produces_1', 'consume_1_or_both_2_and_3_with_dataset_expressions' retrieved from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T17:12:54.476-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:12:54.476-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T17:12:54.483-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:12:54.483-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_2_with_dataset_expressions
[2024-09-08T17:12:54.483-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:12:54.483-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_never_scheduled
[2024-09-08T17:12:54.484-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:12:54.484-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1
[2024-09-08T17:12:54.484-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:12:54.484-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_and_2_with_dataset_expressions
[2024-09-08T17:12:54.484-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:12:54.484-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_both_2_and_3_with_dataset_expressions
[2024-09-08T17:12:54.485-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:12:54.485-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_and_2
[2024-09-08T17:12:54.485-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:12:54.485-0300] {dag.py:3252} INFO - Creating ORM DAG for conditional_dataset_and_time_based_timetable
[2024-09-08T17:12:54.485-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:12:54.485-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_2
[2024-09-08T17:12:54.486-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:12:54.486-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_1
[2024-09-08T17:12:54.486-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:12:54.486-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_unknown_never_scheduled
[2024-09-08T17:12:54.492-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:12:54.492-0300] {dag.py:4156} INFO - Setting next_dagrun for conditional_dataset_and_time_based_timetable to 2024-09-04 01:00:00+00:00, run_after=2024-09-04 01:00:00+00:00
[2024-09-08T17:12:54.492-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:12:54.492-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_and_2_with_dataset_expressions to None, run_after=None
[2024-09-08T17:12:54.493-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:12:54.493-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_2_with_dataset_expressions to None, run_after=None
[2024-09-08T17:12:54.493-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:12:54.493-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_both_2_and_3_with_dataset_expressions to None, run_after=None
[2024-09-08T17:12:54.493-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:12:54.493-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1 to None, run_after=None
[2024-09-08T17:12:54.494-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:12:54.494-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_and_2 to None, run_after=None
[2024-09-08T17:12:54.494-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:12:54.494-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_never_scheduled to None, run_after=None
[2024-09-08T17:12:54.494-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:12:54.494-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_unknown_never_scheduled to None, run_after=None
[2024-09-08T17:12:54.495-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:12:54.495-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_1 to 2024-09-07 00:00:00+00:00, run_after=2024-09-08 00:00:00+00:00
[2024-09-08T17:12:54.496-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:12:54.496-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_2 to None, run_after=None
[2024-09-08T17:12:54.679-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:12:54.678-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:12:54.680-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:12:54.680-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:12:54.681-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:12:54.681-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:12:54.682-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:12:54.682-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:12:54.683-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:12:54.683-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:12:54.684-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:12:54.684-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:12:54.685-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:12:54.684-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:12:54.686-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:12:54.685-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:12:54.687-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:12:54.686-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:12:54.688-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:12:54.687-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:12:54.688-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:12:54.688-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T17:12:54.689-0300] {processor.py:211} ERROR - Got an exception! Propagating...
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 207, in _run_file_processor
    _handle_dag_file_processing()
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 188, in _handle_dag_file_processing
    result: tuple[int, int, int] = dag_file_processor.process_file(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 942, in process_file
    serialize_errors = DagFileProcessor.save_dag_to_db(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/api_internal/internal_api_call.py", line 139, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 982, in save_dag_to_db
    import_errors = DagBag._sync_to_db(dags=dags, processor_subdir=dag_directory, session=session)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 707, in _sync_to_db
    for attempt in run_with_db_retries(logger=log):
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 443, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 723, in _sync_to_db
    DAG.bulk_write_to_db(dags.values(), processor_subdir=processor_subdir, session=session)
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dag.py", line 3242, in bulk_write_to_db
    orm_dags: list[DagModel] = session.scalars(query).unique().all()
                               ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1778, in scalars
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:16:23.143-0300] {processor.py:186} INFO - Started process (PID=101843) to work on /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T17:16:23.144-0300] {processor.py:914} INFO - Processing file /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py for tasks to queue
[2024-09-08T17:16:23.145-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:16:23.145-0300] {dagbag.py:587} INFO - Filling up the DagBag from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T17:16:23.154-0300] {processor.py:925} INFO - DAG(s) 'conditional_dataset_and_time_based_timetable', 'dataset_produces_1', 'dataset_consumes_1_never_scheduled', 'dataset_consumes_unknown_never_scheduled', 'dataset_consumes_1_and_2', 'consume_1_and_2_with_dataset_expressions', 'dataset_consumes_1', 'dataset_produces_2', 'consume_1_or_both_2_and_3_with_dataset_expressions', 'consume_1_or_2_with_dataset_expressions' retrieved from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T17:16:23.297-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:16:23.297-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T17:16:23.304-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:16:23.304-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_2_with_dataset_expressions
[2024-09-08T17:16:23.305-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:16:23.305-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_never_scheduled
[2024-09-08T17:16:23.305-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:16:23.305-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1
[2024-09-08T17:16:23.306-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:16:23.305-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_and_2_with_dataset_expressions
[2024-09-08T17:16:23.306-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:16:23.306-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_both_2_and_3_with_dataset_expressions
[2024-09-08T17:16:23.306-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:16:23.306-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_1
[2024-09-08T17:16:23.307-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:16:23.306-0300] {dag.py:3252} INFO - Creating ORM DAG for conditional_dataset_and_time_based_timetable
[2024-09-08T17:16:23.307-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:16:23.307-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_and_2
[2024-09-08T17:16:23.307-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:16:23.307-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_2
[2024-09-08T17:16:23.308-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:16:23.307-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_unknown_never_scheduled
[2024-09-08T17:16:23.314-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:16:23.314-0300] {dag.py:4156} INFO - Setting next_dagrun for conditional_dataset_and_time_based_timetable to 2024-09-04 01:00:00+00:00, run_after=2024-09-04 01:00:00+00:00
[2024-09-08T17:16:23.314-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:16:23.314-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_and_2_with_dataset_expressions to None, run_after=None
[2024-09-08T17:16:23.314-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:16:23.314-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_2_with_dataset_expressions to None, run_after=None
[2024-09-08T17:16:23.315-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:16:23.315-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_both_2_and_3_with_dataset_expressions to None, run_after=None
[2024-09-08T17:16:23.315-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:16:23.315-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1 to None, run_after=None
[2024-09-08T17:16:23.315-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:16:23.315-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_and_2 to None, run_after=None
[2024-09-08T17:16:23.316-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:16:23.316-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_never_scheduled to None, run_after=None
[2024-09-08T17:16:23.316-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:16:23.316-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_unknown_never_scheduled to None, run_after=None
[2024-09-08T17:16:23.317-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:16:23.317-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_1 to 2024-09-07 00:00:00+00:00, run_after=2024-09-08 00:00:00+00:00
[2024-09-08T17:16:23.317-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:16:23.317-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_2 to None, run_after=None
[2024-09-08T17:16:23.707-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:16:23.706-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:16:23.708-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:16:23.708-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:16:23.709-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:16:23.709-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:16:23.710-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:16:23.710-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:16:23.711-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:16:23.710-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:16:23.712-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:16:23.711-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:16:23.713-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:16:23.712-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:16:23.713-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:16:23.713-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:16:23.714-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:16:23.714-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:16:23.715-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:16:23.715-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:16:23.716-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:16:23.716-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T17:16:23.716-0300] {processor.py:211} ERROR - Got an exception! Propagating...
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 207, in _run_file_processor
    _handle_dag_file_processing()
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 188, in _handle_dag_file_processing
    result: tuple[int, int, int] = dag_file_processor.process_file(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 942, in process_file
    serialize_errors = DagFileProcessor.save_dag_to_db(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/api_internal/internal_api_call.py", line 139, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 982, in save_dag_to_db
    import_errors = DagBag._sync_to_db(dags=dags, processor_subdir=dag_directory, session=session)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 707, in _sync_to_db
    for attempt in run_with_db_retries(logger=log):
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 443, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 723, in _sync_to_db
    DAG.bulk_write_to_db(dags.values(), processor_subdir=processor_subdir, session=session)
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dag.py", line 3242, in bulk_write_to_db
    orm_dags: list[DagModel] = session.scalars(query).unique().all()
                               ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1778, in scalars
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:20:01.567-0300] {processor.py:186} INFO - Started process (PID=104755) to work on /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T17:20:01.568-0300] {processor.py:914} INFO - Processing file /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py for tasks to queue
[2024-09-08T17:20:01.569-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:20:01.569-0300] {dagbag.py:587} INFO - Filling up the DagBag from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T17:20:01.578-0300] {processor.py:925} INFO - DAG(s) 'conditional_dataset_and_time_based_timetable', 'dataset_consumes_1_never_scheduled', 'dataset_consumes_1_and_2', 'dataset_produces_1', 'consume_1_or_both_2_and_3_with_dataset_expressions', 'consume_1_and_2_with_dataset_expressions', 'dataset_produces_2', 'consume_1_or_2_with_dataset_expressions', 'dataset_consumes_1', 'dataset_consumes_unknown_never_scheduled' retrieved from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T17:20:01.718-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:20:01.718-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T17:20:01.726-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:20:01.725-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_2_with_dataset_expressions
[2024-09-08T17:20:01.726-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:20:01.726-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_never_scheduled
[2024-09-08T17:20:01.726-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:20:01.726-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1
[2024-09-08T17:20:01.727-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:20:01.727-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_both_2_and_3_with_dataset_expressions
[2024-09-08T17:20:01.727-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:20:01.727-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_and_2_with_dataset_expressions
[2024-09-08T17:20:01.727-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:20:01.727-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_and_2
[2024-09-08T17:20:01.728-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:20:01.728-0300] {dag.py:3252} INFO - Creating ORM DAG for conditional_dataset_and_time_based_timetable
[2024-09-08T17:20:01.728-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:20:01.728-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_1
[2024-09-08T17:20:01.728-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:20:01.728-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_2
[2024-09-08T17:20:01.729-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:20:01.729-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_unknown_never_scheduled
[2024-09-08T17:20:01.735-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:20:01.735-0300] {dag.py:4156} INFO - Setting next_dagrun for conditional_dataset_and_time_based_timetable to 2024-09-04 01:00:00+00:00, run_after=2024-09-04 01:00:00+00:00
[2024-09-08T17:20:01.735-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:20:01.735-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_and_2_with_dataset_expressions to None, run_after=None
[2024-09-08T17:20:01.735-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:20:01.735-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_2_with_dataset_expressions to None, run_after=None
[2024-09-08T17:20:01.736-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:20:01.736-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_both_2_and_3_with_dataset_expressions to None, run_after=None
[2024-09-08T17:20:01.736-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:20:01.736-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1 to None, run_after=None
[2024-09-08T17:20:01.736-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:20:01.736-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_and_2 to None, run_after=None
[2024-09-08T17:20:01.737-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:20:01.737-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_never_scheduled to None, run_after=None
[2024-09-08T17:20:01.737-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:20:01.737-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_unknown_never_scheduled to None, run_after=None
[2024-09-08T17:20:01.738-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:20:01.738-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_1 to 2024-09-07 00:00:00+00:00, run_after=2024-09-08 00:00:00+00:00
[2024-09-08T17:20:01.739-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:20:01.739-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_2 to None, run_after=None
[2024-09-08T17:20:02.233-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:20:02.232-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:20:02.234-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:20:02.234-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:20:02.235-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:20:02.235-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:20:02.236-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:20:02.236-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:20:02.237-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:20:02.236-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:20:02.238-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:20:02.237-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:20:02.239-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:20:02.238-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:20:02.239-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:20:02.239-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:20:02.240-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:20:02.240-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:20:02.241-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:20:02.241-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:20:02.242-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:20:02.242-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T17:20:02.242-0300] {processor.py:211} ERROR - Got an exception! Propagating...
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 207, in _run_file_processor
    _handle_dag_file_processing()
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 188, in _handle_dag_file_processing
    result: tuple[int, int, int] = dag_file_processor.process_file(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 942, in process_file
    serialize_errors = DagFileProcessor.save_dag_to_db(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/api_internal/internal_api_call.py", line 139, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 982, in save_dag_to_db
    import_errors = DagBag._sync_to_db(dags=dags, processor_subdir=dag_directory, session=session)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 707, in _sync_to_db
    for attempt in run_with_db_retries(logger=log):
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 443, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 723, in _sync_to_db
    DAG.bulk_write_to_db(dags.values(), processor_subdir=processor_subdir, session=session)
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dag.py", line 3242, in bulk_write_to_db
    orm_dags: list[DagModel] = session.scalars(query).unique().all()
                               ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1778, in scalars
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:23:28.431-0300] {processor.py:186} INFO - Started process (PID=107519) to work on /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T17:23:28.432-0300] {processor.py:914} INFO - Processing file /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py for tasks to queue
[2024-09-08T17:23:28.433-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:23:28.433-0300] {dagbag.py:587} INFO - Filling up the DagBag from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T17:23:28.443-0300] {processor.py:925} INFO - DAG(s) 'consume_1_and_2_with_dataset_expressions', 'dataset_produces_2', 'dataset_consumes_1', 'consume_1_or_both_2_and_3_with_dataset_expressions', 'dataset_consumes_1_and_2', 'dataset_consumes_1_never_scheduled', 'conditional_dataset_and_time_based_timetable', 'consume_1_or_2_with_dataset_expressions', 'dataset_consumes_unknown_never_scheduled', 'dataset_produces_1' retrieved from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T17:23:28.586-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:23:28.586-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T17:23:28.593-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:23:28.593-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_2_with_dataset_expressions
[2024-09-08T17:23:28.594-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:23:28.594-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_never_scheduled
[2024-09-08T17:23:28.594-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:23:28.594-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1
[2024-09-08T17:23:28.595-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:23:28.594-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_and_2_with_dataset_expressions
[2024-09-08T17:23:28.595-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:23:28.595-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_both_2_and_3_with_dataset_expressions
[2024-09-08T17:23:28.595-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:23:28.595-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_2
[2024-09-08T17:23:28.596-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:23:28.595-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_and_2
[2024-09-08T17:23:28.596-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:23:28.596-0300] {dag.py:3252} INFO - Creating ORM DAG for conditional_dataset_and_time_based_timetable
[2024-09-08T17:23:28.596-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:23:28.596-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_1
[2024-09-08T17:23:28.597-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:23:28.596-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_unknown_never_scheduled
[2024-09-08T17:23:28.603-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:23:28.603-0300] {dag.py:4156} INFO - Setting next_dagrun for conditional_dataset_and_time_based_timetable to 2024-09-04 01:00:00+00:00, run_after=2024-09-04 01:00:00+00:00
[2024-09-08T17:23:28.604-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:23:28.604-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_and_2_with_dataset_expressions to None, run_after=None
[2024-09-08T17:23:28.604-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:23:28.604-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_2_with_dataset_expressions to None, run_after=None
[2024-09-08T17:23:28.604-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:23:28.604-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_both_2_and_3_with_dataset_expressions to None, run_after=None
[2024-09-08T17:23:28.605-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:23:28.605-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1 to None, run_after=None
[2024-09-08T17:23:28.605-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:23:28.605-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_and_2 to None, run_after=None
[2024-09-08T17:23:28.605-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:23:28.605-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_never_scheduled to None, run_after=None
[2024-09-08T17:23:28.606-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:23:28.605-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_unknown_never_scheduled to None, run_after=None
[2024-09-08T17:23:28.607-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:23:28.607-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_1 to 2024-09-07 00:00:00+00:00, run_after=2024-09-08 00:00:00+00:00
[2024-09-08T17:23:28.607-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:23:28.607-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_2 to None, run_after=None
[2024-09-08T17:23:29.033-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:23:29.031-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:23:29.034-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:23:29.033-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:23:29.035-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:23:29.034-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:23:29.036-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:23:29.035-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:23:29.036-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:23:29.036-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:23:29.037-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:23:29.037-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:23:29.038-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:23:29.038-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:23:29.039-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:23:29.039-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:23:29.040-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:23:29.040-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:23:29.041-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:23:29.040-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:23:29.041-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:23:29.041-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T17:23:29.042-0300] {processor.py:211} ERROR - Got an exception! Propagating...
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 207, in _run_file_processor
    _handle_dag_file_processing()
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 188, in _handle_dag_file_processing
    result: tuple[int, int, int] = dag_file_processor.process_file(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 942, in process_file
    serialize_errors = DagFileProcessor.save_dag_to_db(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/api_internal/internal_api_call.py", line 139, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 982, in save_dag_to_db
    import_errors = DagBag._sync_to_db(dags=dags, processor_subdir=dag_directory, session=session)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 707, in _sync_to_db
    for attempt in run_with_db_retries(logger=log):
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 443, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 723, in _sync_to_db
    DAG.bulk_write_to_db(dags.values(), processor_subdir=processor_subdir, session=session)
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dag.py", line 3242, in bulk_write_to_db
    orm_dags: list[DagModel] = session.scalars(query).unique().all()
                               ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1778, in scalars
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:26:57.505-0300] {processor.py:186} INFO - Started process (PID=110329) to work on /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T17:26:57.516-0300] {processor.py:914} INFO - Processing file /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py for tasks to queue
[2024-09-08T17:26:57.517-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:26:57.517-0300] {dagbag.py:587} INFO - Filling up the DagBag from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T17:26:57.528-0300] {processor.py:925} INFO - DAG(s) 'dataset_consumes_1', 'dataset_produces_2', 'dataset_produces_1', 'dataset_consumes_1_never_scheduled', 'consume_1_or_2_with_dataset_expressions', 'dataset_consumes_1_and_2', 'dataset_consumes_unknown_never_scheduled', 'consume_1_or_both_2_and_3_with_dataset_expressions', 'consume_1_and_2_with_dataset_expressions', 'conditional_dataset_and_time_based_timetable' retrieved from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T17:26:57.670-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:26:57.669-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T17:26:57.678-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:26:57.677-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_2_with_dataset_expressions
[2024-09-08T17:26:57.678-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:26:57.678-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_never_scheduled
[2024-09-08T17:26:57.678-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:26:57.678-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1
[2024-09-08T17:26:57.679-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:26:57.679-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_both_2_and_3_with_dataset_expressions
[2024-09-08T17:26:57.679-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:26:57.679-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_and_2_with_dataset_expressions
[2024-09-08T17:26:57.679-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:26:57.679-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_2
[2024-09-08T17:26:57.680-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:26:57.680-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_1
[2024-09-08T17:26:57.680-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:26:57.680-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_and_2
[2024-09-08T17:26:57.680-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:26:57.680-0300] {dag.py:3252} INFO - Creating ORM DAG for conditional_dataset_and_time_based_timetable
[2024-09-08T17:26:57.681-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:26:57.681-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_unknown_never_scheduled
[2024-09-08T17:26:57.687-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:26:57.686-0300] {dag.py:4156} INFO - Setting next_dagrun for conditional_dataset_and_time_based_timetable to 2024-09-04 01:00:00+00:00, run_after=2024-09-04 01:00:00+00:00
[2024-09-08T17:26:57.687-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:26:57.687-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_and_2_with_dataset_expressions to None, run_after=None
[2024-09-08T17:26:57.687-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:26:57.687-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_2_with_dataset_expressions to None, run_after=None
[2024-09-08T17:26:57.687-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:26:57.687-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_both_2_and_3_with_dataset_expressions to None, run_after=None
[2024-09-08T17:26:57.688-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:26:57.688-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1 to None, run_after=None
[2024-09-08T17:26:57.688-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:26:57.688-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_and_2 to None, run_after=None
[2024-09-08T17:26:57.688-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:26:57.688-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_never_scheduled to None, run_after=None
[2024-09-08T17:26:57.689-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:26:57.688-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_unknown_never_scheduled to None, run_after=None
[2024-09-08T17:26:57.690-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:26:57.690-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_1 to 2024-09-07 00:00:00+00:00, run_after=2024-09-08 00:00:00+00:00
[2024-09-08T17:26:57.690-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:26:57.690-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_2 to None, run_after=None
[2024-09-08T17:26:57.768-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:26:57.766-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:26:57.769-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:26:57.768-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:26:57.769-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:26:57.769-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:26:57.770-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:26:57.770-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:26:57.771-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:26:57.771-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:26:57.772-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:26:57.772-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:26:57.773-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:26:57.773-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:26:57.774-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:26:57.773-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:26:57.775-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:26:57.774-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:26:57.776-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:26:57.775-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:26:57.776-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:26:57.776-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T17:26:57.777-0300] {processor.py:211} ERROR - Got an exception! Propagating...
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 207, in _run_file_processor
    _handle_dag_file_processing()
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 188, in _handle_dag_file_processing
    result: tuple[int, int, int] = dag_file_processor.process_file(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 942, in process_file
    serialize_errors = DagFileProcessor.save_dag_to_db(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/api_internal/internal_api_call.py", line 139, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 982, in save_dag_to_db
    import_errors = DagBag._sync_to_db(dags=dags, processor_subdir=dag_directory, session=session)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 707, in _sync_to_db
    for attempt in run_with_db_retries(logger=log):
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 443, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 723, in _sync_to_db
    DAG.bulk_write_to_db(dags.values(), processor_subdir=processor_subdir, session=session)
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dag.py", line 3242, in bulk_write_to_db
    orm_dags: list[DagModel] = session.scalars(query).unique().all()
                               ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1778, in scalars
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:30:14.462-0300] {processor.py:186} INFO - Started process (PID=112964) to work on /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T17:30:14.463-0300] {processor.py:914} INFO - Processing file /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py for tasks to queue
[2024-09-08T17:30:14.464-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:30:14.464-0300] {dagbag.py:587} INFO - Filling up the DagBag from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T17:30:14.473-0300] {processor.py:925} INFO - DAG(s) 'dataset_produces_1', 'dataset_consumes_1', 'consume_1_and_2_with_dataset_expressions', 'consume_1_or_both_2_and_3_with_dataset_expressions', 'conditional_dataset_and_time_based_timetable', 'dataset_consumes_1_never_scheduled', 'consume_1_or_2_with_dataset_expressions', 'dataset_consumes_1_and_2', 'dataset_consumes_unknown_never_scheduled', 'dataset_produces_2' retrieved from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T17:30:14.617-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:30:14.616-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T17:30:14.624-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:30:14.624-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_2_with_dataset_expressions
[2024-09-08T17:30:14.625-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:30:14.625-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_never_scheduled
[2024-09-08T17:30:14.625-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:30:14.625-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1
[2024-09-08T17:30:14.625-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:30:14.625-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_and_2_with_dataset_expressions
[2024-09-08T17:30:14.626-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:30:14.626-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_both_2_and_3_with_dataset_expressions
[2024-09-08T17:30:14.626-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:30:14.626-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_1
[2024-09-08T17:30:14.627-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:30:14.626-0300] {dag.py:3252} INFO - Creating ORM DAG for conditional_dataset_and_time_based_timetable
[2024-09-08T17:30:14.627-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:30:14.627-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_and_2
[2024-09-08T17:30:14.627-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:30:14.627-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_2
[2024-09-08T17:30:14.628-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:30:14.627-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_unknown_never_scheduled
[2024-09-08T17:30:14.634-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:30:14.633-0300] {dag.py:4156} INFO - Setting next_dagrun for conditional_dataset_and_time_based_timetable to 2024-09-04 01:00:00+00:00, run_after=2024-09-04 01:00:00+00:00
[2024-09-08T17:30:14.634-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:30:14.634-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_and_2_with_dataset_expressions to None, run_after=None
[2024-09-08T17:30:14.634-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:30:14.634-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_2_with_dataset_expressions to None, run_after=None
[2024-09-08T17:30:14.634-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:30:14.634-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_both_2_and_3_with_dataset_expressions to None, run_after=None
[2024-09-08T17:30:14.635-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:30:14.635-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1 to None, run_after=None
[2024-09-08T17:30:14.635-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:30:14.635-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_and_2 to None, run_after=None
[2024-09-08T17:30:14.635-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:30:14.635-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_never_scheduled to None, run_after=None
[2024-09-08T17:30:14.636-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:30:14.635-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_unknown_never_scheduled to None, run_after=None
[2024-09-08T17:30:14.637-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:30:14.637-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_1 to 2024-09-07 00:00:00+00:00, run_after=2024-09-08 00:00:00+00:00
[2024-09-08T17:30:14.637-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:30:14.637-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_2 to None, run_after=None
[2024-09-08T17:30:14.686-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:30:14.684-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:30:14.687-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:30:14.686-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:30:14.688-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:30:14.687-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:30:14.689-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:30:14.688-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:30:14.689-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:30:14.689-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:30:14.690-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:30:14.690-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:30:14.691-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:30:14.691-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:30:14.692-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:30:14.692-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:30:14.693-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:30:14.693-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:30:14.694-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:30:14.693-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:30:14.694-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:30:14.694-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T17:30:14.695-0300] {processor.py:211} ERROR - Got an exception! Propagating...
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 207, in _run_file_processor
    _handle_dag_file_processing()
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 188, in _handle_dag_file_processing
    result: tuple[int, int, int] = dag_file_processor.process_file(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 942, in process_file
    serialize_errors = DagFileProcessor.save_dag_to_db(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/api_internal/internal_api_call.py", line 139, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 982, in save_dag_to_db
    import_errors = DagBag._sync_to_db(dags=dags, processor_subdir=dag_directory, session=session)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 707, in _sync_to_db
    for attempt in run_with_db_retries(logger=log):
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 443, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 723, in _sync_to_db
    DAG.bulk_write_to_db(dags.values(), processor_subdir=processor_subdir, session=session)
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dag.py", line 3242, in bulk_write_to_db
    orm_dags: list[DagModel] = session.scalars(query).unique().all()
                               ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1778, in scalars
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:33:34.019-0300] {processor.py:186} INFO - Started process (PID=115566) to work on /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T17:33:34.020-0300] {processor.py:914} INFO - Processing file /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py for tasks to queue
[2024-09-08T17:33:34.021-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:33:34.021-0300] {dagbag.py:587} INFO - Filling up the DagBag from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T17:33:34.030-0300] {processor.py:925} INFO - DAG(s) 'conditional_dataset_and_time_based_timetable', 'dataset_produces_1', 'dataset_consumes_1', 'dataset_consumes_1_never_scheduled', 'dataset_produces_2', 'consume_1_and_2_with_dataset_expressions', 'consume_1_or_both_2_and_3_with_dataset_expressions', 'consume_1_or_2_with_dataset_expressions', 'dataset_consumes_1_and_2', 'dataset_consumes_unknown_never_scheduled' retrieved from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T17:33:34.175-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:33:34.175-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T17:33:34.183-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:33:34.183-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_2_with_dataset_expressions
[2024-09-08T17:33:34.183-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:33:34.183-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_never_scheduled
[2024-09-08T17:33:34.184-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:33:34.184-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1
[2024-09-08T17:33:34.184-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:33:34.184-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_and_2_with_dataset_expressions
[2024-09-08T17:33:34.184-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:33:34.184-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_both_2_and_3_with_dataset_expressions
[2024-09-08T17:33:34.185-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:33:34.185-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_1
[2024-09-08T17:33:34.185-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:33:34.185-0300] {dag.py:3252} INFO - Creating ORM DAG for conditional_dataset_and_time_based_timetable
[2024-09-08T17:33:34.185-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:33:34.185-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_2
[2024-09-08T17:33:34.186-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:33:34.186-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_and_2
[2024-09-08T17:33:34.186-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:33:34.186-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_unknown_never_scheduled
[2024-09-08T17:33:34.192-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:33:34.192-0300] {dag.py:4156} INFO - Setting next_dagrun for conditional_dataset_and_time_based_timetable to 2024-09-04 01:00:00+00:00, run_after=2024-09-04 01:00:00+00:00
[2024-09-08T17:33:34.192-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:33:34.192-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_and_2_with_dataset_expressions to None, run_after=None
[2024-09-08T17:33:34.193-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:33:34.193-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_2_with_dataset_expressions to None, run_after=None
[2024-09-08T17:33:34.193-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:33:34.193-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_both_2_and_3_with_dataset_expressions to None, run_after=None
[2024-09-08T17:33:34.193-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:33:34.193-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1 to None, run_after=None
[2024-09-08T17:33:34.193-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:33:34.193-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_and_2 to None, run_after=None
[2024-09-08T17:33:34.194-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:33:34.194-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_never_scheduled to None, run_after=None
[2024-09-08T17:33:34.194-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:33:34.194-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_unknown_never_scheduled to None, run_after=None
[2024-09-08T17:33:34.195-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:33:34.195-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_1 to 2024-09-07 00:00:00+00:00, run_after=2024-09-08 00:00:00+00:00
[2024-09-08T17:33:34.196-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:33:34.195-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_2 to None, run_after=None
[2024-09-08T17:33:34.384-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:33:34.383-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:33:34.385-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:33:34.385-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:33:34.386-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:33:34.386-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:33:34.387-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:33:34.387-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:33:34.388-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:33:34.387-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:33:34.389-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:33:34.388-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:33:34.389-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:33:34.389-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:33:34.390-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:33:34.390-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:33:34.391-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:33:34.391-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:33:34.392-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:33:34.392-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:33:34.393-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:33:34.392-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T17:33:34.393-0300] {processor.py:211} ERROR - Got an exception! Propagating...
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 207, in _run_file_processor
    _handle_dag_file_processing()
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 188, in _handle_dag_file_processing
    result: tuple[int, int, int] = dag_file_processor.process_file(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 942, in process_file
    serialize_errors = DagFileProcessor.save_dag_to_db(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/api_internal/internal_api_call.py", line 139, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 982, in save_dag_to_db
    import_errors = DagBag._sync_to_db(dags=dags, processor_subdir=dag_directory, session=session)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 707, in _sync_to_db
    for attempt in run_with_db_retries(logger=log):
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 443, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 723, in _sync_to_db
    DAG.bulk_write_to_db(dags.values(), processor_subdir=processor_subdir, session=session)
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dag.py", line 3242, in bulk_write_to_db
    orm_dags: list[DagModel] = session.scalars(query).unique().all()
                               ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1778, in scalars
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:36:50.442-0300] {processor.py:186} INFO - Started process (PID=118141) to work on /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T17:36:50.443-0300] {processor.py:914} INFO - Processing file /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py for tasks to queue
[2024-09-08T17:36:50.444-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:36:50.444-0300] {dagbag.py:587} INFO - Filling up the DagBag from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T17:36:50.455-0300] {processor.py:925} INFO - DAG(s) 'dataset_consumes_1', 'dataset_consumes_1_never_scheduled', 'conditional_dataset_and_time_based_timetable', 'dataset_consumes_unknown_never_scheduled', 'consume_1_and_2_with_dataset_expressions', 'dataset_consumes_1_and_2', 'consume_1_or_2_with_dataset_expressions', 'consume_1_or_both_2_and_3_with_dataset_expressions', 'dataset_produces_2', 'dataset_produces_1' retrieved from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T17:36:50.598-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:36:50.597-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T17:36:50.605-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:36:50.605-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_2_with_dataset_expressions
[2024-09-08T17:36:50.606-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:36:50.605-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_never_scheduled
[2024-09-08T17:36:50.606-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:36:50.606-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1
[2024-09-08T17:36:50.606-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:36:50.606-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_and_2_with_dataset_expressions
[2024-09-08T17:36:50.607-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:36:50.607-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_both_2_and_3_with_dataset_expressions
[2024-09-08T17:36:50.607-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:36:50.607-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_and_2
[2024-09-08T17:36:50.607-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:36:50.607-0300] {dag.py:3252} INFO - Creating ORM DAG for conditional_dataset_and_time_based_timetable
[2024-09-08T17:36:50.608-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:36:50.608-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_2
[2024-09-08T17:36:50.608-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:36:50.608-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_1
[2024-09-08T17:36:50.608-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:36:50.608-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_unknown_never_scheduled
[2024-09-08T17:36:50.614-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:36:50.614-0300] {dag.py:4156} INFO - Setting next_dagrun for conditional_dataset_and_time_based_timetable to 2024-09-04 01:00:00+00:00, run_after=2024-09-04 01:00:00+00:00
[2024-09-08T17:36:50.615-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:36:50.615-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_and_2_with_dataset_expressions to None, run_after=None
[2024-09-08T17:36:50.615-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:36:50.615-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_2_with_dataset_expressions to None, run_after=None
[2024-09-08T17:36:50.615-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:36:50.615-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_both_2_and_3_with_dataset_expressions to None, run_after=None
[2024-09-08T17:36:50.615-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:36:50.615-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1 to None, run_after=None
[2024-09-08T17:36:50.616-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:36:50.616-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_and_2 to None, run_after=None
[2024-09-08T17:36:50.616-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:36:50.616-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_never_scheduled to None, run_after=None
[2024-09-08T17:36:50.616-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:36:50.616-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_unknown_never_scheduled to None, run_after=None
[2024-09-08T17:36:50.617-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:36:50.617-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_1 to 2024-09-07 00:00:00+00:00, run_after=2024-09-08 00:00:00+00:00
[2024-09-08T17:36:50.618-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:36:50.618-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_2 to None, run_after=None
[2024-09-08T17:36:50.703-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:36:50.702-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:36:50.704-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:36:50.704-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:36:50.705-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:36:50.704-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:36:50.706-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:36:50.705-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:36:50.707-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:36:50.706-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:36:50.707-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:36:50.707-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:36:50.708-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:36:50.708-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:36:50.709-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:36:50.709-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:36:50.710-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:36:50.710-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:36:50.711-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:36:50.711-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:36:50.711-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:36:50.711-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T17:36:50.712-0300] {processor.py:211} ERROR - Got an exception! Propagating...
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 207, in _run_file_processor
    _handle_dag_file_processing()
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 188, in _handle_dag_file_processing
    result: tuple[int, int, int] = dag_file_processor.process_file(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 942, in process_file
    serialize_errors = DagFileProcessor.save_dag_to_db(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/api_internal/internal_api_call.py", line 139, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 982, in save_dag_to_db
    import_errors = DagBag._sync_to_db(dags=dags, processor_subdir=dag_directory, session=session)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 707, in _sync_to_db
    for attempt in run_with_db_retries(logger=log):
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 443, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 723, in _sync_to_db
    DAG.bulk_write_to_db(dags.values(), processor_subdir=processor_subdir, session=session)
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dag.py", line 3242, in bulk_write_to_db
    orm_dags: list[DagModel] = session.scalars(query).unique().all()
                               ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1778, in scalars
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:40:01.406-0300] {processor.py:186} INFO - Started process (PID=120706) to work on /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T17:40:01.407-0300] {processor.py:914} INFO - Processing file /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py for tasks to queue
[2024-09-08T17:40:01.409-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:40:01.408-0300] {dagbag.py:587} INFO - Filling up the DagBag from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T17:40:01.418-0300] {processor.py:925} INFO - DAG(s) 'consume_1_and_2_with_dataset_expressions', 'conditional_dataset_and_time_based_timetable', 'dataset_produces_2', 'dataset_consumes_1', 'dataset_consumes_1_never_scheduled', 'dataset_consumes_1_and_2', 'consume_1_or_both_2_and_3_with_dataset_expressions', 'dataset_consumes_unknown_never_scheduled', 'dataset_produces_1', 'consume_1_or_2_with_dataset_expressions' retrieved from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T17:40:01.564-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:40:01.564-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T17:40:01.571-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:40:01.571-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_2_with_dataset_expressions
[2024-09-08T17:40:01.572-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:40:01.572-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_never_scheduled
[2024-09-08T17:40:01.572-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:40:01.572-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1
[2024-09-08T17:40:01.573-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:40:01.572-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_and_2_with_dataset_expressions
[2024-09-08T17:40:01.573-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:40:01.573-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_both_2_and_3_with_dataset_expressions
[2024-09-08T17:40:01.573-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:40:01.573-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_2
[2024-09-08T17:40:01.574-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:40:01.573-0300] {dag.py:3252} INFO - Creating ORM DAG for conditional_dataset_and_time_based_timetable
[2024-09-08T17:40:01.574-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:40:01.574-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_and_2
[2024-09-08T17:40:01.574-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:40:01.574-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_1
[2024-09-08T17:40:01.575-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:40:01.574-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_unknown_never_scheduled
[2024-09-08T17:40:01.581-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:40:01.580-0300] {dag.py:4156} INFO - Setting next_dagrun for conditional_dataset_and_time_based_timetable to 2024-09-04 01:00:00+00:00, run_after=2024-09-04 01:00:00+00:00
[2024-09-08T17:40:01.581-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:40:01.581-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_and_2_with_dataset_expressions to None, run_after=None
[2024-09-08T17:40:01.581-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:40:01.581-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_2_with_dataset_expressions to None, run_after=None
[2024-09-08T17:40:01.581-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:40:01.581-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_both_2_and_3_with_dataset_expressions to None, run_after=None
[2024-09-08T17:40:01.582-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:40:01.582-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1 to None, run_after=None
[2024-09-08T17:40:01.582-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:40:01.582-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_and_2 to None, run_after=None
[2024-09-08T17:40:01.582-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:40:01.582-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_never_scheduled to None, run_after=None
[2024-09-08T17:40:01.583-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:40:01.583-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_unknown_never_scheduled to None, run_after=None
[2024-09-08T17:40:01.584-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:40:01.584-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_1 to 2024-09-07 00:00:00+00:00, run_after=2024-09-08 00:00:00+00:00
[2024-09-08T17:40:01.584-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:40:01.584-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_2 to None, run_after=None
[2024-09-08T17:40:01.909-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:40:01.908-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:40:01.910-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:40:01.910-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:40:01.911-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:40:01.911-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:40:01.912-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:40:01.911-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:40:01.913-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:40:01.912-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:40:01.914-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:40:01.913-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:40:01.914-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:40:01.914-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:40:01.915-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:40:01.915-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:40:01.916-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:40:01.916-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:40:01.917-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:40:01.917-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:40:01.917-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:40:01.917-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T17:40:01.918-0300] {processor.py:211} ERROR - Got an exception! Propagating...
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 207, in _run_file_processor
    _handle_dag_file_processing()
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 188, in _handle_dag_file_processing
    result: tuple[int, int, int] = dag_file_processor.process_file(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 942, in process_file
    serialize_errors = DagFileProcessor.save_dag_to_db(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/api_internal/internal_api_call.py", line 139, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 982, in save_dag_to_db
    import_errors = DagBag._sync_to_db(dags=dags, processor_subdir=dag_directory, session=session)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 707, in _sync_to_db
    for attempt in run_with_db_retries(logger=log):
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 443, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 723, in _sync_to_db
    DAG.bulk_write_to_db(dags.values(), processor_subdir=processor_subdir, session=session)
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dag.py", line 3242, in bulk_write_to_db
    orm_dags: list[DagModel] = session.scalars(query).unique().all()
                               ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1778, in scalars
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:43:08.675-0300] {processor.py:186} INFO - Started process (PID=123218) to work on /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T17:43:08.676-0300] {processor.py:914} INFO - Processing file /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py for tasks to queue
[2024-09-08T17:43:08.677-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:43:08.677-0300] {dagbag.py:587} INFO - Filling up the DagBag from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T17:43:08.687-0300] {processor.py:925} INFO - DAG(s) 'dataset_consumes_1_and_2', 'dataset_consumes_unknown_never_scheduled', 'consume_1_or_both_2_and_3_with_dataset_expressions', 'consume_1_or_2_with_dataset_expressions', 'dataset_produces_2', 'conditional_dataset_and_time_based_timetable', 'dataset_produces_1', 'dataset_consumes_1', 'dataset_consumes_1_never_scheduled', 'consume_1_and_2_with_dataset_expressions' retrieved from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T17:43:08.827-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:43:08.827-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T17:43:08.835-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:43:08.834-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_2_with_dataset_expressions
[2024-09-08T17:43:08.835-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:43:08.835-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_never_scheduled
[2024-09-08T17:43:08.835-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:43:08.835-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1
[2024-09-08T17:43:08.836-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:43:08.836-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_both_2_and_3_with_dataset_expressions
[2024-09-08T17:43:08.836-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:43:08.836-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_and_2_with_dataset_expressions
[2024-09-08T17:43:08.836-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:43:08.836-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_and_2
[2024-09-08T17:43:08.837-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:43:08.837-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_2
[2024-09-08T17:43:08.837-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:43:08.837-0300] {dag.py:3252} INFO - Creating ORM DAG for conditional_dataset_and_time_based_timetable
[2024-09-08T17:43:08.837-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:43:08.837-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_1
[2024-09-08T17:43:08.838-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:43:08.838-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_unknown_never_scheduled
[2024-09-08T17:43:08.844-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:43:08.844-0300] {dag.py:4156} INFO - Setting next_dagrun for conditional_dataset_and_time_based_timetable to 2024-09-04 01:00:00+00:00, run_after=2024-09-04 01:00:00+00:00
[2024-09-08T17:43:08.844-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:43:08.844-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_and_2_with_dataset_expressions to None, run_after=None
[2024-09-08T17:43:08.844-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:43:08.844-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_2_with_dataset_expressions to None, run_after=None
[2024-09-08T17:43:08.845-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:43:08.844-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_both_2_and_3_with_dataset_expressions to None, run_after=None
[2024-09-08T17:43:08.845-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:43:08.845-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1 to None, run_after=None
[2024-09-08T17:43:08.845-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:43:08.845-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_and_2 to None, run_after=None
[2024-09-08T17:43:08.845-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:43:08.845-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_never_scheduled to None, run_after=None
[2024-09-08T17:43:08.846-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:43:08.846-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_unknown_never_scheduled to None, run_after=None
[2024-09-08T17:43:08.847-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:43:08.847-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_1 to 2024-09-07 00:00:00+00:00, run_after=2024-09-08 00:00:00+00:00
[2024-09-08T17:43:08.847-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:43:08.847-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_2 to None, run_after=None
[2024-09-08T17:43:09.165-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:43:09.164-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:43:09.166-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:43:09.166-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:43:09.167-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:43:09.167-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:43:09.168-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:43:09.168-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:43:09.169-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:43:09.168-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:43:09.170-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:43:09.169-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:43:09.170-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:43:09.170-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:43:09.171-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:43:09.171-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:43:09.172-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:43:09.172-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:43:09.173-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:43:09.173-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:43:09.174-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:43:09.173-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T17:43:09.174-0300] {processor.py:211} ERROR - Got an exception! Propagating...
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 207, in _run_file_processor
    _handle_dag_file_processing()
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 188, in _handle_dag_file_processing
    result: tuple[int, int, int] = dag_file_processor.process_file(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 942, in process_file
    serialize_errors = DagFileProcessor.save_dag_to_db(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/api_internal/internal_api_call.py", line 139, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 982, in save_dag_to_db
    import_errors = DagBag._sync_to_db(dags=dags, processor_subdir=dag_directory, session=session)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 707, in _sync_to_db
    for attempt in run_with_db_retries(logger=log):
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 443, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 723, in _sync_to_db
    DAG.bulk_write_to_db(dags.values(), processor_subdir=processor_subdir, session=session)
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dag.py", line 3242, in bulk_write_to_db
    orm_dags: list[DagModel] = session.scalars(query).unique().all()
                               ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1778, in scalars
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:46:40.862-0300] {processor.py:186} INFO - Started process (PID=126385) to work on /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T17:46:40.864-0300] {processor.py:914} INFO - Processing file /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py for tasks to queue
[2024-09-08T17:46:40.865-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:46:40.865-0300] {dagbag.py:587} INFO - Filling up the DagBag from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T17:46:40.876-0300] {processor.py:925} INFO - DAG(s) 'dataset_consumes_1_and_2', 'consume_1_or_2_with_dataset_expressions', 'dataset_consumes_1_never_scheduled', 'dataset_consumes_1', 'conditional_dataset_and_time_based_timetable', 'dataset_consumes_unknown_never_scheduled', 'dataset_produces_1', 'dataset_produces_2', 'consume_1_or_both_2_and_3_with_dataset_expressions', 'consume_1_and_2_with_dataset_expressions' retrieved from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T17:46:41.086-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:46:41.086-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T17:46:41.100-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:46:41.100-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_2_with_dataset_expressions
[2024-09-08T17:46:41.101-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:46:41.101-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_never_scheduled
[2024-09-08T17:46:41.102-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:46:41.102-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1
[2024-09-08T17:46:41.103-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:46:41.103-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_both_2_and_3_with_dataset_expressions
[2024-09-08T17:46:41.104-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:46:41.104-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_and_2_with_dataset_expressions
[2024-09-08T17:46:41.105-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:46:41.105-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_and_2
[2024-09-08T17:46:41.106-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:46:41.106-0300] {dag.py:3252} INFO - Creating ORM DAG for conditional_dataset_and_time_based_timetable
[2024-09-08T17:46:41.107-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:46:41.107-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_1
[2024-09-08T17:46:41.108-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:46:41.108-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_2
[2024-09-08T17:46:41.109-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:46:41.109-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_unknown_never_scheduled
[2024-09-08T17:46:41.122-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:46:41.122-0300] {dag.py:4156} INFO - Setting next_dagrun for conditional_dataset_and_time_based_timetable to 2024-09-04 01:00:00+00:00, run_after=2024-09-04 01:00:00+00:00
[2024-09-08T17:46:41.123-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:46:41.123-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_and_2_with_dataset_expressions to None, run_after=None
[2024-09-08T17:46:41.124-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:46:41.124-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_2_with_dataset_expressions to None, run_after=None
[2024-09-08T17:46:41.126-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:46:41.125-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_both_2_and_3_with_dataset_expressions to None, run_after=None
[2024-09-08T17:46:41.127-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:46:41.126-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1 to None, run_after=None
[2024-09-08T17:46:41.129-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:46:41.128-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_and_2 to None, run_after=None
[2024-09-08T17:46:41.130-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:46:41.130-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_never_scheduled to None, run_after=None
[2024-09-08T17:46:41.132-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:46:41.131-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_unknown_never_scheduled to None, run_after=None
[2024-09-08T17:46:41.134-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:46:41.134-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_1 to 2024-09-07 00:00:00+00:00, run_after=2024-09-08 00:00:00+00:00
[2024-09-08T17:46:41.135-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:46:41.134-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_2 to None, run_after=None
[2024-09-08T17:46:41.292-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:46:41.291-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:46:41.294-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:46:41.293-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:46:41.296-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:46:41.295-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:46:41.298-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:46:41.297-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:46:41.299-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:46:41.299-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:46:41.300-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:46:41.300-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:46:41.302-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:46:41.301-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:46:41.303-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:46:41.302-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:46:41.304-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:46:41.303-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:46:41.305-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:46:41.304-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:46:41.305-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:46:41.305-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T17:46:41.306-0300] {processor.py:211} ERROR - Got an exception! Propagating...
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 207, in _run_file_processor
    _handle_dag_file_processing()
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 188, in _handle_dag_file_processing
    result: tuple[int, int, int] = dag_file_processor.process_file(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 942, in process_file
    serialize_errors = DagFileProcessor.save_dag_to_db(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/api_internal/internal_api_call.py", line 139, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 982, in save_dag_to_db
    import_errors = DagBag._sync_to_db(dags=dags, processor_subdir=dag_directory, session=session)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 707, in _sync_to_db
    for attempt in run_with_db_retries(logger=log):
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 443, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 723, in _sync_to_db
    DAG.bulk_write_to_db(dags.values(), processor_subdir=processor_subdir, session=session)
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dag.py", line 3242, in bulk_write_to_db
    orm_dags: list[DagModel] = session.scalars(query).unique().all()
                               ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1778, in scalars
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:51:19.033-0300] {processor.py:186} INFO - Started process (PID=130552) to work on /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T17:51:19.034-0300] {processor.py:914} INFO - Processing file /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py for tasks to queue
[2024-09-08T17:51:19.036-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:51:19.035-0300] {dagbag.py:587} INFO - Filling up the DagBag from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T17:51:19.047-0300] {processor.py:925} INFO - DAG(s) 'conditional_dataset_and_time_based_timetable', 'consume_1_and_2_with_dataset_expressions', 'consume_1_or_2_with_dataset_expressions', 'dataset_consumes_1_never_scheduled', 'dataset_consumes_1', 'dataset_consumes_unknown_never_scheduled', 'dataset_produces_2', 'consume_1_or_both_2_and_3_with_dataset_expressions', 'dataset_consumes_1_and_2', 'dataset_produces_1' retrieved from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T17:51:19.238-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:51:19.238-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T17:51:19.248-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:51:19.247-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_2_with_dataset_expressions
[2024-09-08T17:51:19.249-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:51:19.248-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_never_scheduled
[2024-09-08T17:51:19.249-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:51:19.249-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1
[2024-09-08T17:51:19.250-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:51:19.249-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_and_2_with_dataset_expressions
[2024-09-08T17:51:19.250-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:51:19.250-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_both_2_and_3_with_dataset_expressions
[2024-09-08T17:51:19.250-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:51:19.250-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_2
[2024-09-08T17:51:19.251-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:51:19.251-0300] {dag.py:3252} INFO - Creating ORM DAG for conditional_dataset_and_time_based_timetable
[2024-09-08T17:51:19.251-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:51:19.251-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_and_2
[2024-09-08T17:51:19.252-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:51:19.252-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_1
[2024-09-08T17:51:19.252-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:51:19.252-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_unknown_never_scheduled
[2024-09-08T17:51:19.259-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:51:19.259-0300] {dag.py:4156} INFO - Setting next_dagrun for conditional_dataset_and_time_based_timetable to 2024-09-04 01:00:00+00:00, run_after=2024-09-04 01:00:00+00:00
[2024-09-08T17:51:19.260-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:51:19.260-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_and_2_with_dataset_expressions to None, run_after=None
[2024-09-08T17:51:19.260-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:51:19.260-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_2_with_dataset_expressions to None, run_after=None
[2024-09-08T17:51:19.261-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:51:19.261-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_both_2_and_3_with_dataset_expressions to None, run_after=None
[2024-09-08T17:51:19.261-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:51:19.261-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1 to None, run_after=None
[2024-09-08T17:51:19.262-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:51:19.262-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_and_2 to None, run_after=None
[2024-09-08T17:51:19.262-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:51:19.262-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_never_scheduled to None, run_after=None
[2024-09-08T17:51:19.263-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:51:19.263-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_unknown_never_scheduled to None, run_after=None
[2024-09-08T17:51:19.264-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:51:19.264-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_1 to 2024-09-07 00:00:00+00:00, run_after=2024-09-08 00:00:00+00:00
[2024-09-08T17:51:19.265-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:51:19.265-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_2 to None, run_after=None
[2024-09-08T17:51:19.660-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:51:19.658-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:51:19.661-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:51:19.661-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:51:19.663-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:51:19.662-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:51:19.664-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:51:19.663-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:51:19.665-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:51:19.664-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:51:19.666-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:51:19.666-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:51:19.667-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:51:19.666-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:51:19.668-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:51:19.667-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:51:19.669-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:51:19.668-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:51:19.670-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:51:19.669-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:51:19.670-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:51:19.670-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T17:51:19.671-0300] {processor.py:211} ERROR - Got an exception! Propagating...
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 207, in _run_file_processor
    _handle_dag_file_processing()
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 188, in _handle_dag_file_processing
    result: tuple[int, int, int] = dag_file_processor.process_file(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 942, in process_file
    serialize_errors = DagFileProcessor.save_dag_to_db(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/api_internal/internal_api_call.py", line 139, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 982, in save_dag_to_db
    import_errors = DagBag._sync_to_db(dags=dags, processor_subdir=dag_directory, session=session)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 707, in _sync_to_db
    for attempt in run_with_db_retries(logger=log):
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 443, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 723, in _sync_to_db
    DAG.bulk_write_to_db(dags.values(), processor_subdir=processor_subdir, session=session)
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dag.py", line 3242, in bulk_write_to_db
    orm_dags: list[DagModel] = session.scalars(query).unique().all()
                               ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1778, in scalars
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:55:11.435-0300] {processor.py:186} INFO - Started process (PID=133511) to work on /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T17:55:11.435-0300] {processor.py:914} INFO - Processing file /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py for tasks to queue
[2024-09-08T17:55:11.437-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:55:11.437-0300] {dagbag.py:587} INFO - Filling up the DagBag from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T17:55:11.448-0300] {processor.py:925} INFO - DAG(s) 'consume_1_or_both_2_and_3_with_dataset_expressions', 'consume_1_and_2_with_dataset_expressions', 'dataset_produces_2', 'dataset_consumes_unknown_never_scheduled', 'dataset_produces_1', 'consume_1_or_2_with_dataset_expressions', 'dataset_consumes_1_and_2', 'dataset_consumes_1', 'conditional_dataset_and_time_based_timetable', 'dataset_consumes_1_never_scheduled' retrieved from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T17:55:11.635-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:55:11.635-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T17:55:11.643-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:55:11.643-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_2_with_dataset_expressions
[2024-09-08T17:55:11.644-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:55:11.644-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_never_scheduled
[2024-09-08T17:55:11.644-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:55:11.644-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1
[2024-09-08T17:55:11.645-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:55:11.645-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_both_2_and_3_with_dataset_expressions
[2024-09-08T17:55:11.645-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:55:11.645-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_and_2_with_dataset_expressions
[2024-09-08T17:55:11.645-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:55:11.645-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_2
[2024-09-08T17:55:11.646-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:55:11.646-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_1
[2024-09-08T17:55:11.646-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:55:11.646-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_and_2
[2024-09-08T17:55:11.647-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:55:11.646-0300] {dag.py:3252} INFO - Creating ORM DAG for conditional_dataset_and_time_based_timetable
[2024-09-08T17:55:11.647-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:55:11.647-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_unknown_never_scheduled
[2024-09-08T17:55:11.654-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:55:11.654-0300] {dag.py:4156} INFO - Setting next_dagrun for conditional_dataset_and_time_based_timetable to 2024-09-04 01:00:00+00:00, run_after=2024-09-04 01:00:00+00:00
[2024-09-08T17:55:11.654-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:55:11.654-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_and_2_with_dataset_expressions to None, run_after=None
[2024-09-08T17:55:11.654-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:55:11.654-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_2_with_dataset_expressions to None, run_after=None
[2024-09-08T17:55:11.655-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:55:11.655-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_both_2_and_3_with_dataset_expressions to None, run_after=None
[2024-09-08T17:55:11.655-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:55:11.655-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1 to None, run_after=None
[2024-09-08T17:55:11.655-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:55:11.655-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_and_2 to None, run_after=None
[2024-09-08T17:55:11.656-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:55:11.656-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_never_scheduled to None, run_after=None
[2024-09-08T17:55:11.656-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:55:11.656-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_unknown_never_scheduled to None, run_after=None
[2024-09-08T17:55:11.658-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:55:11.657-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_1 to 2024-09-07 00:00:00+00:00, run_after=2024-09-08 00:00:00+00:00
[2024-09-08T17:55:11.658-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:55:11.658-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_2 to None, run_after=None
[2024-09-08T17:55:11.936-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:55:11.934-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:55:11.938-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:55:11.937-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:55:11.939-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:55:11.938-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:55:11.940-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:55:11.940-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:55:11.941-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:55:11.941-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:55:11.943-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:55:11.942-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:55:11.947-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:55:11.945-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:55:11.949-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:55:11.948-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:55:11.950-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:55:11.950-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:55:11.953-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:55:11.952-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:55:11.955-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:55:11.955-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T17:55:11.956-0300] {processor.py:211} ERROR - Got an exception! Propagating...
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 207, in _run_file_processor
    _handle_dag_file_processing()
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 188, in _handle_dag_file_processing
    result: tuple[int, int, int] = dag_file_processor.process_file(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 942, in process_file
    serialize_errors = DagFileProcessor.save_dag_to_db(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/api_internal/internal_api_call.py", line 139, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 982, in save_dag_to_db
    import_errors = DagBag._sync_to_db(dags=dags, processor_subdir=dag_directory, session=session)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 707, in _sync_to_db
    for attempt in run_with_db_retries(logger=log):
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 443, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 723, in _sync_to_db
    DAG.bulk_write_to_db(dags.values(), processor_subdir=processor_subdir, session=session)
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dag.py", line 3242, in bulk_write_to_db
    orm_dags: list[DagModel] = session.scalars(query).unique().all()
                               ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1778, in scalars
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:58:57.292-0300] {processor.py:186} INFO - Started process (PID=136417) to work on /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T17:58:57.293-0300] {processor.py:914} INFO - Processing file /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py for tasks to queue
[2024-09-08T17:58:57.294-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:58:57.294-0300] {dagbag.py:587} INFO - Filling up the DagBag from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T17:58:57.305-0300] {processor.py:925} INFO - DAG(s) 'conditional_dataset_and_time_based_timetable', 'dataset_consumes_unknown_never_scheduled', 'consume_1_or_2_with_dataset_expressions', 'consume_1_or_both_2_and_3_with_dataset_expressions', 'dataset_produces_2', 'dataset_produces_1', 'dataset_consumes_1', 'consume_1_and_2_with_dataset_expressions', 'dataset_consumes_1_never_scheduled', 'dataset_consumes_1_and_2' retrieved from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T17:58:57.545-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:58:57.544-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T17:58:57.552-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:58:57.552-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_2_with_dataset_expressions
[2024-09-08T17:58:57.553-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:58:57.553-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_never_scheduled
[2024-09-08T17:58:57.553-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:58:57.553-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1
[2024-09-08T17:58:57.553-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:58:57.553-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_both_2_and_3_with_dataset_expressions
[2024-09-08T17:58:57.554-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:58:57.554-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_and_2_with_dataset_expressions
[2024-09-08T17:58:57.554-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:58:57.554-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_2
[2024-09-08T17:58:57.554-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:58:57.554-0300] {dag.py:3252} INFO - Creating ORM DAG for conditional_dataset_and_time_based_timetable
[2024-09-08T17:58:57.555-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:58:57.555-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_1
[2024-09-08T17:58:57.555-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:58:57.555-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_and_2
[2024-09-08T17:58:57.555-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:58:57.555-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_unknown_never_scheduled
[2024-09-08T17:58:57.561-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:58:57.561-0300] {dag.py:4156} INFO - Setting next_dagrun for conditional_dataset_and_time_based_timetable to 2024-09-04 01:00:00+00:00, run_after=2024-09-04 01:00:00+00:00
[2024-09-08T17:58:57.562-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:58:57.562-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_and_2_with_dataset_expressions to None, run_after=None
[2024-09-08T17:58:57.562-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:58:57.562-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_2_with_dataset_expressions to None, run_after=None
[2024-09-08T17:58:57.562-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:58:57.562-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_both_2_and_3_with_dataset_expressions to None, run_after=None
[2024-09-08T17:58:57.563-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:58:57.562-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1 to None, run_after=None
[2024-09-08T17:58:57.563-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:58:57.563-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_and_2 to None, run_after=None
[2024-09-08T17:58:57.563-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:58:57.563-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_never_scheduled to None, run_after=None
[2024-09-08T17:58:57.564-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:58:57.563-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_unknown_never_scheduled to None, run_after=None
[2024-09-08T17:58:57.565-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:58:57.565-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_1 to 2024-09-07 00:00:00+00:00, run_after=2024-09-08 00:00:00+00:00
[2024-09-08T17:58:57.565-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:58:57.565-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_2 to None, run_after=None
[2024-09-08T17:58:57.969-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:58:57.967-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:58:57.970-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:58:57.969-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:58:57.970-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:58:57.970-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:58:57.971-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:58:57.971-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:58:57.972-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:58:57.972-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:58:57.973-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:58:57.973-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:58:57.974-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:58:57.974-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:58:57.975-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:58:57.974-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:58:57.976-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:58:57.975-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:58:57.977-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:58:57.976-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T17:58:57.977-0300] {logging_mixin.py:190} INFO - [2024-09-08T17:58:57.977-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T17:58:57.978-0300] {processor.py:211} ERROR - Got an exception! Propagating...
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 207, in _run_file_processor
    _handle_dag_file_processing()
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 188, in _handle_dag_file_processing
    result: tuple[int, int, int] = dag_file_processor.process_file(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 942, in process_file
    serialize_errors = DagFileProcessor.save_dag_to_db(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/api_internal/internal_api_call.py", line 139, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 982, in save_dag_to_db
    import_errors = DagBag._sync_to_db(dags=dags, processor_subdir=dag_directory, session=session)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 707, in _sync_to_db
    for attempt in run_with_db_retries(logger=log):
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 443, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 723, in _sync_to_db
    DAG.bulk_write_to_db(dags.values(), processor_subdir=processor_subdir, session=session)
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dag.py", line 3242, in bulk_write_to_db
    orm_dags: list[DagModel] = session.scalars(query).unique().all()
                               ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1778, in scalars
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:02:43.244-0300] {processor.py:186} INFO - Started process (PID=139430) to work on /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T18:02:43.245-0300] {processor.py:914} INFO - Processing file /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py for tasks to queue
[2024-09-08T18:02:43.246-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:02:43.246-0300] {dagbag.py:587} INFO - Filling up the DagBag from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T18:02:43.257-0300] {processor.py:925} INFO - DAG(s) 'conditional_dataset_and_time_based_timetable', 'dataset_consumes_1_never_scheduled', 'consume_1_or_both_2_and_3_with_dataset_expressions', 'dataset_consumes_unknown_never_scheduled', 'consume_1_and_2_with_dataset_expressions', 'dataset_produces_2', 'consume_1_or_2_with_dataset_expressions', 'dataset_consumes_1_and_2', 'dataset_produces_1', 'dataset_consumes_1' retrieved from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T18:02:43.517-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:02:43.517-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T18:02:43.524-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:02:43.524-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_2_with_dataset_expressions
[2024-09-08T18:02:43.525-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:02:43.524-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_never_scheduled
[2024-09-08T18:02:43.525-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:02:43.525-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1
[2024-09-08T18:02:43.525-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:02:43.525-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_both_2_and_3_with_dataset_expressions
[2024-09-08T18:02:43.526-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:02:43.525-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_and_2_with_dataset_expressions
[2024-09-08T18:02:43.526-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:02:43.526-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_2
[2024-09-08T18:02:43.526-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:02:43.526-0300] {dag.py:3252} INFO - Creating ORM DAG for conditional_dataset_and_time_based_timetable
[2024-09-08T18:02:43.527-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:02:43.527-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_and_2
[2024-09-08T18:02:43.527-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:02:43.527-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_1
[2024-09-08T18:02:43.527-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:02:43.527-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_unknown_never_scheduled
[2024-09-08T18:02:43.535-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:02:43.535-0300] {dag.py:4156} INFO - Setting next_dagrun for conditional_dataset_and_time_based_timetable to 2024-09-04 01:00:00+00:00, run_after=2024-09-04 01:00:00+00:00
[2024-09-08T18:02:43.536-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:02:43.535-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_and_2_with_dataset_expressions to None, run_after=None
[2024-09-08T18:02:43.536-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:02:43.536-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_2_with_dataset_expressions to None, run_after=None
[2024-09-08T18:02:43.536-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:02:43.536-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_both_2_and_3_with_dataset_expressions to None, run_after=None
[2024-09-08T18:02:43.536-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:02:43.536-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1 to None, run_after=None
[2024-09-08T18:02:43.537-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:02:43.537-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_and_2 to None, run_after=None
[2024-09-08T18:02:43.537-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:02:43.537-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_never_scheduled to None, run_after=None
[2024-09-08T18:02:43.537-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:02:43.537-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_unknown_never_scheduled to None, run_after=None
[2024-09-08T18:02:43.538-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:02:43.538-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_1 to 2024-09-07 00:00:00+00:00, run_after=2024-09-08 00:00:00+00:00
[2024-09-08T18:02:43.539-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:02:43.539-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_2 to None, run_after=None
[2024-09-08T18:02:44.041-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:02:44.040-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:02:44.042-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:02:44.042-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:02:44.043-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:02:44.042-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:02:44.044-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:02:44.043-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:02:44.045-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:02:44.044-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:02:44.045-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:02:44.045-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:02:44.046-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:02:44.046-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:02:44.047-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:02:44.047-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:02:44.048-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:02:44.048-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:02:44.050-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:02:44.049-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:02:44.051-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:02:44.050-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T18:02:44.051-0300] {processor.py:211} ERROR - Got an exception! Propagating...
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 207, in _run_file_processor
    _handle_dag_file_processing()
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 188, in _handle_dag_file_processing
    result: tuple[int, int, int] = dag_file_processor.process_file(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 942, in process_file
    serialize_errors = DagFileProcessor.save_dag_to_db(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/api_internal/internal_api_call.py", line 139, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 982, in save_dag_to_db
    import_errors = DagBag._sync_to_db(dags=dags, processor_subdir=dag_directory, session=session)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 707, in _sync_to_db
    for attempt in run_with_db_retries(logger=log):
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 443, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 723, in _sync_to_db
    DAG.bulk_write_to_db(dags.values(), processor_subdir=processor_subdir, session=session)
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dag.py", line 3242, in bulk_write_to_db
    orm_dags: list[DagModel] = session.scalars(query).unique().all()
                               ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1778, in scalars
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:06:38.424-0300] {processor.py:186} INFO - Started process (PID=142902) to work on /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T18:06:38.425-0300] {processor.py:914} INFO - Processing file /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py for tasks to queue
[2024-09-08T18:06:38.427-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:06:38.427-0300] {dagbag.py:587} INFO - Filling up the DagBag from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T18:06:38.443-0300] {processor.py:925} INFO - DAG(s) 'consume_1_or_both_2_and_3_with_dataset_expressions', 'dataset_consumes_1_never_scheduled', 'dataset_consumes_unknown_never_scheduled', 'consume_1_and_2_with_dataset_expressions', 'dataset_consumes_1_and_2', 'dataset_produces_2', 'dataset_produces_1', 'dataset_consumes_1', 'consume_1_or_2_with_dataset_expressions', 'conditional_dataset_and_time_based_timetable' retrieved from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T18:06:38.863-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:06:38.863-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T18:06:38.875-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:06:38.875-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_2_with_dataset_expressions
[2024-09-08T18:06:38.876-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:06:38.876-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_never_scheduled
[2024-09-08T18:06:38.877-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:06:38.876-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1
[2024-09-08T18:06:38.877-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:06:38.877-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_both_2_and_3_with_dataset_expressions
[2024-09-08T18:06:38.878-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:06:38.878-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_and_2_with_dataset_expressions
[2024-09-08T18:06:38.879-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:06:38.878-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_and_2
[2024-09-08T18:06:38.879-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:06:38.879-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_2
[2024-09-08T18:06:38.880-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:06:38.880-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_1
[2024-09-08T18:06:38.881-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:06:38.880-0300] {dag.py:3252} INFO - Creating ORM DAG for conditional_dataset_and_time_based_timetable
[2024-09-08T18:06:38.881-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:06:38.881-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_unknown_never_scheduled
[2024-09-08T18:06:38.892-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:06:38.892-0300] {dag.py:4156} INFO - Setting next_dagrun for conditional_dataset_and_time_based_timetable to 2024-09-04 01:00:00+00:00, run_after=2024-09-04 01:00:00+00:00
[2024-09-08T18:06:38.893-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:06:38.893-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_and_2_with_dataset_expressions to None, run_after=None
[2024-09-08T18:06:38.894-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:06:38.893-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_2_with_dataset_expressions to None, run_after=None
[2024-09-08T18:06:38.894-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:06:38.894-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_both_2_and_3_with_dataset_expressions to None, run_after=None
[2024-09-08T18:06:38.894-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:06:38.894-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1 to None, run_after=None
[2024-09-08T18:06:38.895-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:06:38.895-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_and_2 to None, run_after=None
[2024-09-08T18:06:38.896-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:06:38.895-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_never_scheduled to None, run_after=None
[2024-09-08T18:06:38.896-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:06:38.896-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_unknown_never_scheduled to None, run_after=None
[2024-09-08T18:06:38.898-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:06:38.898-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_1 to 2024-09-07 00:00:00+00:00, run_after=2024-09-08 00:00:00+00:00
[2024-09-08T18:06:38.899-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:06:38.899-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_2 to None, run_after=None
[2024-09-08T18:06:39.238-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:06:39.235-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:06:39.245-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:06:39.244-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:06:39.252-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:06:39.250-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:06:39.258-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:06:39.256-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:06:39.267-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:06:39.259-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:06:39.270-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:06:39.269-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:06:39.273-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:06:39.272-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:06:39.276-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:06:39.275-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:06:39.279-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:06:39.278-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:06:39.282-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:06:39.281-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:06:39.283-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:06:39.283-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T18:06:39.285-0300] {processor.py:211} ERROR - Got an exception! Propagating...
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 207, in _run_file_processor
    _handle_dag_file_processing()
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 188, in _handle_dag_file_processing
    result: tuple[int, int, int] = dag_file_processor.process_file(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 942, in process_file
    serialize_errors = DagFileProcessor.save_dag_to_db(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/api_internal/internal_api_call.py", line 139, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 982, in save_dag_to_db
    import_errors = DagBag._sync_to_db(dags=dags, processor_subdir=dag_directory, session=session)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 707, in _sync_to_db
    for attempt in run_with_db_retries(logger=log):
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 443, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 723, in _sync_to_db
    DAG.bulk_write_to_db(dags.values(), processor_subdir=processor_subdir, session=session)
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dag.py", line 3242, in bulk_write_to_db
    orm_dags: list[DagModel] = session.scalars(query).unique().all()
                               ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1778, in scalars
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:11:15.595-0300] {processor.py:186} INFO - Started process (PID=147359) to work on /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T18:11:15.596-0300] {processor.py:914} INFO - Processing file /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py for tasks to queue
[2024-09-08T18:11:15.597-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:11:15.597-0300] {dagbag.py:587} INFO - Filling up the DagBag from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T18:11:15.609-0300] {processor.py:925} INFO - DAG(s) 'dataset_consumes_1', 'dataset_consumes_1_and_2', 'conditional_dataset_and_time_based_timetable', 'consume_1_or_both_2_and_3_with_dataset_expressions', 'dataset_consumes_unknown_never_scheduled', 'dataset_consumes_1_never_scheduled', 'consume_1_and_2_with_dataset_expressions', 'dataset_produces_2', 'consume_1_or_2_with_dataset_expressions', 'dataset_produces_1' retrieved from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T18:11:15.941-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:11:15.941-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T18:11:15.954-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:11:15.954-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_2_with_dataset_expressions
[2024-09-08T18:11:15.955-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:11:15.955-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_never_scheduled
[2024-09-08T18:11:15.956-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:11:15.956-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1
[2024-09-08T18:11:15.957-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:11:15.956-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_both_2_and_3_with_dataset_expressions
[2024-09-08T18:11:15.957-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:11:15.957-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_and_2_with_dataset_expressions
[2024-09-08T18:11:15.958-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:11:15.957-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_and_2
[2024-09-08T18:11:15.958-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:11:15.958-0300] {dag.py:3252} INFO - Creating ORM DAG for conditional_dataset_and_time_based_timetable
[2024-09-08T18:11:15.959-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:11:15.959-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_2
[2024-09-08T18:11:15.959-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:11:15.959-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_1
[2024-09-08T18:11:15.960-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:11:15.960-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_unknown_never_scheduled
[2024-09-08T18:11:15.969-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:11:15.969-0300] {dag.py:4156} INFO - Setting next_dagrun for conditional_dataset_and_time_based_timetable to 2024-09-04 01:00:00+00:00, run_after=2024-09-04 01:00:00+00:00
[2024-09-08T18:11:15.970-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:11:15.970-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_and_2_with_dataset_expressions to None, run_after=None
[2024-09-08T18:11:15.970-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:11:15.970-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_2_with_dataset_expressions to None, run_after=None
[2024-09-08T18:11:15.970-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:11:15.970-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_both_2_and_3_with_dataset_expressions to None, run_after=None
[2024-09-08T18:11:15.971-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:11:15.971-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1 to None, run_after=None
[2024-09-08T18:11:15.971-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:11:15.971-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_and_2 to None, run_after=None
[2024-09-08T18:11:15.972-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:11:15.972-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_never_scheduled to None, run_after=None
[2024-09-08T18:11:15.972-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:11:15.972-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_unknown_never_scheduled to None, run_after=None
[2024-09-08T18:11:15.974-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:11:15.974-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_1 to 2024-09-07 00:00:00+00:00, run_after=2024-09-08 00:00:00+00:00
[2024-09-08T18:11:15.975-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:11:15.974-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_2 to None, run_after=None
[2024-09-08T18:11:16.437-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:11:16.435-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:11:16.438-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:11:16.438-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:11:16.439-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:11:16.439-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:11:16.440-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:11:16.440-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:11:16.442-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:11:16.441-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:11:16.443-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:11:16.442-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:11:16.444-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:11:16.444-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:11:16.445-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:11:16.445-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:11:16.446-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:11:16.446-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:11:16.448-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:11:16.447-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:11:16.448-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:11:16.448-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T18:11:16.449-0300] {processor.py:211} ERROR - Got an exception! Propagating...
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 207, in _run_file_processor
    _handle_dag_file_processing()
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 188, in _handle_dag_file_processing
    result: tuple[int, int, int] = dag_file_processor.process_file(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 942, in process_file
    serialize_errors = DagFileProcessor.save_dag_to_db(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/api_internal/internal_api_call.py", line 139, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 982, in save_dag_to_db
    import_errors = DagBag._sync_to_db(dags=dags, processor_subdir=dag_directory, session=session)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 707, in _sync_to_db
    for attempt in run_with_db_retries(logger=log):
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 443, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 723, in _sync_to_db
    DAG.bulk_write_to_db(dags.values(), processor_subdir=processor_subdir, session=session)
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dag.py", line 3242, in bulk_write_to_db
    orm_dags: list[DagModel] = session.scalars(query).unique().all()
                               ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1778, in scalars
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:14:13.628-0300] {processor.py:186} INFO - Started process (PID=149888) to work on /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T18:14:13.629-0300] {processor.py:914} INFO - Processing file /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py for tasks to queue
[2024-09-08T18:14:13.630-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:14:13.630-0300] {dagbag.py:587} INFO - Filling up the DagBag from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T18:14:13.641-0300] {processor.py:925} INFO - DAG(s) 'dataset_produces_1', 'consume_1_and_2_with_dataset_expressions', 'consume_1_or_2_with_dataset_expressions', 'dataset_consumes_1_never_scheduled', 'dataset_consumes_1_and_2', 'dataset_consumes_1', 'dataset_consumes_unknown_never_scheduled', 'conditional_dataset_and_time_based_timetable', 'consume_1_or_both_2_and_3_with_dataset_expressions', 'dataset_produces_2' retrieved from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T18:14:13.898-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:14:13.897-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T18:14:13.905-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:14:13.905-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_2_with_dataset_expressions
[2024-09-08T18:14:13.906-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:14:13.906-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_never_scheduled
[2024-09-08T18:14:13.906-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:14:13.906-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1
[2024-09-08T18:14:13.906-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:14:13.906-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_and_2_with_dataset_expressions
[2024-09-08T18:14:13.907-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:14:13.907-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_both_2_and_3_with_dataset_expressions
[2024-09-08T18:14:13.907-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:14:13.907-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_1
[2024-09-08T18:14:13.908-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:14:13.907-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_and_2
[2024-09-08T18:14:13.908-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:14:13.908-0300] {dag.py:3252} INFO - Creating ORM DAG for conditional_dataset_and_time_based_timetable
[2024-09-08T18:14:13.908-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:14:13.908-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_2
[2024-09-08T18:14:13.909-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:14:13.909-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_unknown_never_scheduled
[2024-09-08T18:14:13.915-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:14:13.915-0300] {dag.py:4156} INFO - Setting next_dagrun for conditional_dataset_and_time_based_timetable to 2024-09-04 01:00:00+00:00, run_after=2024-09-04 01:00:00+00:00
[2024-09-08T18:14:13.916-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:14:13.916-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_and_2_with_dataset_expressions to None, run_after=None
[2024-09-08T18:14:13.916-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:14:13.916-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_2_with_dataset_expressions to None, run_after=None
[2024-09-08T18:14:13.916-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:14:13.916-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_both_2_and_3_with_dataset_expressions to None, run_after=None
[2024-09-08T18:14:13.916-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:14:13.916-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1 to None, run_after=None
[2024-09-08T18:14:13.917-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:14:13.917-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_and_2 to None, run_after=None
[2024-09-08T18:14:13.917-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:14:13.917-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_never_scheduled to None, run_after=None
[2024-09-08T18:14:13.918-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:14:13.917-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_unknown_never_scheduled to None, run_after=None
[2024-09-08T18:14:13.919-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:14:13.919-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_1 to 2024-09-07 00:00:00+00:00, run_after=2024-09-08 00:00:00+00:00
[2024-09-08T18:14:13.919-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:14:13.919-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_2 to None, run_after=None
[2024-09-08T18:14:14.360-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:14:14.359-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:14:14.361-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:14:14.361-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:14:14.362-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:14:14.362-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:14:14.363-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:14:14.363-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:14:14.364-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:14:14.364-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:14:14.365-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:14:14.365-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:14:14.366-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:14:14.366-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:14:14.367-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:14:14.366-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:14:14.368-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:14:14.368-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:14:14.369-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:14:14.369-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:14:14.369-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:14:14.369-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T18:14:14.370-0300] {processor.py:211} ERROR - Got an exception! Propagating...
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 207, in _run_file_processor
    _handle_dag_file_processing()
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 188, in _handle_dag_file_processing
    result: tuple[int, int, int] = dag_file_processor.process_file(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 942, in process_file
    serialize_errors = DagFileProcessor.save_dag_to_db(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/api_internal/internal_api_call.py", line 139, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 982, in save_dag_to_db
    import_errors = DagBag._sync_to_db(dags=dags, processor_subdir=dag_directory, session=session)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 707, in _sync_to_db
    for attempt in run_with_db_retries(logger=log):
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 443, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 723, in _sync_to_db
    DAG.bulk_write_to_db(dags.values(), processor_subdir=processor_subdir, session=session)
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dag.py", line 3242, in bulk_write_to_db
    orm_dags: list[DagModel] = session.scalars(query).unique().all()
                               ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1778, in scalars
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:17:33.263-0300] {processor.py:186} INFO - Started process (PID=152109) to work on /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T18:17:33.264-0300] {processor.py:914} INFO - Processing file /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py for tasks to queue
[2024-09-08T18:17:33.265-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:17:33.265-0300] {dagbag.py:587} INFO - Filling up the DagBag from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T18:17:33.275-0300] {processor.py:925} INFO - DAG(s) 'consume_1_or_both_2_and_3_with_dataset_expressions', 'dataset_produces_2', 'dataset_consumes_1_never_scheduled', 'dataset_consumes_1', 'dataset_consumes_1_and_2', 'dataset_produces_1', 'consume_1_or_2_with_dataset_expressions', 'conditional_dataset_and_time_based_timetable', 'consume_1_and_2_with_dataset_expressions', 'dataset_consumes_unknown_never_scheduled' retrieved from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T18:17:33.550-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:17:33.550-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T18:17:33.557-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:17:33.556-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_2_with_dataset_expressions
[2024-09-08T18:17:33.557-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:17:33.557-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_never_scheduled
[2024-09-08T18:17:33.557-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:17:33.557-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1
[2024-09-08T18:17:33.558-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:17:33.558-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_both_2_and_3_with_dataset_expressions
[2024-09-08T18:17:33.558-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:17:33.558-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_and_2_with_dataset_expressions
[2024-09-08T18:17:33.558-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:17:33.558-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_2
[2024-09-08T18:17:33.559-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:17:33.559-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_and_2
[2024-09-08T18:17:33.559-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:17:33.559-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_1
[2024-09-08T18:17:33.560-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:17:33.559-0300] {dag.py:3252} INFO - Creating ORM DAG for conditional_dataset_and_time_based_timetable
[2024-09-08T18:17:33.560-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:17:33.560-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_unknown_never_scheduled
[2024-09-08T18:17:33.566-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:17:33.566-0300] {dag.py:4156} INFO - Setting next_dagrun for conditional_dataset_and_time_based_timetable to 2024-09-04 01:00:00+00:00, run_after=2024-09-04 01:00:00+00:00
[2024-09-08T18:17:33.566-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:17:33.566-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_and_2_with_dataset_expressions to None, run_after=None
[2024-09-08T18:17:33.566-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:17:33.566-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_2_with_dataset_expressions to None, run_after=None
[2024-09-08T18:17:33.567-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:17:33.567-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_both_2_and_3_with_dataset_expressions to None, run_after=None
[2024-09-08T18:17:33.567-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:17:33.567-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1 to None, run_after=None
[2024-09-08T18:17:33.567-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:17:33.567-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_and_2 to None, run_after=None
[2024-09-08T18:17:33.568-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:17:33.567-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_never_scheduled to None, run_after=None
[2024-09-08T18:17:33.568-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:17:33.568-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_unknown_never_scheduled to None, run_after=None
[2024-09-08T18:17:33.569-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:17:33.569-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_1 to 2024-09-07 00:00:00+00:00, run_after=2024-09-08 00:00:00+00:00
[2024-09-08T18:17:33.569-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:17:33.569-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_2 to None, run_after=None
[2024-09-08T18:17:33.661-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:17:33.659-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:17:33.662-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:17:33.661-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:17:33.663-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:17:33.662-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:17:33.663-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:17:33.663-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:17:33.664-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:17:33.664-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:17:33.665-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:17:33.665-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:17:33.666-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:17:33.666-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:17:33.667-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:17:33.667-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:17:33.668-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:17:33.668-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:17:33.669-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:17:33.668-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:17:33.669-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:17:33.669-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T18:17:33.670-0300] {processor.py:211} ERROR - Got an exception! Propagating...
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 207, in _run_file_processor
    _handle_dag_file_processing()
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 188, in _handle_dag_file_processing
    result: tuple[int, int, int] = dag_file_processor.process_file(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 942, in process_file
    serialize_errors = DagFileProcessor.save_dag_to_db(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/api_internal/internal_api_call.py", line 139, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 982, in save_dag_to_db
    import_errors = DagBag._sync_to_db(dags=dags, processor_subdir=dag_directory, session=session)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 707, in _sync_to_db
    for attempt in run_with_db_retries(logger=log):
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 443, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 723, in _sync_to_db
    DAG.bulk_write_to_db(dags.values(), processor_subdir=processor_subdir, session=session)
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dag.py", line 3242, in bulk_write_to_db
    orm_dags: list[DagModel] = session.scalars(query).unique().all()
                               ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1778, in scalars
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:19:00.221-0300] {processor.py:186} INFO - Started process (PID=152729) to work on /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T18:19:00.222-0300] {processor.py:914} INFO - Processing file /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py for tasks to queue
[2024-09-08T18:19:00.223-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:19:00.223-0300] {dagbag.py:587} INFO - Filling up the DagBag from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T18:19:00.234-0300] {processor.py:925} INFO - DAG(s) 'dataset_consumes_1_and_2', 'consume_1_or_2_with_dataset_expressions', 'dataset_produces_2', 'conditional_dataset_and_time_based_timetable', 'dataset_consumes_unknown_never_scheduled', 'consume_1_or_both_2_and_3_with_dataset_expressions', 'dataset_consumes_1', 'consume_1_and_2_with_dataset_expressions', 'dataset_consumes_1_never_scheduled', 'dataset_produces_1' retrieved from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T18:19:00.468-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:19:00.467-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T18:19:00.474-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:19:00.474-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_2_with_dataset_expressions
[2024-09-08T18:19:00.474-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:19:00.474-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_never_scheduled
[2024-09-08T18:19:00.475-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:19:00.475-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1
[2024-09-08T18:19:00.475-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:19:00.475-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_both_2_and_3_with_dataset_expressions
[2024-09-08T18:19:00.475-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:19:00.475-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_and_2_with_dataset_expressions
[2024-09-08T18:19:00.476-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:19:00.476-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_and_2
[2024-09-08T18:19:00.476-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:19:00.476-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_2
[2024-09-08T18:19:00.476-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:19:00.476-0300] {dag.py:3252} INFO - Creating ORM DAG for conditional_dataset_and_time_based_timetable
[2024-09-08T18:19:00.477-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:19:00.477-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_1
[2024-09-08T18:19:00.477-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:19:00.477-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_unknown_never_scheduled
[2024-09-08T18:19:00.483-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:19:00.483-0300] {dag.py:4156} INFO - Setting next_dagrun for conditional_dataset_and_time_based_timetable to 2024-09-04 01:00:00+00:00, run_after=2024-09-04 01:00:00+00:00
[2024-09-08T18:19:00.484-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:19:00.483-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_and_2_with_dataset_expressions to None, run_after=None
[2024-09-08T18:19:00.484-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:19:00.484-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_2_with_dataset_expressions to None, run_after=None
[2024-09-08T18:19:00.484-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:19:00.484-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_both_2_and_3_with_dataset_expressions to None, run_after=None
[2024-09-08T18:19:00.484-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:19:00.484-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1 to None, run_after=None
[2024-09-08T18:19:00.484-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:19:00.484-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_and_2 to None, run_after=None
[2024-09-08T18:19:00.485-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:19:00.485-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_never_scheduled to None, run_after=None
[2024-09-08T18:19:00.485-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:19:00.485-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_unknown_never_scheduled to None, run_after=None
[2024-09-08T18:19:00.486-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:19:00.486-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_1 to 2024-09-07 00:00:00+00:00, run_after=2024-09-08 00:00:00+00:00
[2024-09-08T18:19:00.486-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:19:00.486-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_2 to None, run_after=None
[2024-09-08T18:19:00.516-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:19:00.515-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:19:00.517-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:19:00.517-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:19:00.518-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:19:00.518-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:19:00.519-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:19:00.518-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:19:00.520-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:19:00.520-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:19:00.521-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:19:00.520-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:19:00.522-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:19:00.521-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:19:00.523-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:19:00.522-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:19:00.524-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:19:00.523-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:19:00.525-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:19:00.524-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:19:00.525-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:19:00.525-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T18:19:00.526-0300] {processor.py:211} ERROR - Got an exception! Propagating...
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 207, in _run_file_processor
    _handle_dag_file_processing()
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 188, in _handle_dag_file_processing
    result: tuple[int, int, int] = dag_file_processor.process_file(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 942, in process_file
    serialize_errors = DagFileProcessor.save_dag_to_db(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/api_internal/internal_api_call.py", line 139, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 982, in save_dag_to_db
    import_errors = DagBag._sync_to_db(dags=dags, processor_subdir=dag_directory, session=session)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 707, in _sync_to_db
    for attempt in run_with_db_retries(logger=log):
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 443, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 723, in _sync_to_db
    DAG.bulk_write_to_db(dags.values(), processor_subdir=processor_subdir, session=session)
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dag.py", line 3242, in bulk_write_to_db
    orm_dags: list[DagModel] = session.scalars(query).unique().all()
                               ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1778, in scalars
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:20:28.046-0300] {processor.py:186} INFO - Started process (PID=153390) to work on /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T18:20:28.047-0300] {processor.py:914} INFO - Processing file /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py for tasks to queue
[2024-09-08T18:20:28.048-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:20:28.048-0300] {dagbag.py:587} INFO - Filling up the DagBag from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T18:20:28.058-0300] {processor.py:925} INFO - DAG(s) 'dataset_consumes_1_and_2', 'consume_1_or_2_with_dataset_expressions', 'dataset_produces_2', 'conditional_dataset_and_time_based_timetable', 'dataset_produces_1', 'dataset_consumes_1_never_scheduled', 'dataset_consumes_unknown_never_scheduled', 'consume_1_and_2_with_dataset_expressions', 'consume_1_or_both_2_and_3_with_dataset_expressions', 'dataset_consumes_1' retrieved from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T18:20:28.291-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:20:28.290-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T18:20:28.297-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:20:28.297-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_2_with_dataset_expressions
[2024-09-08T18:20:28.298-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:20:28.298-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_never_scheduled
[2024-09-08T18:20:28.298-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:20:28.298-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1
[2024-09-08T18:20:28.298-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:20:28.298-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_and_2_with_dataset_expressions
[2024-09-08T18:20:28.299-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:20:28.299-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_both_2_and_3_with_dataset_expressions
[2024-09-08T18:20:28.299-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:20:28.299-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_and_2
[2024-09-08T18:20:28.299-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:20:28.299-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_2
[2024-09-08T18:20:28.300-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:20:28.300-0300] {dag.py:3252} INFO - Creating ORM DAG for conditional_dataset_and_time_based_timetable
[2024-09-08T18:20:28.300-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:20:28.300-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_1
[2024-09-08T18:20:28.300-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:20:28.300-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_unknown_never_scheduled
[2024-09-08T18:20:28.307-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:20:28.307-0300] {dag.py:4156} INFO - Setting next_dagrun for conditional_dataset_and_time_based_timetable to 2024-09-04 01:00:00+00:00, run_after=2024-09-04 01:00:00+00:00
[2024-09-08T18:20:28.307-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:20:28.307-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_and_2_with_dataset_expressions to None, run_after=None
[2024-09-08T18:20:28.307-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:20:28.307-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_2_with_dataset_expressions to None, run_after=None
[2024-09-08T18:20:28.308-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:20:28.308-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_both_2_and_3_with_dataset_expressions to None, run_after=None
[2024-09-08T18:20:28.308-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:20:28.308-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1 to None, run_after=None
[2024-09-08T18:20:28.308-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:20:28.308-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_and_2 to None, run_after=None
[2024-09-08T18:20:28.309-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:20:28.308-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_never_scheduled to None, run_after=None
[2024-09-08T18:20:28.309-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:20:28.309-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_unknown_never_scheduled to None, run_after=None
[2024-09-08T18:20:28.310-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:20:28.310-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_1 to 2024-09-07 00:00:00+00:00, run_after=2024-09-08 00:00:00+00:00
[2024-09-08T18:20:28.310-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:20:28.310-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_2 to None, run_after=None
[2024-09-08T18:20:28.657-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:20:28.655-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:20:28.658-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:20:28.657-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:20:28.659-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:20:28.658-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:20:28.660-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:20:28.659-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:20:28.660-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:20:28.660-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:20:28.661-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:20:28.661-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:20:28.662-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:20:28.662-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:20:28.663-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:20:28.663-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:20:28.664-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:20:28.663-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:20:28.665-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:20:28.664-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:20:28.665-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:20:28.665-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T18:20:28.666-0300] {processor.py:211} ERROR - Got an exception! Propagating...
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 207, in _run_file_processor
    _handle_dag_file_processing()
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 188, in _handle_dag_file_processing
    result: tuple[int, int, int] = dag_file_processor.process_file(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 942, in process_file
    serialize_errors = DagFileProcessor.save_dag_to_db(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/api_internal/internal_api_call.py", line 139, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 982, in save_dag_to_db
    import_errors = DagBag._sync_to_db(dags=dags, processor_subdir=dag_directory, session=session)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 707, in _sync_to_db
    for attempt in run_with_db_retries(logger=log):
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 443, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 723, in _sync_to_db
    DAG.bulk_write_to_db(dags.values(), processor_subdir=processor_subdir, session=session)
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dag.py", line 3242, in bulk_write_to_db
    orm_dags: list[DagModel] = session.scalars(query).unique().all()
                               ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1778, in scalars
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:22:37.253-0300] {processor.py:186} INFO - Started process (PID=154854) to work on /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T18:22:37.254-0300] {processor.py:914} INFO - Processing file /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py for tasks to queue
[2024-09-08T18:22:37.255-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:22:37.254-0300] {dagbag.py:587} INFO - Filling up the DagBag from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T18:22:37.264-0300] {processor.py:925} INFO - DAG(s) 'dataset_consumes_1_never_scheduled', 'dataset_consumes_unknown_never_scheduled', 'dataset_produces_1', 'consume_1_and_2_with_dataset_expressions', 'dataset_produces_2', 'dataset_consumes_1', 'consume_1_or_2_with_dataset_expressions', 'consume_1_or_both_2_and_3_with_dataset_expressions', 'dataset_consumes_1_and_2', 'conditional_dataset_and_time_based_timetable' retrieved from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T18:22:37.492-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:22:37.492-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T18:22:37.499-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:22:37.498-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_2_with_dataset_expressions
[2024-09-08T18:22:37.499-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:22:37.499-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_never_scheduled
[2024-09-08T18:22:37.499-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:22:37.499-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1
[2024-09-08T18:22:37.500-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:22:37.500-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_and_2_with_dataset_expressions
[2024-09-08T18:22:37.500-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:22:37.500-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_both_2_and_3_with_dataset_expressions
[2024-09-08T18:22:37.500-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:22:37.500-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_1
[2024-09-08T18:22:37.501-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:22:37.501-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_2
[2024-09-08T18:22:37.501-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:22:37.501-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_and_2
[2024-09-08T18:22:37.501-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:22:37.501-0300] {dag.py:3252} INFO - Creating ORM DAG for conditional_dataset_and_time_based_timetable
[2024-09-08T18:22:37.502-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:22:37.502-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_unknown_never_scheduled
[2024-09-08T18:22:37.507-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:22:37.507-0300] {dag.py:4156} INFO - Setting next_dagrun for conditional_dataset_and_time_based_timetable to 2024-09-04 01:00:00+00:00, run_after=2024-09-04 01:00:00+00:00
[2024-09-08T18:22:37.508-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:22:37.508-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_and_2_with_dataset_expressions to None, run_after=None
[2024-09-08T18:22:37.508-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:22:37.508-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_2_with_dataset_expressions to None, run_after=None
[2024-09-08T18:22:37.508-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:22:37.508-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_both_2_and_3_with_dataset_expressions to None, run_after=None
[2024-09-08T18:22:37.509-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:22:37.508-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1 to None, run_after=None
[2024-09-08T18:22:37.509-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:22:37.509-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_and_2 to None, run_after=None
[2024-09-08T18:22:37.509-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:22:37.509-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_never_scheduled to None, run_after=None
[2024-09-08T18:22:37.510-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:22:37.509-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_unknown_never_scheduled to None, run_after=None
[2024-09-08T18:22:37.511-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:22:37.511-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_1 to 2024-09-07 00:00:00+00:00, run_after=2024-09-08 00:00:00+00:00
[2024-09-08T18:22:37.511-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:22:37.511-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_2 to None, run_after=None
[2024-09-08T18:22:37.879-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:22:37.877-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:22:37.880-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:22:37.880-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:22:37.882-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:22:37.881-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:22:37.884-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:22:37.883-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:22:37.884-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:22:37.884-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:22:37.886-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:22:37.885-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:22:37.886-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:22:37.886-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:22:37.887-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:22:37.887-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:22:37.888-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:22:37.888-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:22:37.889-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:22:37.889-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:22:37.890-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:22:37.890-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T18:22:37.891-0300] {processor.py:211} ERROR - Got an exception! Propagating...
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 207, in _run_file_processor
    _handle_dag_file_processing()
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 188, in _handle_dag_file_processing
    result: tuple[int, int, int] = dag_file_processor.process_file(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 942, in process_file
    serialize_errors = DagFileProcessor.save_dag_to_db(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/api_internal/internal_api_call.py", line 139, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 982, in save_dag_to_db
    import_errors = DagBag._sync_to_db(dags=dags, processor_subdir=dag_directory, session=session)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 707, in _sync_to_db
    for attempt in run_with_db_retries(logger=log):
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 443, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 723, in _sync_to_db
    DAG.bulk_write_to_db(dags.values(), processor_subdir=processor_subdir, session=session)
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dag.py", line 3242, in bulk_write_to_db
    orm_dags: list[DagModel] = session.scalars(query).unique().all()
                               ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1778, in scalars
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:24:18.214-0300] {processor.py:186} INFO - Started process (PID=156173) to work on /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T18:24:18.215-0300] {processor.py:914} INFO - Processing file /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py for tasks to queue
[2024-09-08T18:24:18.216-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:24:18.215-0300] {dagbag.py:587} INFO - Filling up the DagBag from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T18:24:18.229-0300] {processor.py:925} INFO - DAG(s) 'conditional_dataset_and_time_based_timetable', 'dataset_consumes_1_and_2', 'consume_1_or_2_with_dataset_expressions', 'dataset_consumes_unknown_never_scheduled', 'dataset_produces_1', 'dataset_produces_2', 'consume_1_and_2_with_dataset_expressions', 'dataset_consumes_1', 'dataset_consumes_1_never_scheduled', 'consume_1_or_both_2_and_3_with_dataset_expressions' retrieved from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T18:24:18.502-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:24:18.502-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T18:24:18.509-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:24:18.509-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_2_with_dataset_expressions
[2024-09-08T18:24:18.510-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:24:18.510-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_never_scheduled
[2024-09-08T18:24:18.511-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:24:18.510-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1
[2024-09-08T18:24:18.511-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:24:18.511-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_and_2_with_dataset_expressions
[2024-09-08T18:24:18.511-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:24:18.511-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_both_2_and_3_with_dataset_expressions
[2024-09-08T18:24:18.512-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:24:18.512-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_and_2
[2024-09-08T18:24:18.512-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:24:18.512-0300] {dag.py:3252} INFO - Creating ORM DAG for conditional_dataset_and_time_based_timetable
[2024-09-08T18:24:18.513-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:24:18.513-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_1
[2024-09-08T18:24:18.514-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:24:18.514-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_2
[2024-09-08T18:24:18.514-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:24:18.514-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_unknown_never_scheduled
[2024-09-08T18:24:18.521-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:24:18.521-0300] {dag.py:4156} INFO - Setting next_dagrun for conditional_dataset_and_time_based_timetable to 2024-09-04 01:00:00+00:00, run_after=2024-09-04 01:00:00+00:00
[2024-09-08T18:24:18.521-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:24:18.521-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_and_2_with_dataset_expressions to None, run_after=None
[2024-09-08T18:24:18.522-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:24:18.522-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_2_with_dataset_expressions to None, run_after=None
[2024-09-08T18:24:18.522-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:24:18.522-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_both_2_and_3_with_dataset_expressions to None, run_after=None
[2024-09-08T18:24:18.522-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:24:18.522-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1 to None, run_after=None
[2024-09-08T18:24:18.522-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:24:18.522-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_and_2 to None, run_after=None
[2024-09-08T18:24:18.523-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:24:18.523-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_never_scheduled to None, run_after=None
[2024-09-08T18:24:18.523-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:24:18.523-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_unknown_never_scheduled to None, run_after=None
[2024-09-08T18:24:18.524-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:24:18.524-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_1 to 2024-09-07 00:00:00+00:00, run_after=2024-09-08 00:00:00+00:00
[2024-09-08T18:24:18.525-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:24:18.525-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_2 to None, run_after=None
[2024-09-08T18:24:18.819-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:24:18.817-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:24:18.820-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:24:18.820-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:24:18.822-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:24:18.821-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:24:18.823-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:24:18.822-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:24:18.824-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:24:18.823-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:24:18.824-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:24:18.824-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:24:18.826-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:24:18.825-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:24:18.827-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:24:18.827-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:24:18.829-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:24:18.828-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:24:18.830-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:24:18.830-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:24:18.830-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:24:18.830-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T18:24:18.831-0300] {processor.py:211} ERROR - Got an exception! Propagating...
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 207, in _run_file_processor
    _handle_dag_file_processing()
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 188, in _handle_dag_file_processing
    result: tuple[int, int, int] = dag_file_processor.process_file(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 942, in process_file
    serialize_errors = DagFileProcessor.save_dag_to_db(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/api_internal/internal_api_call.py", line 139, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 982, in save_dag_to_db
    import_errors = DagBag._sync_to_db(dags=dags, processor_subdir=dag_directory, session=session)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 707, in _sync_to_db
    for attempt in run_with_db_retries(logger=log):
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 443, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 723, in _sync_to_db
    DAG.bulk_write_to_db(dags.values(), processor_subdir=processor_subdir, session=session)
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dag.py", line 3242, in bulk_write_to_db
    orm_dags: list[DagModel] = session.scalars(query).unique().all()
                               ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1778, in scalars
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:25:54.934-0300] {processor.py:186} INFO - Started process (PID=156886) to work on /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T18:25:54.935-0300] {processor.py:914} INFO - Processing file /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py for tasks to queue
[2024-09-08T18:25:54.936-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:25:54.935-0300] {dagbag.py:587} INFO - Filling up the DagBag from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T18:25:54.946-0300] {processor.py:925} INFO - DAG(s) 'dataset_consumes_unknown_never_scheduled', 'consume_1_or_both_2_and_3_with_dataset_expressions', 'dataset_produces_1', 'dataset_consumes_1', 'conditional_dataset_and_time_based_timetable', 'dataset_consumes_1_and_2', 'dataset_produces_2', 'dataset_consumes_1_never_scheduled', 'consume_1_and_2_with_dataset_expressions', 'consume_1_or_2_with_dataset_expressions' retrieved from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T18:25:55.193-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:25:55.193-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T18:25:55.201-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:25:55.201-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_2_with_dataset_expressions
[2024-09-08T18:25:55.202-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:25:55.202-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_never_scheduled
[2024-09-08T18:25:55.202-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:25:55.202-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1
[2024-09-08T18:25:55.203-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:25:55.202-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_both_2_and_3_with_dataset_expressions
[2024-09-08T18:25:55.203-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:25:55.203-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_and_2_with_dataset_expressions
[2024-09-08T18:25:55.203-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:25:55.203-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_1
[2024-09-08T18:25:55.204-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:25:55.204-0300] {dag.py:3252} INFO - Creating ORM DAG for conditional_dataset_and_time_based_timetable
[2024-09-08T18:25:55.204-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:25:55.204-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_and_2
[2024-09-08T18:25:55.204-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:25:55.204-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_2
[2024-09-08T18:25:55.205-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:25:55.205-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_unknown_never_scheduled
[2024-09-08T18:25:55.212-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:25:55.211-0300] {dag.py:4156} INFO - Setting next_dagrun for conditional_dataset_and_time_based_timetable to 2024-09-04 01:00:00+00:00, run_after=2024-09-04 01:00:00+00:00
[2024-09-08T18:25:55.212-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:25:55.212-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_and_2_with_dataset_expressions to None, run_after=None
[2024-09-08T18:25:55.212-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:25:55.212-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_2_with_dataset_expressions to None, run_after=None
[2024-09-08T18:25:55.212-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:25:55.212-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_both_2_and_3_with_dataset_expressions to None, run_after=None
[2024-09-08T18:25:55.213-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:25:55.213-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1 to None, run_after=None
[2024-09-08T18:25:55.213-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:25:55.213-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_and_2 to None, run_after=None
[2024-09-08T18:25:55.213-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:25:55.213-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_never_scheduled to None, run_after=None
[2024-09-08T18:25:55.214-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:25:55.214-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_unknown_never_scheduled to None, run_after=None
[2024-09-08T18:25:55.215-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:25:55.215-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_1 to 2024-09-07 00:00:00+00:00, run_after=2024-09-08 00:00:00+00:00
[2024-09-08T18:25:55.215-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:25:55.215-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_2 to None, run_after=None
[2024-09-08T18:25:55.509-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:25:55.508-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:25:55.510-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:25:55.510-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:25:55.512-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:25:55.511-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:25:55.516-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:25:55.515-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:25:55.519-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:25:55.518-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:25:55.521-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:25:55.520-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:25:55.524-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:25:55.523-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:25:55.526-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:25:55.525-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:25:55.528-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:25:55.527-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:25:55.531-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:25:55.530-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:25:55.533-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:25:55.532-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T18:25:55.534-0300] {processor.py:211} ERROR - Got an exception! Propagating...
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 207, in _run_file_processor
    _handle_dag_file_processing()
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 188, in _handle_dag_file_processing
    result: tuple[int, int, int] = dag_file_processor.process_file(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 942, in process_file
    serialize_errors = DagFileProcessor.save_dag_to_db(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/api_internal/internal_api_call.py", line 139, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 982, in save_dag_to_db
    import_errors = DagBag._sync_to_db(dags=dags, processor_subdir=dag_directory, session=session)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 707, in _sync_to_db
    for attempt in run_with_db_retries(logger=log):
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 443, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 723, in _sync_to_db
    DAG.bulk_write_to_db(dags.values(), processor_subdir=processor_subdir, session=session)
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dag.py", line 3242, in bulk_write_to_db
    orm_dags: list[DagModel] = session.scalars(query).unique().all()
                               ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1778, in scalars
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:28:57.217-0300] {processor.py:186} INFO - Started process (PID=159056) to work on /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T18:28:57.218-0300] {processor.py:914} INFO - Processing file /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py for tasks to queue
[2024-09-08T18:28:57.220-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:28:57.219-0300] {dagbag.py:587} INFO - Filling up the DagBag from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T18:28:57.235-0300] {processor.py:925} INFO - DAG(s) 'dataset_consumes_1_and_2', 'dataset_produces_1', 'dataset_consumes_unknown_never_scheduled', 'dataset_produces_2', 'conditional_dataset_and_time_based_timetable', 'dataset_consumes_1', 'consume_1_or_both_2_and_3_with_dataset_expressions', 'dataset_consumes_1_never_scheduled', 'consume_1_or_2_with_dataset_expressions', 'consume_1_and_2_with_dataset_expressions' retrieved from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T18:28:57.403-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:28:57.403-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T18:28:57.412-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:28:57.412-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_2_with_dataset_expressions
[2024-09-08T18:28:57.412-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:28:57.412-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_never_scheduled
[2024-09-08T18:28:57.413-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:28:57.412-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1
[2024-09-08T18:28:57.413-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:28:57.413-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_both_2_and_3_with_dataset_expressions
[2024-09-08T18:28:57.414-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:28:57.414-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_and_2_with_dataset_expressions
[2024-09-08T18:28:57.414-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:28:57.414-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_and_2
[2024-09-08T18:28:57.416-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:28:57.415-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_1
[2024-09-08T18:28:57.416-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:28:57.416-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_2
[2024-09-08T18:28:57.417-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:28:57.416-0300] {dag.py:3252} INFO - Creating ORM DAG for conditional_dataset_and_time_based_timetable
[2024-09-08T18:28:57.417-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:28:57.417-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_unknown_never_scheduled
[2024-09-08T18:28:57.424-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:28:57.424-0300] {dag.py:4156} INFO - Setting next_dagrun for conditional_dataset_and_time_based_timetable to 2024-09-04 01:00:00+00:00, run_after=2024-09-04 01:00:00+00:00
[2024-09-08T18:28:57.424-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:28:57.424-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_and_2_with_dataset_expressions to None, run_after=None
[2024-09-08T18:28:57.425-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:28:57.424-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_2_with_dataset_expressions to None, run_after=None
[2024-09-08T18:28:57.425-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:28:57.425-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_both_2_and_3_with_dataset_expressions to None, run_after=None
[2024-09-08T18:28:57.425-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:28:57.425-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1 to None, run_after=None
[2024-09-08T18:28:57.425-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:28:57.425-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_and_2 to None, run_after=None
[2024-09-08T18:28:57.426-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:28:57.426-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_never_scheduled to None, run_after=None
[2024-09-08T18:28:57.426-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:28:57.426-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_unknown_never_scheduled to None, run_after=None
[2024-09-08T18:28:57.427-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:28:57.427-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_1 to 2024-09-07 00:00:00+00:00, run_after=2024-09-08 00:00:00+00:00
[2024-09-08T18:28:57.428-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:28:57.428-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_2 to None, run_after=None
[2024-09-08T18:28:57.451-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:28:57.449-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:28:57.452-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:28:57.451-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:28:57.453-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:28:57.452-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:28:57.454-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:28:57.453-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:28:57.455-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:28:57.454-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:28:57.456-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:28:57.455-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:28:57.457-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:28:57.456-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:28:57.458-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:28:57.457-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:28:57.459-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:28:57.458-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:28:57.460-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:28:57.459-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:28:57.460-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:28:57.460-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T18:28:57.461-0300] {processor.py:211} ERROR - Got an exception! Propagating...
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 207, in _run_file_processor
    _handle_dag_file_processing()
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 188, in _handle_dag_file_processing
    result: tuple[int, int, int] = dag_file_processor.process_file(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 942, in process_file
    serialize_errors = DagFileProcessor.save_dag_to_db(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/api_internal/internal_api_call.py", line 139, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 982, in save_dag_to_db
    import_errors = DagBag._sync_to_db(dags=dags, processor_subdir=dag_directory, session=session)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 707, in _sync_to_db
    for attempt in run_with_db_retries(logger=log):
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 443, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 723, in _sync_to_db
    DAG.bulk_write_to_db(dags.values(), processor_subdir=processor_subdir, session=session)
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dag.py", line 3242, in bulk_write_to_db
    orm_dags: list[DagModel] = session.scalars(query).unique().all()
                               ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1778, in scalars
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:30:28.037-0300] {processor.py:186} INFO - Started process (PID=159953) to work on /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T18:30:28.038-0300] {processor.py:914} INFO - Processing file /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py for tasks to queue
[2024-09-08T18:30:28.039-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:30:28.039-0300] {dagbag.py:587} INFO - Filling up the DagBag from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T18:30:28.050-0300] {processor.py:925} INFO - DAG(s) 'dataset_consumes_unknown_never_scheduled', 'dataset_consumes_1_never_scheduled', 'conditional_dataset_and_time_based_timetable', 'dataset_consumes_1', 'dataset_consumes_1_and_2', 'dataset_produces_2', 'consume_1_or_both_2_and_3_with_dataset_expressions', 'consume_1_and_2_with_dataset_expressions', 'consume_1_or_2_with_dataset_expressions', 'dataset_produces_1' retrieved from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T18:30:28.214-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:30:28.214-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T18:30:28.223-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:30:28.222-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_2_with_dataset_expressions
[2024-09-08T18:30:28.223-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:30:28.223-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_never_scheduled
[2024-09-08T18:30:28.223-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:30:28.223-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1
[2024-09-08T18:30:28.224-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:30:28.224-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_both_2_and_3_with_dataset_expressions
[2024-09-08T18:30:28.224-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:30:28.224-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_and_2_with_dataset_expressions
[2024-09-08T18:30:28.224-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:30:28.224-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_and_2
[2024-09-08T18:30:28.225-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:30:28.225-0300] {dag.py:3252} INFO - Creating ORM DAG for conditional_dataset_and_time_based_timetable
[2024-09-08T18:30:28.225-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:30:28.225-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_2
[2024-09-08T18:30:28.226-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:30:28.225-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_1
[2024-09-08T18:30:28.226-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:30:28.226-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_unknown_never_scheduled
[2024-09-08T18:30:28.234-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:30:28.234-0300] {dag.py:4156} INFO - Setting next_dagrun for conditional_dataset_and_time_based_timetable to 2024-09-04 01:00:00+00:00, run_after=2024-09-04 01:00:00+00:00
[2024-09-08T18:30:28.235-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:30:28.235-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_and_2_with_dataset_expressions to None, run_after=None
[2024-09-08T18:30:28.235-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:30:28.235-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_2_with_dataset_expressions to None, run_after=None
[2024-09-08T18:30:28.235-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:30:28.235-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_both_2_and_3_with_dataset_expressions to None, run_after=None
[2024-09-08T18:30:28.236-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:30:28.236-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1 to None, run_after=None
[2024-09-08T18:30:28.236-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:30:28.236-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_and_2 to None, run_after=None
[2024-09-08T18:30:28.236-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:30:28.236-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_never_scheduled to None, run_after=None
[2024-09-08T18:30:28.237-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:30:28.237-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_unknown_never_scheduled to None, run_after=None
[2024-09-08T18:30:28.238-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:30:28.238-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_1 to 2024-09-07 00:00:00+00:00, run_after=2024-09-08 00:00:00+00:00
[2024-09-08T18:30:28.239-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:30:28.238-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_2 to None, run_after=None
[2024-09-08T18:30:28.605-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:30:28.604-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:30:28.606-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:30:28.606-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:30:28.607-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:30:28.607-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:30:28.608-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:30:28.608-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:30:28.609-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:30:28.609-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:30:28.610-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:30:28.610-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:30:28.611-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:30:28.611-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:30:28.612-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:30:28.611-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:30:28.613-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:30:28.612-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:30:28.614-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:30:28.613-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:30:28.614-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:30:28.614-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T18:30:28.615-0300] {processor.py:211} ERROR - Got an exception! Propagating...
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 207, in _run_file_processor
    _handle_dag_file_processing()
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 188, in _handle_dag_file_processing
    result: tuple[int, int, int] = dag_file_processor.process_file(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 942, in process_file
    serialize_errors = DagFileProcessor.save_dag_to_db(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/api_internal/internal_api_call.py", line 139, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 982, in save_dag_to_db
    import_errors = DagBag._sync_to_db(dags=dags, processor_subdir=dag_directory, session=session)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 707, in _sync_to_db
    for attempt in run_with_db_retries(logger=log):
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 443, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 723, in _sync_to_db
    DAG.bulk_write_to_db(dags.values(), processor_subdir=processor_subdir, session=session)
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dag.py", line 3242, in bulk_write_to_db
    orm_dags: list[DagModel] = session.scalars(query).unique().all()
                               ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1778, in scalars
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:31:57.136-0300] {processor.py:186} INFO - Started process (PID=160671) to work on /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T18:31:57.137-0300] {processor.py:914} INFO - Processing file /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py for tasks to queue
[2024-09-08T18:31:57.138-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:31:57.138-0300] {dagbag.py:587} INFO - Filling up the DagBag from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T18:31:57.149-0300] {processor.py:925} INFO - DAG(s) 'dataset_consumes_1_never_scheduled', 'dataset_produces_1', 'dataset_produces_2', 'conditional_dataset_and_time_based_timetable', 'consume_1_or_2_with_dataset_expressions', 'dataset_consumes_unknown_never_scheduled', 'dataset_consumes_1', 'dataset_consumes_1_and_2', 'consume_1_and_2_with_dataset_expressions', 'consume_1_or_both_2_and_3_with_dataset_expressions' retrieved from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T18:31:57.313-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:31:57.312-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T18:31:57.322-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:31:57.322-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_2_with_dataset_expressions
[2024-09-08T18:31:57.322-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:31:57.322-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_never_scheduled
[2024-09-08T18:31:57.323-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:31:57.323-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1
[2024-09-08T18:31:57.323-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:31:57.323-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_and_2_with_dataset_expressions
[2024-09-08T18:31:57.324-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:31:57.323-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_both_2_and_3_with_dataset_expressions
[2024-09-08T18:31:57.324-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:31:57.324-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_1
[2024-09-08T18:31:57.325-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:31:57.324-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_2
[2024-09-08T18:31:57.325-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:31:57.325-0300] {dag.py:3252} INFO - Creating ORM DAG for conditional_dataset_and_time_based_timetable
[2024-09-08T18:31:57.326-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:31:57.325-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_and_2
[2024-09-08T18:31:57.326-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:31:57.326-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_unknown_never_scheduled
[2024-09-08T18:31:57.334-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:31:57.334-0300] {dag.py:4156} INFO - Setting next_dagrun for conditional_dataset_and_time_based_timetable to 2024-09-04 01:00:00+00:00, run_after=2024-09-04 01:00:00+00:00
[2024-09-08T18:31:57.335-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:31:57.334-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_and_2_with_dataset_expressions to None, run_after=None
[2024-09-08T18:31:57.335-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:31:57.335-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_2_with_dataset_expressions to None, run_after=None
[2024-09-08T18:31:57.335-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:31:57.335-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_both_2_and_3_with_dataset_expressions to None, run_after=None
[2024-09-08T18:31:57.335-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:31:57.335-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1 to None, run_after=None
[2024-09-08T18:31:57.336-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:31:57.336-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_and_2 to None, run_after=None
[2024-09-08T18:31:57.336-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:31:57.336-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_never_scheduled to None, run_after=None
[2024-09-08T18:31:57.336-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:31:57.336-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_unknown_never_scheduled to None, run_after=None
[2024-09-08T18:31:57.338-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:31:57.338-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_1 to 2024-09-07 00:00:00+00:00, run_after=2024-09-08 00:00:00+00:00
[2024-09-08T18:31:57.338-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:31:57.338-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_2 to None, run_after=None
[2024-09-08T18:31:57.517-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:31:57.515-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:31:57.518-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:31:57.517-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:31:57.519-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:31:57.519-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:31:57.520-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:31:57.520-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:31:57.521-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:31:57.521-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:31:57.522-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:31:57.521-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:31:57.523-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:31:57.522-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:31:57.524-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:31:57.523-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:31:57.525-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:31:57.524-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:31:57.525-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:31:57.525-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:31:57.526-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:31:57.526-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T18:31:57.527-0300] {processor.py:211} ERROR - Got an exception! Propagating...
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 207, in _run_file_processor
    _handle_dag_file_processing()
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 188, in _handle_dag_file_processing
    result: tuple[int, int, int] = dag_file_processor.process_file(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 942, in process_file
    serialize_errors = DagFileProcessor.save_dag_to_db(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/api_internal/internal_api_call.py", line 139, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 982, in save_dag_to_db
    import_errors = DagBag._sync_to_db(dags=dags, processor_subdir=dag_directory, session=session)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 707, in _sync_to_db
    for attempt in run_with_db_retries(logger=log):
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 443, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 723, in _sync_to_db
    DAG.bulk_write_to_db(dags.values(), processor_subdir=processor_subdir, session=session)
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dag.py", line 3242, in bulk_write_to_db
    orm_dags: list[DagModel] = session.scalars(query).unique().all()
                               ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1778, in scalars
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:33:57.650-0300] {processor.py:186} INFO - Started process (PID=161815) to work on /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T18:33:57.651-0300] {processor.py:914} INFO - Processing file /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py for tasks to queue
[2024-09-08T18:33:57.652-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:33:57.651-0300] {dagbag.py:587} INFO - Filling up the DagBag from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T18:33:57.662-0300] {processor.py:925} INFO - DAG(s) 'dataset_produces_1', 'dataset_produces_2', 'dataset_consumes_1_never_scheduled', 'dataset_consumes_1_and_2', 'consume_1_and_2_with_dataset_expressions', 'conditional_dataset_and_time_based_timetable', 'consume_1_or_2_with_dataset_expressions', 'consume_1_or_both_2_and_3_with_dataset_expressions', 'dataset_consumes_1', 'dataset_consumes_unknown_never_scheduled' retrieved from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T18:33:57.824-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:33:57.824-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T18:33:57.832-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:33:57.832-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_2_with_dataset_expressions
[2024-09-08T18:33:57.832-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:33:57.832-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_never_scheduled
[2024-09-08T18:33:57.833-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:33:57.833-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1
[2024-09-08T18:33:57.833-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:33:57.833-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_and_2_with_dataset_expressions
[2024-09-08T18:33:57.834-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:33:57.833-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_both_2_and_3_with_dataset_expressions
[2024-09-08T18:33:57.834-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:33:57.834-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_1
[2024-09-08T18:33:57.834-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:33:57.834-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_2
[2024-09-08T18:33:57.835-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:33:57.835-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_and_2
[2024-09-08T18:33:57.835-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:33:57.835-0300] {dag.py:3252} INFO - Creating ORM DAG for conditional_dataset_and_time_based_timetable
[2024-09-08T18:33:57.835-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:33:57.835-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_unknown_never_scheduled
[2024-09-08T18:33:57.842-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:33:57.842-0300] {dag.py:4156} INFO - Setting next_dagrun for conditional_dataset_and_time_based_timetable to 2024-09-04 01:00:00+00:00, run_after=2024-09-04 01:00:00+00:00
[2024-09-08T18:33:57.843-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:33:57.843-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_and_2_with_dataset_expressions to None, run_after=None
[2024-09-08T18:33:57.843-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:33:57.843-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_2_with_dataset_expressions to None, run_after=None
[2024-09-08T18:33:57.843-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:33:57.843-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_both_2_and_3_with_dataset_expressions to None, run_after=None
[2024-09-08T18:33:57.843-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:33:57.843-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1 to None, run_after=None
[2024-09-08T18:33:57.844-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:33:57.844-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_and_2 to None, run_after=None
[2024-09-08T18:33:57.844-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:33:57.844-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_never_scheduled to None, run_after=None
[2024-09-08T18:33:57.844-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:33:57.844-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_unknown_never_scheduled to None, run_after=None
[2024-09-08T18:33:57.846-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:33:57.846-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_1 to 2024-09-07 00:00:00+00:00, run_after=2024-09-08 00:00:00+00:00
[2024-09-08T18:33:57.846-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:33:57.846-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_2 to None, run_after=None
[2024-09-08T18:33:57.946-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:33:57.945-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:33:57.947-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:33:57.947-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:33:57.949-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:33:57.948-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:33:57.950-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:33:57.949-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:33:57.951-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:33:57.950-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:33:57.951-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:33:57.951-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:33:57.952-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:33:57.952-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:33:57.953-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:33:57.953-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:33:57.954-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:33:57.954-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:33:57.955-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:33:57.955-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:33:57.956-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:33:57.955-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T18:33:57.956-0300] {processor.py:211} ERROR - Got an exception! Propagating...
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 207, in _run_file_processor
    _handle_dag_file_processing()
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 188, in _handle_dag_file_processing
    result: tuple[int, int, int] = dag_file_processor.process_file(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 942, in process_file
    serialize_errors = DagFileProcessor.save_dag_to_db(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/api_internal/internal_api_call.py", line 139, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 982, in save_dag_to_db
    import_errors = DagBag._sync_to_db(dags=dags, processor_subdir=dag_directory, session=session)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 707, in _sync_to_db
    for attempt in run_with_db_retries(logger=log):
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 443, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 723, in _sync_to_db
    DAG.bulk_write_to_db(dags.values(), processor_subdir=processor_subdir, session=session)
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dag.py", line 3242, in bulk_write_to_db
    orm_dags: list[DagModel] = session.scalars(query).unique().all()
                               ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1778, in scalars
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:35:16.378-0300] {processor.py:186} INFO - Started process (PID=162374) to work on /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T18:35:16.379-0300] {processor.py:914} INFO - Processing file /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py for tasks to queue
[2024-09-08T18:35:16.380-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:35:16.380-0300] {dagbag.py:587} INFO - Filling up the DagBag from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T18:35:16.390-0300] {processor.py:925} INFO - DAG(s) 'consume_1_or_2_with_dataset_expressions', 'dataset_consumes_1_and_2', 'dataset_produces_1', 'consume_1_or_both_2_and_3_with_dataset_expressions', 'dataset_consumes_unknown_never_scheduled', 'consume_1_and_2_with_dataset_expressions', 'dataset_consumes_1', 'dataset_consumes_1_never_scheduled', 'dataset_produces_2', 'conditional_dataset_and_time_based_timetable' retrieved from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T18:35:16.550-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:35:16.550-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T18:35:16.558-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:35:16.558-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_2_with_dataset_expressions
[2024-09-08T18:35:16.559-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:35:16.558-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_never_scheduled
[2024-09-08T18:35:16.559-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:35:16.559-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1
[2024-09-08T18:35:16.559-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:35:16.559-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_both_2_and_3_with_dataset_expressions
[2024-09-08T18:35:16.560-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:35:16.560-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_and_2_with_dataset_expressions
[2024-09-08T18:35:16.560-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:35:16.560-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_and_2
[2024-09-08T18:35:16.560-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:35:16.560-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_1
[2024-09-08T18:35:16.561-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:35:16.561-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_2
[2024-09-08T18:35:16.561-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:35:16.561-0300] {dag.py:3252} INFO - Creating ORM DAG for conditional_dataset_and_time_based_timetable
[2024-09-08T18:35:16.561-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:35:16.561-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_unknown_never_scheduled
[2024-09-08T18:35:16.567-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:35:16.567-0300] {dag.py:4156} INFO - Setting next_dagrun for conditional_dataset_and_time_based_timetable to 2024-09-04 01:00:00+00:00, run_after=2024-09-04 01:00:00+00:00
[2024-09-08T18:35:16.568-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:35:16.568-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_and_2_with_dataset_expressions to None, run_after=None
[2024-09-08T18:35:16.568-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:35:16.568-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_2_with_dataset_expressions to None, run_after=None
[2024-09-08T18:35:16.568-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:35:16.568-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_both_2_and_3_with_dataset_expressions to None, run_after=None
[2024-09-08T18:35:16.569-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:35:16.568-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1 to None, run_after=None
[2024-09-08T18:35:16.569-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:35:16.569-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_and_2 to None, run_after=None
[2024-09-08T18:35:16.569-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:35:16.569-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_never_scheduled to None, run_after=None
[2024-09-08T18:35:16.570-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:35:16.569-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_unknown_never_scheduled to None, run_after=None
[2024-09-08T18:35:16.571-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:35:16.570-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_1 to 2024-09-07 00:00:00+00:00, run_after=2024-09-08 00:00:00+00:00
[2024-09-08T18:35:16.571-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:35:16.571-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_2 to None, run_after=None
[2024-09-08T18:35:16.997-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:35:16.995-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:35:16.998-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:35:16.998-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:35:17.000-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:35:16.999-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:35:17.001-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:35:17.001-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:35:17.002-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:35:17.002-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:35:17.003-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:35:17.003-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:35:17.004-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:35:17.003-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:35:17.005-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:35:17.005-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:35:17.006-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:35:17.006-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:35:17.007-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:35:17.007-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:35:17.007-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:35:17.007-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T18:35:17.008-0300] {processor.py:211} ERROR - Got an exception! Propagating...
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 207, in _run_file_processor
    _handle_dag_file_processing()
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 188, in _handle_dag_file_processing
    result: tuple[int, int, int] = dag_file_processor.process_file(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 942, in process_file
    serialize_errors = DagFileProcessor.save_dag_to_db(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/api_internal/internal_api_call.py", line 139, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 982, in save_dag_to_db
    import_errors = DagBag._sync_to_db(dags=dags, processor_subdir=dag_directory, session=session)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 707, in _sync_to_db
    for attempt in run_with_db_retries(logger=log):
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 443, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 723, in _sync_to_db
    DAG.bulk_write_to_db(dags.values(), processor_subdir=processor_subdir, session=session)
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dag.py", line 3242, in bulk_write_to_db
    orm_dags: list[DagModel] = session.scalars(query).unique().all()
                               ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1778, in scalars
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:36:33.357-0300] {processor.py:186} INFO - Started process (PID=162948) to work on /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T18:36:33.358-0300] {processor.py:914} INFO - Processing file /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py for tasks to queue
[2024-09-08T18:36:33.358-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:36:33.358-0300] {dagbag.py:587} INFO - Filling up the DagBag from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T18:36:33.368-0300] {processor.py:925} INFO - DAG(s) 'conditional_dataset_and_time_based_timetable', 'dataset_consumes_1_and_2', 'consume_1_or_both_2_and_3_with_dataset_expressions', 'consume_1_or_2_with_dataset_expressions', 'dataset_consumes_1_never_scheduled', 'dataset_consumes_1', 'dataset_produces_1', 'dataset_produces_2', 'dataset_consumes_unknown_never_scheduled', 'consume_1_and_2_with_dataset_expressions' retrieved from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T18:36:33.525-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:36:33.525-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T18:36:33.533-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:36:33.533-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_2_with_dataset_expressions
[2024-09-08T18:36:33.534-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:36:33.534-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_never_scheduled
[2024-09-08T18:36:33.534-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:36:33.534-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1
[2024-09-08T18:36:33.535-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:36:33.535-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_both_2_and_3_with_dataset_expressions
[2024-09-08T18:36:33.535-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:36:33.535-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_and_2_with_dataset_expressions
[2024-09-08T18:36:33.536-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:36:33.536-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_and_2
[2024-09-08T18:36:33.536-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:36:33.536-0300] {dag.py:3252} INFO - Creating ORM DAG for conditional_dataset_and_time_based_timetable
[2024-09-08T18:36:33.537-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:36:33.537-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_1
[2024-09-08T18:36:33.537-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:36:33.537-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_2
[2024-09-08T18:36:33.537-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:36:33.537-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_unknown_never_scheduled
[2024-09-08T18:36:33.544-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:36:33.544-0300] {dag.py:4156} INFO - Setting next_dagrun for conditional_dataset_and_time_based_timetable to 2024-09-04 01:00:00+00:00, run_after=2024-09-04 01:00:00+00:00
[2024-09-08T18:36:33.544-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:36:33.544-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_and_2_with_dataset_expressions to None, run_after=None
[2024-09-08T18:36:33.545-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:36:33.545-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_2_with_dataset_expressions to None, run_after=None
[2024-09-08T18:36:33.545-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:36:33.545-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_both_2_and_3_with_dataset_expressions to None, run_after=None
[2024-09-08T18:36:33.545-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:36:33.545-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1 to None, run_after=None
[2024-09-08T18:36:33.545-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:36:33.545-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_and_2 to None, run_after=None
[2024-09-08T18:36:33.546-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:36:33.546-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_never_scheduled to None, run_after=None
[2024-09-08T18:36:33.546-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:36:33.546-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_unknown_never_scheduled to None, run_after=None
[2024-09-08T18:36:33.547-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:36:33.547-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_1 to 2024-09-07 00:00:00+00:00, run_after=2024-09-08 00:00:00+00:00
[2024-09-08T18:36:33.548-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:36:33.548-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_2 to None, run_after=None
[2024-09-08T18:36:33.669-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:36:33.667-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:36:33.671-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:36:33.670-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:36:33.673-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:36:33.672-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:36:33.674-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:36:33.674-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:36:33.676-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:36:33.675-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:36:33.678-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:36:33.677-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:36:33.680-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:36:33.679-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:36:33.681-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:36:33.680-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:36:33.683-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:36:33.682-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:36:33.684-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:36:33.684-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:36:33.685-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:36:33.685-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T18:36:33.686-0300] {processor.py:211} ERROR - Got an exception! Propagating...
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 207, in _run_file_processor
    _handle_dag_file_processing()
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 188, in _handle_dag_file_processing
    result: tuple[int, int, int] = dag_file_processor.process_file(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 942, in process_file
    serialize_errors = DagFileProcessor.save_dag_to_db(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/api_internal/internal_api_call.py", line 139, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 982, in save_dag_to_db
    import_errors = DagBag._sync_to_db(dags=dags, processor_subdir=dag_directory, session=session)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 707, in _sync_to_db
    for attempt in run_with_db_retries(logger=log):
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 443, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 723, in _sync_to_db
    DAG.bulk_write_to_db(dags.values(), processor_subdir=processor_subdir, session=session)
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dag.py", line 3242, in bulk_write_to_db
    orm_dags: list[DagModel] = session.scalars(query).unique().all()
                               ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1778, in scalars
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:37:53.960-0300] {processor.py:186} INFO - Started process (PID=163542) to work on /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T18:37:53.961-0300] {processor.py:914} INFO - Processing file /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py for tasks to queue
[2024-09-08T18:37:53.962-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:37:53.961-0300] {dagbag.py:587} INFO - Filling up the DagBag from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T18:37:53.972-0300] {processor.py:925} INFO - DAG(s) 'dataset_consumes_1', 'conditional_dataset_and_time_based_timetable', 'dataset_consumes_1_and_2', 'dataset_consumes_1_never_scheduled', 'consume_1_or_both_2_and_3_with_dataset_expressions', 'consume_1_and_2_with_dataset_expressions', 'consume_1_or_2_with_dataset_expressions', 'dataset_produces_2', 'dataset_produces_1', 'dataset_consumes_unknown_never_scheduled' retrieved from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T18:37:54.129-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:37:54.129-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T18:37:54.137-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:37:54.137-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_2_with_dataset_expressions
[2024-09-08T18:37:54.137-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:37:54.137-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_never_scheduled
[2024-09-08T18:37:54.138-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:37:54.138-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1
[2024-09-08T18:37:54.138-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:37:54.138-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_both_2_and_3_with_dataset_expressions
[2024-09-08T18:37:54.138-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:37:54.138-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_and_2_with_dataset_expressions
[2024-09-08T18:37:54.139-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:37:54.139-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_and_2
[2024-09-08T18:37:54.139-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:37:54.139-0300] {dag.py:3252} INFO - Creating ORM DAG for conditional_dataset_and_time_based_timetable
[2024-09-08T18:37:54.140-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:37:54.140-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_2
[2024-09-08T18:37:54.140-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:37:54.140-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_1
[2024-09-08T18:37:54.140-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:37:54.140-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_unknown_never_scheduled
[2024-09-08T18:37:54.148-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:37:54.147-0300] {dag.py:4156} INFO - Setting next_dagrun for conditional_dataset_and_time_based_timetable to 2024-09-04 01:00:00+00:00, run_after=2024-09-04 01:00:00+00:00
[2024-09-08T18:37:54.148-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:37:54.148-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_and_2_with_dataset_expressions to None, run_after=None
[2024-09-08T18:37:54.148-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:37:54.148-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_2_with_dataset_expressions to None, run_after=None
[2024-09-08T18:37:54.149-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:37:54.149-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_both_2_and_3_with_dataset_expressions to None, run_after=None
[2024-09-08T18:37:54.149-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:37:54.149-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1 to None, run_after=None
[2024-09-08T18:37:54.149-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:37:54.149-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_and_2 to None, run_after=None
[2024-09-08T18:37:54.150-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:37:54.149-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_never_scheduled to None, run_after=None
[2024-09-08T18:37:54.150-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:37:54.150-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_unknown_never_scheduled to None, run_after=None
[2024-09-08T18:37:54.151-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:37:54.151-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_1 to 2024-09-07 00:00:00+00:00, run_after=2024-09-08 00:00:00+00:00
[2024-09-08T18:37:54.151-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:37:54.151-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_2 to None, run_after=None
[2024-09-08T18:37:54.532-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:37:54.530-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:37:54.533-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:37:54.532-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:37:54.534-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:37:54.533-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:37:54.535-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:37:54.534-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:37:54.536-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:37:54.535-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:37:54.537-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:37:54.536-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:37:54.538-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:37:54.537-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:37:54.539-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:37:54.538-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:37:54.540-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:37:54.539-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:37:54.540-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:37:54.540-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:37:54.541-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:37:54.541-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T18:37:54.542-0300] {processor.py:211} ERROR - Got an exception! Propagating...
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 207, in _run_file_processor
    _handle_dag_file_processing()
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 188, in _handle_dag_file_processing
    result: tuple[int, int, int] = dag_file_processor.process_file(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 942, in process_file
    serialize_errors = DagFileProcessor.save_dag_to_db(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/api_internal/internal_api_call.py", line 139, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 982, in save_dag_to_db
    import_errors = DagBag._sync_to_db(dags=dags, processor_subdir=dag_directory, session=session)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 707, in _sync_to_db
    for attempt in run_with_db_retries(logger=log):
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 443, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 723, in _sync_to_db
    DAG.bulk_write_to_db(dags.values(), processor_subdir=processor_subdir, session=session)
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dag.py", line 3242, in bulk_write_to_db
    orm_dags: list[DagModel] = session.scalars(query).unique().all()
                               ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1778, in scalars
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:39:16.537-0300] {processor.py:186} INFO - Started process (PID=164256) to work on /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T18:39:16.538-0300] {processor.py:914} INFO - Processing file /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py for tasks to queue
[2024-09-08T18:39:16.539-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:39:16.539-0300] {dagbag.py:587} INFO - Filling up the DagBag from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T18:39:16.549-0300] {processor.py:925} INFO - DAG(s) 'dataset_consumes_unknown_never_scheduled', 'dataset_consumes_1', 'consume_1_or_2_with_dataset_expressions', 'dataset_consumes_1_never_scheduled', 'conditional_dataset_and_time_based_timetable', 'consume_1_or_both_2_and_3_with_dataset_expressions', 'dataset_produces_2', 'dataset_produces_1', 'dataset_consumes_1_and_2', 'consume_1_and_2_with_dataset_expressions' retrieved from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T18:39:16.704-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:39:16.704-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T18:39:16.712-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:39:16.712-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_2_with_dataset_expressions
[2024-09-08T18:39:16.712-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:39:16.712-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_never_scheduled
[2024-09-08T18:39:16.713-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:39:16.713-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1
[2024-09-08T18:39:16.713-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:39:16.713-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_both_2_and_3_with_dataset_expressions
[2024-09-08T18:39:16.713-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:39:16.713-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_and_2_with_dataset_expressions
[2024-09-08T18:39:16.714-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:39:16.714-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_2
[2024-09-08T18:39:16.714-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:39:16.714-0300] {dag.py:3252} INFO - Creating ORM DAG for conditional_dataset_and_time_based_timetable
[2024-09-08T18:39:16.715-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:39:16.714-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_1
[2024-09-08T18:39:16.715-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:39:16.715-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_and_2
[2024-09-08T18:39:16.715-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:39:16.715-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_unknown_never_scheduled
[2024-09-08T18:39:16.722-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:39:16.722-0300] {dag.py:4156} INFO - Setting next_dagrun for conditional_dataset_and_time_based_timetable to 2024-09-04 01:00:00+00:00, run_after=2024-09-04 01:00:00+00:00
[2024-09-08T18:39:16.723-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:39:16.722-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_and_2_with_dataset_expressions to None, run_after=None
[2024-09-08T18:39:16.723-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:39:16.723-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_2_with_dataset_expressions to None, run_after=None
[2024-09-08T18:39:16.723-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:39:16.723-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_both_2_and_3_with_dataset_expressions to None, run_after=None
[2024-09-08T18:39:16.723-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:39:16.723-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1 to None, run_after=None
[2024-09-08T18:39:16.724-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:39:16.724-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_and_2 to None, run_after=None
[2024-09-08T18:39:16.724-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:39:16.724-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_never_scheduled to None, run_after=None
[2024-09-08T18:39:16.724-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:39:16.724-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_unknown_never_scheduled to None, run_after=None
[2024-09-08T18:39:16.726-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:39:16.726-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_1 to 2024-09-07 00:00:00+00:00, run_after=2024-09-08 00:00:00+00:00
[2024-09-08T18:39:16.726-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:39:16.726-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_2 to None, run_after=None
[2024-09-08T18:39:16.823-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:39:16.822-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:39:16.824-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:39:16.824-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:39:16.825-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:39:16.825-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:39:16.826-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:39:16.826-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:39:16.827-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:39:16.827-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:39:16.828-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:39:16.827-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:39:16.829-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:39:16.828-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:39:16.830-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:39:16.829-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:39:16.831-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:39:16.830-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:39:16.831-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:39:16.831-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:39:16.832-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:39:16.832-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T18:39:16.833-0300] {processor.py:211} ERROR - Got an exception! Propagating...
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 207, in _run_file_processor
    _handle_dag_file_processing()
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 188, in _handle_dag_file_processing
    result: tuple[int, int, int] = dag_file_processor.process_file(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 942, in process_file
    serialize_errors = DagFileProcessor.save_dag_to_db(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/api_internal/internal_api_call.py", line 139, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 982, in save_dag_to_db
    import_errors = DagBag._sync_to_db(dags=dags, processor_subdir=dag_directory, session=session)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 707, in _sync_to_db
    for attempt in run_with_db_retries(logger=log):
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 443, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 723, in _sync_to_db
    DAG.bulk_write_to_db(dags.values(), processor_subdir=processor_subdir, session=session)
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dag.py", line 3242, in bulk_write_to_db
    orm_dags: list[DagModel] = session.scalars(query).unique().all()
                               ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1778, in scalars
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:40:37.209-0300] {processor.py:186} INFO - Started process (PID=164825) to work on /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T18:40:37.210-0300] {processor.py:914} INFO - Processing file /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py for tasks to queue
[2024-09-08T18:40:37.210-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:40:37.210-0300] {dagbag.py:587} INFO - Filling up the DagBag from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T18:40:37.221-0300] {processor.py:925} INFO - DAG(s) 'consume_1_and_2_with_dataset_expressions', 'dataset_consumes_1_never_scheduled', 'dataset_consumes_1', 'dataset_produces_1', 'dataset_produces_2', 'consume_1_or_both_2_and_3_with_dataset_expressions', 'dataset_consumes_unknown_never_scheduled', 'dataset_consumes_1_and_2', 'consume_1_or_2_with_dataset_expressions', 'conditional_dataset_and_time_based_timetable' retrieved from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T18:40:37.382-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:40:37.382-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T18:40:37.391-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:40:37.391-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_2_with_dataset_expressions
[2024-09-08T18:40:37.392-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:40:37.392-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_never_scheduled
[2024-09-08T18:40:37.392-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:40:37.392-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1
[2024-09-08T18:40:37.393-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:40:37.392-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_and_2_with_dataset_expressions
[2024-09-08T18:40:37.393-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:40:37.393-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_both_2_and_3_with_dataset_expressions
[2024-09-08T18:40:37.393-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:40:37.393-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_1
[2024-09-08T18:40:37.394-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:40:37.394-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_2
[2024-09-08T18:40:37.394-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:40:37.394-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_and_2
[2024-09-08T18:40:37.394-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:40:37.394-0300] {dag.py:3252} INFO - Creating ORM DAG for conditional_dataset_and_time_based_timetable
[2024-09-08T18:40:37.395-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:40:37.395-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_unknown_never_scheduled
[2024-09-08T18:40:37.402-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:40:37.402-0300] {dag.py:4156} INFO - Setting next_dagrun for conditional_dataset_and_time_based_timetable to 2024-09-04 01:00:00+00:00, run_after=2024-09-04 01:00:00+00:00
[2024-09-08T18:40:37.403-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:40:37.403-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_and_2_with_dataset_expressions to None, run_after=None
[2024-09-08T18:40:37.403-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:40:37.403-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_2_with_dataset_expressions to None, run_after=None
[2024-09-08T18:40:37.404-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:40:37.404-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_both_2_and_3_with_dataset_expressions to None, run_after=None
[2024-09-08T18:40:37.404-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:40:37.404-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1 to None, run_after=None
[2024-09-08T18:40:37.404-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:40:37.404-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_and_2 to None, run_after=None
[2024-09-08T18:40:37.405-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:40:37.405-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_never_scheduled to None, run_after=None
[2024-09-08T18:40:37.405-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:40:37.405-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_unknown_never_scheduled to None, run_after=None
[2024-09-08T18:40:37.406-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:40:37.406-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_1 to 2024-09-07 00:00:00+00:00, run_after=2024-09-08 00:00:00+00:00
[2024-09-08T18:40:37.407-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:40:37.407-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_2 to None, run_after=None
[2024-09-08T18:40:37.802-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:40:37.800-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:40:37.803-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:40:37.802-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:40:37.804-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:40:37.804-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:40:37.805-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:40:37.805-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:40:37.806-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:40:37.806-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:40:37.807-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:40:37.807-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:40:37.808-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:40:37.808-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:40:37.809-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:40:37.809-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:40:37.810-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:40:37.810-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:40:37.811-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:40:37.811-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:40:37.812-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:40:37.812-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T18:40:37.813-0300] {processor.py:211} ERROR - Got an exception! Propagating...
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 207, in _run_file_processor
    _handle_dag_file_processing()
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 188, in _handle_dag_file_processing
    result: tuple[int, int, int] = dag_file_processor.process_file(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 942, in process_file
    serialize_errors = DagFileProcessor.save_dag_to_db(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/api_internal/internal_api_call.py", line 139, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 982, in save_dag_to_db
    import_errors = DagBag._sync_to_db(dags=dags, processor_subdir=dag_directory, session=session)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 707, in _sync_to_db
    for attempt in run_with_db_retries(logger=log):
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 443, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 723, in _sync_to_db
    DAG.bulk_write_to_db(dags.values(), processor_subdir=processor_subdir, session=session)
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dag.py", line 3242, in bulk_write_to_db
    orm_dags: list[DagModel] = session.scalars(query).unique().all()
                               ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1778, in scalars
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:41:55.905-0300] {processor.py:186} INFO - Started process (PID=166071) to work on /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T18:41:55.905-0300] {processor.py:914} INFO - Processing file /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py for tasks to queue
[2024-09-08T18:41:55.906-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:41:55.906-0300] {dagbag.py:587} INFO - Filling up the DagBag from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T18:41:55.920-0300] {processor.py:925} INFO - DAG(s) 'consume_1_and_2_with_dataset_expressions', 'dataset_consumes_1_and_2', 'consume_1_or_both_2_and_3_with_dataset_expressions', 'dataset_produces_2', 'dataset_consumes_1_never_scheduled', 'dataset_consumes_unknown_never_scheduled', 'consume_1_or_2_with_dataset_expressions', 'conditional_dataset_and_time_based_timetable', 'dataset_produces_1', 'dataset_consumes_1' retrieved from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T18:41:56.082-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:41:56.082-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T18:41:56.090-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:41:56.089-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_2_with_dataset_expressions
[2024-09-08T18:41:56.090-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:41:56.090-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_never_scheduled
[2024-09-08T18:41:56.090-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:41:56.090-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1
[2024-09-08T18:41:56.091-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:41:56.091-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_and_2_with_dataset_expressions
[2024-09-08T18:41:56.091-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:41:56.091-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_both_2_and_3_with_dataset_expressions
[2024-09-08T18:41:56.091-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:41:56.091-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_and_2
[2024-09-08T18:41:56.092-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:41:56.092-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_2
[2024-09-08T18:41:56.092-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:41:56.092-0300] {dag.py:3252} INFO - Creating ORM DAG for conditional_dataset_and_time_based_timetable
[2024-09-08T18:41:56.093-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:41:56.092-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_1
[2024-09-08T18:41:56.093-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:41:56.093-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_unknown_never_scheduled
[2024-09-08T18:41:56.100-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:41:56.099-0300] {dag.py:4156} INFO - Setting next_dagrun for conditional_dataset_and_time_based_timetable to 2024-09-04 01:00:00+00:00, run_after=2024-09-04 01:00:00+00:00
[2024-09-08T18:41:56.100-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:41:56.100-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_and_2_with_dataset_expressions to None, run_after=None
[2024-09-08T18:41:56.100-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:41:56.100-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_2_with_dataset_expressions to None, run_after=None
[2024-09-08T18:41:56.101-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:41:56.101-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_both_2_and_3_with_dataset_expressions to None, run_after=None
[2024-09-08T18:41:56.101-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:41:56.101-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1 to None, run_after=None
[2024-09-08T18:41:56.101-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:41:56.101-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_and_2 to None, run_after=None
[2024-09-08T18:41:56.102-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:41:56.102-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_never_scheduled to None, run_after=None
[2024-09-08T18:41:56.102-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:41:56.102-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_unknown_never_scheduled to None, run_after=None
[2024-09-08T18:41:56.103-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:41:56.103-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_1 to 2024-09-07 00:00:00+00:00, run_after=2024-09-08 00:00:00+00:00
[2024-09-08T18:41:56.104-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:41:56.103-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_2 to None, run_after=None
[2024-09-08T18:41:56.613-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:41:56.612-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:41:56.615-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:41:56.614-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:41:56.616-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:41:56.615-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:41:56.616-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:41:56.616-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:41:56.617-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:41:56.617-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:41:56.618-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:41:56.618-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:41:56.619-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:41:56.619-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:41:56.620-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:41:56.620-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:41:56.621-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:41:56.621-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:41:56.622-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:41:56.622-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:41:56.623-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:41:56.623-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T18:41:56.624-0300] {processor.py:211} ERROR - Got an exception! Propagating...
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 207, in _run_file_processor
    _handle_dag_file_processing()
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 188, in _handle_dag_file_processing
    result: tuple[int, int, int] = dag_file_processor.process_file(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 942, in process_file
    serialize_errors = DagFileProcessor.save_dag_to_db(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/api_internal/internal_api_call.py", line 139, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 982, in save_dag_to_db
    import_errors = DagBag._sync_to_db(dags=dags, processor_subdir=dag_directory, session=session)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 707, in _sync_to_db
    for attempt in run_with_db_retries(logger=log):
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 443, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 723, in _sync_to_db
    DAG.bulk_write_to_db(dags.values(), processor_subdir=processor_subdir, session=session)
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dag.py", line 3242, in bulk_write_to_db
    orm_dags: list[DagModel] = session.scalars(query).unique().all()
                               ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1778, in scalars
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:43:14.983-0300] {processor.py:186} INFO - Started process (PID=167202) to work on /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T18:43:14.984-0300] {processor.py:914} INFO - Processing file /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py for tasks to queue
[2024-09-08T18:43:14.984-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:43:14.984-0300] {dagbag.py:587} INFO - Filling up the DagBag from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T18:43:14.995-0300] {processor.py:925} INFO - DAG(s) 'dataset_produces_1', 'dataset_consumes_1', 'dataset_consumes_1_never_scheduled', 'dataset_consumes_1_and_2', 'consume_1_or_2_with_dataset_expressions', 'dataset_consumes_unknown_never_scheduled', 'dataset_produces_2', 'conditional_dataset_and_time_based_timetable', 'consume_1_or_both_2_and_3_with_dataset_expressions', 'consume_1_and_2_with_dataset_expressions' retrieved from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T18:43:15.153-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:43:15.153-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T18:43:15.161-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:43:15.161-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_2_with_dataset_expressions
[2024-09-08T18:43:15.162-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:43:15.162-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_never_scheduled
[2024-09-08T18:43:15.162-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:43:15.162-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1
[2024-09-08T18:43:15.163-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:43:15.162-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_both_2_and_3_with_dataset_expressions
[2024-09-08T18:43:15.163-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:43:15.163-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_and_2_with_dataset_expressions
[2024-09-08T18:43:15.163-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:43:15.163-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_1
[2024-09-08T18:43:15.164-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:43:15.163-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_and_2
[2024-09-08T18:43:15.164-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:43:15.164-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_2
[2024-09-08T18:43:15.164-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:43:15.164-0300] {dag.py:3252} INFO - Creating ORM DAG for conditional_dataset_and_time_based_timetable
[2024-09-08T18:43:15.165-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:43:15.165-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_unknown_never_scheduled
[2024-09-08T18:43:15.172-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:43:15.171-0300] {dag.py:4156} INFO - Setting next_dagrun for conditional_dataset_and_time_based_timetable to 2024-09-04 01:00:00+00:00, run_after=2024-09-04 01:00:00+00:00
[2024-09-08T18:43:15.172-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:43:15.172-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_and_2_with_dataset_expressions to None, run_after=None
[2024-09-08T18:43:15.173-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:43:15.172-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_2_with_dataset_expressions to None, run_after=None
[2024-09-08T18:43:15.173-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:43:15.173-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_both_2_and_3_with_dataset_expressions to None, run_after=None
[2024-09-08T18:43:15.173-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:43:15.173-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1 to None, run_after=None
[2024-09-08T18:43:15.174-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:43:15.174-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_and_2 to None, run_after=None
[2024-09-08T18:43:15.174-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:43:15.174-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_never_scheduled to None, run_after=None
[2024-09-08T18:43:15.175-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:43:15.175-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_unknown_never_scheduled to None, run_after=None
[2024-09-08T18:43:15.176-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:43:15.176-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_1 to 2024-09-07 00:00:00+00:00, run_after=2024-09-08 00:00:00+00:00
[2024-09-08T18:43:15.176-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:43:15.176-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_2 to None, run_after=None
[2024-09-08T18:43:15.511-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:43:15.510-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:43:15.512-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:43:15.512-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:43:15.513-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:43:15.513-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:43:15.514-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:43:15.514-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:43:15.515-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:43:15.515-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:43:15.516-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:43:15.516-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:43:15.517-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:43:15.517-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:43:15.518-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:43:15.517-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:43:15.519-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:43:15.518-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:43:15.520-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:43:15.519-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:43:15.520-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:43:15.520-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T18:43:15.521-0300] {processor.py:211} ERROR - Got an exception! Propagating...
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 207, in _run_file_processor
    _handle_dag_file_processing()
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 188, in _handle_dag_file_processing
    result: tuple[int, int, int] = dag_file_processor.process_file(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 942, in process_file
    serialize_errors = DagFileProcessor.save_dag_to_db(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/api_internal/internal_api_call.py", line 139, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 982, in save_dag_to_db
    import_errors = DagBag._sync_to_db(dags=dags, processor_subdir=dag_directory, session=session)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 707, in _sync_to_db
    for attempt in run_with_db_retries(logger=log):
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 443, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 723, in _sync_to_db
    DAG.bulk_write_to_db(dags.values(), processor_subdir=processor_subdir, session=session)
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dag.py", line 3242, in bulk_write_to_db
    orm_dags: list[DagModel] = session.scalars(query).unique().all()
                               ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1778, in scalars
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:44:37.669-0300] {processor.py:186} INFO - Started process (PID=167818) to work on /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T18:44:37.679-0300] {processor.py:914} INFO - Processing file /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py for tasks to queue
[2024-09-08T18:44:37.680-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:44:37.680-0300] {dagbag.py:587} INFO - Filling up the DagBag from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T18:44:37.691-0300] {processor.py:925} INFO - DAG(s) 'dataset_consumes_unknown_never_scheduled', 'dataset_produces_1', 'dataset_consumes_1_never_scheduled', 'dataset_consumes_1_and_2', 'consume_1_or_both_2_and_3_with_dataset_expressions', 'consume_1_or_2_with_dataset_expressions', 'conditional_dataset_and_time_based_timetable', 'consume_1_and_2_with_dataset_expressions', 'dataset_produces_2', 'dataset_consumes_1' retrieved from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T18:44:37.858-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:44:37.857-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T18:44:37.866-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:44:37.866-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_2_with_dataset_expressions
[2024-09-08T18:44:37.867-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:44:37.867-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_never_scheduled
[2024-09-08T18:44:37.867-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:44:37.867-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1
[2024-09-08T18:44:37.867-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:44:37.867-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_both_2_and_3_with_dataset_expressions
[2024-09-08T18:44:37.868-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:44:37.868-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_and_2_with_dataset_expressions
[2024-09-08T18:44:37.868-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:44:37.868-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_1
[2024-09-08T18:44:37.868-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:44:37.868-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_and_2
[2024-09-08T18:44:37.869-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:44:37.869-0300] {dag.py:3252} INFO - Creating ORM DAG for conditional_dataset_and_time_based_timetable
[2024-09-08T18:44:37.869-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:44:37.869-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_2
[2024-09-08T18:44:37.870-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:44:37.869-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_unknown_never_scheduled
[2024-09-08T18:44:37.876-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:44:37.876-0300] {dag.py:4156} INFO - Setting next_dagrun for conditional_dataset_and_time_based_timetable to 2024-09-04 01:00:00+00:00, run_after=2024-09-04 01:00:00+00:00
[2024-09-08T18:44:37.876-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:44:37.876-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_and_2_with_dataset_expressions to None, run_after=None
[2024-09-08T18:44:37.876-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:44:37.876-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_2_with_dataset_expressions to None, run_after=None
[2024-09-08T18:44:37.877-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:44:37.876-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_both_2_and_3_with_dataset_expressions to None, run_after=None
[2024-09-08T18:44:37.877-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:44:37.877-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1 to None, run_after=None
[2024-09-08T18:44:37.877-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:44:37.877-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_and_2 to None, run_after=None
[2024-09-08T18:44:37.877-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:44:37.877-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_never_scheduled to None, run_after=None
[2024-09-08T18:44:37.878-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:44:37.878-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_unknown_never_scheduled to None, run_after=None
[2024-09-08T18:44:37.879-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:44:37.879-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_1 to 2024-09-07 00:00:00+00:00, run_after=2024-09-08 00:00:00+00:00
[2024-09-08T18:44:37.880-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:44:37.879-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_2 to None, run_after=None
[2024-09-08T18:44:37.924-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:44:37.922-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:44:37.925-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:44:37.924-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:44:37.926-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:44:37.925-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:44:37.927-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:44:37.926-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:44:37.928-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:44:37.927-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:44:37.928-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:44:37.928-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:44:37.929-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:44:37.929-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:44:37.930-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:44:37.930-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:44:37.931-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:44:37.931-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:44:37.932-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:44:37.932-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:44:37.932-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:44:37.932-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T18:44:37.933-0300] {processor.py:211} ERROR - Got an exception! Propagating...
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 207, in _run_file_processor
    _handle_dag_file_processing()
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 188, in _handle_dag_file_processing
    result: tuple[int, int, int] = dag_file_processor.process_file(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 942, in process_file
    serialize_errors = DagFileProcessor.save_dag_to_db(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/api_internal/internal_api_call.py", line 139, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 982, in save_dag_to_db
    import_errors = DagBag._sync_to_db(dags=dags, processor_subdir=dag_directory, session=session)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 707, in _sync_to_db
    for attempt in run_with_db_retries(logger=log):
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 443, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 723, in _sync_to_db
    DAG.bulk_write_to_db(dags.values(), processor_subdir=processor_subdir, session=session)
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dag.py", line 3242, in bulk_write_to_db
    orm_dags: list[DagModel] = session.scalars(query).unique().all()
                               ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1778, in scalars
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:45:55.293-0300] {processor.py:186} INFO - Started process (PID=168344) to work on /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T18:45:55.294-0300] {processor.py:914} INFO - Processing file /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py for tasks to queue
[2024-09-08T18:45:55.295-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:45:55.294-0300] {dagbag.py:587} INFO - Filling up the DagBag from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T18:45:55.306-0300] {processor.py:925} INFO - DAG(s) 'consume_1_or_both_2_and_3_with_dataset_expressions', 'dataset_consumes_1', 'dataset_consumes_unknown_never_scheduled', 'dataset_consumes_1_and_2', 'consume_1_or_2_with_dataset_expressions', 'conditional_dataset_and_time_based_timetable', 'dataset_produces_2', 'dataset_consumes_1_never_scheduled', 'consume_1_and_2_with_dataset_expressions', 'dataset_produces_1' retrieved from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T18:45:55.452-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:45:55.452-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T18:45:55.460-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:45:55.460-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_2_with_dataset_expressions
[2024-09-08T18:45:55.461-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:45:55.461-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_never_scheduled
[2024-09-08T18:45:55.461-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:45:55.461-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1
[2024-09-08T18:45:55.462-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:45:55.461-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_both_2_and_3_with_dataset_expressions
[2024-09-08T18:45:55.462-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:45:55.462-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_and_2_with_dataset_expressions
[2024-09-08T18:45:55.462-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:45:55.462-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_and_2
[2024-09-08T18:45:55.463-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:45:55.463-0300] {dag.py:3252} INFO - Creating ORM DAG for conditional_dataset_and_time_based_timetable
[2024-09-08T18:45:55.463-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:45:55.463-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_2
[2024-09-08T18:45:55.463-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:45:55.463-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_1
[2024-09-08T18:45:55.464-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:45:55.464-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_unknown_never_scheduled
[2024-09-08T18:45:55.471-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:45:55.470-0300] {dag.py:4156} INFO - Setting next_dagrun for conditional_dataset_and_time_based_timetable to 2024-09-04 01:00:00+00:00, run_after=2024-09-04 01:00:00+00:00
[2024-09-08T18:45:55.471-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:45:55.471-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_and_2_with_dataset_expressions to None, run_after=None
[2024-09-08T18:45:55.471-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:45:55.471-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_2_with_dataset_expressions to None, run_after=None
[2024-09-08T18:45:55.472-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:45:55.471-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_both_2_and_3_with_dataset_expressions to None, run_after=None
[2024-09-08T18:45:55.472-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:45:55.472-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1 to None, run_after=None
[2024-09-08T18:45:55.472-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:45:55.472-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_and_2 to None, run_after=None
[2024-09-08T18:45:55.472-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:45:55.472-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_never_scheduled to None, run_after=None
[2024-09-08T18:45:55.473-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:45:55.473-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_unknown_never_scheduled to None, run_after=None
[2024-09-08T18:45:55.474-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:45:55.474-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_1 to 2024-09-07 00:00:00+00:00, run_after=2024-09-08 00:00:00+00:00
[2024-09-08T18:45:55.474-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:45:55.474-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_2 to None, run_after=None
[2024-09-08T18:45:55.513-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:45:55.512-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:45:55.514-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:45:55.514-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:45:55.515-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:45:55.515-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:45:55.516-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:45:55.516-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:45:55.517-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:45:55.517-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:45:55.518-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:45:55.518-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:45:55.519-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:45:55.519-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:45:55.520-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:45:55.519-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:45:55.521-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:45:55.520-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:45:55.522-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:45:55.521-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:45:55.522-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:45:55.522-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T18:45:55.523-0300] {processor.py:211} ERROR - Got an exception! Propagating...
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 207, in _run_file_processor
    _handle_dag_file_processing()
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 188, in _handle_dag_file_processing
    result: tuple[int, int, int] = dag_file_processor.process_file(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 942, in process_file
    serialize_errors = DagFileProcessor.save_dag_to_db(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/api_internal/internal_api_call.py", line 139, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 982, in save_dag_to_db
    import_errors = DagBag._sync_to_db(dags=dags, processor_subdir=dag_directory, session=session)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 707, in _sync_to_db
    for attempt in run_with_db_retries(logger=log):
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 443, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 723, in _sync_to_db
    DAG.bulk_write_to_db(dags.values(), processor_subdir=processor_subdir, session=session)
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dag.py", line 3242, in bulk_write_to_db
    orm_dags: list[DagModel] = session.scalars(query).unique().all()
                               ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1778, in scalars
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:47:09.591-0300] {processor.py:186} INFO - Started process (PID=168882) to work on /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T18:47:09.591-0300] {processor.py:914} INFO - Processing file /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py for tasks to queue
[2024-09-08T18:47:09.592-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:47:09.592-0300] {dagbag.py:587} INFO - Filling up the DagBag from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T18:47:09.602-0300] {processor.py:925} INFO - DAG(s) 'consume_1_and_2_with_dataset_expressions', 'dataset_consumes_1_never_scheduled', 'dataset_consumes_1_and_2', 'conditional_dataset_and_time_based_timetable', 'dataset_produces_2', 'consume_1_or_both_2_and_3_with_dataset_expressions', 'dataset_consumes_unknown_never_scheduled', 'dataset_produces_1', 'consume_1_or_2_with_dataset_expressions', 'dataset_consumes_1' retrieved from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T18:47:09.749-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:47:09.749-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T18:47:09.757-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:47:09.757-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_2_with_dataset_expressions
[2024-09-08T18:47:09.757-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:47:09.757-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_never_scheduled
[2024-09-08T18:47:09.758-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:47:09.758-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1
[2024-09-08T18:47:09.758-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:47:09.758-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_and_2_with_dataset_expressions
[2024-09-08T18:47:09.758-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:47:09.758-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_both_2_and_3_with_dataset_expressions
[2024-09-08T18:47:09.759-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:47:09.759-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_and_2
[2024-09-08T18:47:09.759-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:47:09.759-0300] {dag.py:3252} INFO - Creating ORM DAG for conditional_dataset_and_time_based_timetable
[2024-09-08T18:47:09.759-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:47:09.759-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_2
[2024-09-08T18:47:09.760-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:47:09.760-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_1
[2024-09-08T18:47:09.760-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:47:09.760-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_unknown_never_scheduled
[2024-09-08T18:47:09.767-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:47:09.767-0300] {dag.py:4156} INFO - Setting next_dagrun for conditional_dataset_and_time_based_timetable to 2024-09-04 01:00:00+00:00, run_after=2024-09-04 01:00:00+00:00
[2024-09-08T18:47:09.767-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:47:09.767-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_and_2_with_dataset_expressions to None, run_after=None
[2024-09-08T18:47:09.768-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:47:09.768-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_2_with_dataset_expressions to None, run_after=None
[2024-09-08T18:47:09.768-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:47:09.768-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_both_2_and_3_with_dataset_expressions to None, run_after=None
[2024-09-08T18:47:09.768-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:47:09.768-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1 to None, run_after=None
[2024-09-08T18:47:09.768-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:47:09.768-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_and_2 to None, run_after=None
[2024-09-08T18:47:09.769-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:47:09.769-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_never_scheduled to None, run_after=None
[2024-09-08T18:47:09.769-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:47:09.769-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_unknown_never_scheduled to None, run_after=None
[2024-09-08T18:47:09.770-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:47:09.770-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_1 to 2024-09-07 00:00:00+00:00, run_after=2024-09-08 00:00:00+00:00
[2024-09-08T18:47:09.771-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:47:09.771-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_2 to None, run_after=None
[2024-09-08T18:47:10.216-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:47:10.215-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:47:10.217-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:47:10.217-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:47:10.218-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:47:10.218-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:47:10.219-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:47:10.219-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:47:10.220-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:47:10.219-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:47:10.221-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:47:10.220-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:47:10.222-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:47:10.222-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:47:10.223-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:47:10.222-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:47:10.224-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:47:10.223-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:47:10.225-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:47:10.224-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:47:10.225-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:47:10.225-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T18:47:10.226-0300] {processor.py:211} ERROR - Got an exception! Propagating...
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 207, in _run_file_processor
    _handle_dag_file_processing()
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 188, in _handle_dag_file_processing
    result: tuple[int, int, int] = dag_file_processor.process_file(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 942, in process_file
    serialize_errors = DagFileProcessor.save_dag_to_db(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/api_internal/internal_api_call.py", line 139, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 982, in save_dag_to_db
    import_errors = DagBag._sync_to_db(dags=dags, processor_subdir=dag_directory, session=session)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 707, in _sync_to_db
    for attempt in run_with_db_retries(logger=log):
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 443, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 723, in _sync_to_db
    DAG.bulk_write_to_db(dags.values(), processor_subdir=processor_subdir, session=session)
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dag.py", line 3242, in bulk_write_to_db
    orm_dags: list[DagModel] = session.scalars(query).unique().all()
                               ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1778, in scalars
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:48:22.456-0300] {processor.py:186} INFO - Started process (PID=169621) to work on /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T18:48:22.457-0300] {processor.py:914} INFO - Processing file /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py for tasks to queue
[2024-09-08T18:48:22.458-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:48:22.458-0300] {dagbag.py:587} INFO - Filling up the DagBag from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T18:48:22.469-0300] {processor.py:925} INFO - DAG(s) 'dataset_consumes_1', 'dataset_consumes_unknown_never_scheduled', 'dataset_produces_2', 'consume_1_and_2_with_dataset_expressions', 'conditional_dataset_and_time_based_timetable', 'consume_1_or_both_2_and_3_with_dataset_expressions', 'dataset_consumes_1_never_scheduled', 'dataset_produces_1', 'consume_1_or_2_with_dataset_expressions', 'dataset_consumes_1_and_2' retrieved from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T18:48:22.619-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:48:22.619-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T18:48:22.627-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:48:22.627-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_2_with_dataset_expressions
[2024-09-08T18:48:22.628-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:48:22.627-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_never_scheduled
[2024-09-08T18:48:22.628-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:48:22.628-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1
[2024-09-08T18:48:22.628-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:48:22.628-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_and_2_with_dataset_expressions
[2024-09-08T18:48:22.629-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:48:22.629-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_both_2_and_3_with_dataset_expressions
[2024-09-08T18:48:22.629-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:48:22.629-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_2
[2024-09-08T18:48:22.629-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:48:22.629-0300] {dag.py:3252} INFO - Creating ORM DAG for conditional_dataset_and_time_based_timetable
[2024-09-08T18:48:22.630-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:48:22.630-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_1
[2024-09-08T18:48:22.630-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:48:22.630-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_and_2
[2024-09-08T18:48:22.631-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:48:22.630-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_unknown_never_scheduled
[2024-09-08T18:48:22.637-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:48:22.637-0300] {dag.py:4156} INFO - Setting next_dagrun for conditional_dataset_and_time_based_timetable to 2024-09-04 01:00:00+00:00, run_after=2024-09-04 01:00:00+00:00
[2024-09-08T18:48:22.637-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:48:22.637-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_and_2_with_dataset_expressions to None, run_after=None
[2024-09-08T18:48:22.638-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:48:22.637-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_2_with_dataset_expressions to None, run_after=None
[2024-09-08T18:48:22.639-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:48:22.638-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_both_2_and_3_with_dataset_expressions to None, run_after=None
[2024-09-08T18:48:22.639-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:48:22.639-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1 to None, run_after=None
[2024-09-08T18:48:22.639-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:48:22.639-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_and_2 to None, run_after=None
[2024-09-08T18:48:22.640-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:48:22.639-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_never_scheduled to None, run_after=None
[2024-09-08T18:48:22.640-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:48:22.640-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_unknown_never_scheduled to None, run_after=None
[2024-09-08T18:48:22.641-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:48:22.641-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_1 to 2024-09-07 00:00:00+00:00, run_after=2024-09-08 00:00:00+00:00
[2024-09-08T18:48:22.641-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:48:22.641-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_2 to None, run_after=None
[2024-09-08T18:48:22.670-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:48:22.668-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:48:22.672-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:48:22.671-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:48:22.672-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:48:22.672-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:48:22.673-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:48:22.673-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:48:22.674-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:48:22.674-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:48:22.675-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:48:22.675-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:48:22.676-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:48:22.676-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:48:22.677-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:48:22.677-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:48:22.678-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:48:22.678-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:48:22.679-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:48:22.678-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:48:22.679-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:48:22.679-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T18:48:22.680-0300] {processor.py:211} ERROR - Got an exception! Propagating...
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 207, in _run_file_processor
    _handle_dag_file_processing()
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 188, in _handle_dag_file_processing
    result: tuple[int, int, int] = dag_file_processor.process_file(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 942, in process_file
    serialize_errors = DagFileProcessor.save_dag_to_db(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/api_internal/internal_api_call.py", line 139, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 982, in save_dag_to_db
    import_errors = DagBag._sync_to_db(dags=dags, processor_subdir=dag_directory, session=session)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 707, in _sync_to_db
    for attempt in run_with_db_retries(logger=log):
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 443, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 723, in _sync_to_db
    DAG.bulk_write_to_db(dags.values(), processor_subdir=processor_subdir, session=session)
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dag.py", line 3242, in bulk_write_to_db
    orm_dags: list[DagModel] = session.scalars(query).unique().all()
                               ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1778, in scalars
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:49:42.985-0300] {processor.py:186} INFO - Started process (PID=170451) to work on /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T18:49:42.985-0300] {processor.py:914} INFO - Processing file /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py for tasks to queue
[2024-09-08T18:49:42.986-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:49:42.986-0300] {dagbag.py:587} INFO - Filling up the DagBag from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T18:49:42.997-0300] {processor.py:925} INFO - DAG(s) 'dataset_produces_2', 'dataset_produces_1', 'dataset_consumes_unknown_never_scheduled', 'consume_1_or_both_2_and_3_with_dataset_expressions', 'dataset_consumes_1_never_scheduled', 'consume_1_and_2_with_dataset_expressions', 'conditional_dataset_and_time_based_timetable', 'dataset_consumes_1_and_2', 'consume_1_or_2_with_dataset_expressions', 'dataset_consumes_1' retrieved from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T18:49:43.162-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:49:43.162-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T18:49:43.171-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:49:43.171-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_2_with_dataset_expressions
[2024-09-08T18:49:43.171-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:49:43.171-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_never_scheduled
[2024-09-08T18:49:43.172-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:49:43.172-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1
[2024-09-08T18:49:43.172-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:49:43.172-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_both_2_and_3_with_dataset_expressions
[2024-09-08T18:49:43.173-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:49:43.173-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_and_2_with_dataset_expressions
[2024-09-08T18:49:43.173-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:49:43.173-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_2
[2024-09-08T18:49:43.174-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:49:43.174-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_1
[2024-09-08T18:49:43.174-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:49:43.174-0300] {dag.py:3252} INFO - Creating ORM DAG for conditional_dataset_and_time_based_timetable
[2024-09-08T18:49:43.175-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:49:43.175-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_and_2
[2024-09-08T18:49:43.175-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:49:43.175-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_unknown_never_scheduled
[2024-09-08T18:49:43.182-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:49:43.182-0300] {dag.py:4156} INFO - Setting next_dagrun for conditional_dataset_and_time_based_timetable to 2024-09-04 01:00:00+00:00, run_after=2024-09-04 01:00:00+00:00
[2024-09-08T18:49:43.183-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:49:43.183-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_and_2_with_dataset_expressions to None, run_after=None
[2024-09-08T18:49:43.183-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:49:43.183-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_2_with_dataset_expressions to None, run_after=None
[2024-09-08T18:49:43.183-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:49:43.183-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_both_2_and_3_with_dataset_expressions to None, run_after=None
[2024-09-08T18:49:43.184-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:49:43.184-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1 to None, run_after=None
[2024-09-08T18:49:43.184-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:49:43.184-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_and_2 to None, run_after=None
[2024-09-08T18:49:43.184-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:49:43.184-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_never_scheduled to None, run_after=None
[2024-09-08T18:49:43.185-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:49:43.185-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_unknown_never_scheduled to None, run_after=None
[2024-09-08T18:49:43.186-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:49:43.186-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_1 to 2024-09-07 00:00:00+00:00, run_after=2024-09-08 00:00:00+00:00
[2024-09-08T18:49:43.187-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:49:43.186-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_2 to None, run_after=None
[2024-09-08T18:49:43.214-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:49:43.213-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:49:43.215-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:49:43.215-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:49:43.216-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:49:43.216-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:49:43.217-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:49:43.217-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:49:43.218-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:49:43.218-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:49:43.219-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:49:43.219-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:49:43.221-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:49:43.220-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:49:43.222-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:49:43.222-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:49:43.224-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:49:43.223-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:49:43.225-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:49:43.224-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:49:43.225-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:49:43.225-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T18:49:43.226-0300] {processor.py:211} ERROR - Got an exception! Propagating...
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 207, in _run_file_processor
    _handle_dag_file_processing()
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 188, in _handle_dag_file_processing
    result: tuple[int, int, int] = dag_file_processor.process_file(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 942, in process_file
    serialize_errors = DagFileProcessor.save_dag_to_db(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/api_internal/internal_api_call.py", line 139, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 982, in save_dag_to_db
    import_errors = DagBag._sync_to_db(dags=dags, processor_subdir=dag_directory, session=session)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 707, in _sync_to_db
    for attempt in run_with_db_retries(logger=log):
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 443, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 723, in _sync_to_db
    DAG.bulk_write_to_db(dags.values(), processor_subdir=processor_subdir, session=session)
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dag.py", line 3242, in bulk_write_to_db
    orm_dags: list[DagModel] = session.scalars(query).unique().all()
                               ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1778, in scalars
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:50:57.877-0300] {processor.py:186} INFO - Started process (PID=171272) to work on /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T18:50:57.878-0300] {processor.py:914} INFO - Processing file /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py for tasks to queue
[2024-09-08T18:50:57.879-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:50:57.879-0300] {dagbag.py:587} INFO - Filling up the DagBag from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T18:50:57.892-0300] {processor.py:925} INFO - DAG(s) 'dataset_produces_1', 'consume_1_or_2_with_dataset_expressions', 'dataset_consumes_1_never_scheduled', 'dataset_produces_2', 'dataset_consumes_1', 'consume_1_or_both_2_and_3_with_dataset_expressions', 'conditional_dataset_and_time_based_timetable', 'dataset_consumes_unknown_never_scheduled', 'dataset_consumes_1_and_2', 'consume_1_and_2_with_dataset_expressions' retrieved from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T18:50:58.068-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:50:58.068-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T18:50:58.076-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:50:58.076-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_2_with_dataset_expressions
[2024-09-08T18:50:58.077-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:50:58.077-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_never_scheduled
[2024-09-08T18:50:58.077-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:50:58.077-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1
[2024-09-08T18:50:58.077-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:50:58.077-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_both_2_and_3_with_dataset_expressions
[2024-09-08T18:50:58.078-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:50:58.078-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_and_2_with_dataset_expressions
[2024-09-08T18:50:58.078-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:50:58.078-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_1
[2024-09-08T18:50:58.078-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:50:58.078-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_2
[2024-09-08T18:50:58.079-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:50:58.079-0300] {dag.py:3252} INFO - Creating ORM DAG for conditional_dataset_and_time_based_timetable
[2024-09-08T18:50:58.080-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:50:58.079-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_and_2
[2024-09-08T18:50:58.081-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:50:58.081-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_unknown_never_scheduled
[2024-09-08T18:50:58.088-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:50:58.088-0300] {dag.py:4156} INFO - Setting next_dagrun for conditional_dataset_and_time_based_timetable to 2024-09-04 01:00:00+00:00, run_after=2024-09-04 01:00:00+00:00
[2024-09-08T18:50:58.089-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:50:58.089-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_and_2_with_dataset_expressions to None, run_after=None
[2024-09-08T18:50:58.089-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:50:58.089-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_2_with_dataset_expressions to None, run_after=None
[2024-09-08T18:50:58.090-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:50:58.089-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_both_2_and_3_with_dataset_expressions to None, run_after=None
[2024-09-08T18:50:58.090-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:50:58.090-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1 to None, run_after=None
[2024-09-08T18:50:58.090-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:50:58.090-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_and_2 to None, run_after=None
[2024-09-08T18:50:58.090-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:50:58.090-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_never_scheduled to None, run_after=None
[2024-09-08T18:50:58.091-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:50:58.091-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_unknown_never_scheduled to None, run_after=None
[2024-09-08T18:50:58.092-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:50:58.092-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_1 to 2024-09-07 00:00:00+00:00, run_after=2024-09-08 00:00:00+00:00
[2024-09-08T18:50:58.092-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:50:58.092-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_2 to None, run_after=None
[2024-09-08T18:50:58.256-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:50:58.254-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:50:58.257-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:50:58.257-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:50:58.258-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:50:58.258-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:50:58.259-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:50:58.258-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:50:58.260-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:50:58.259-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:50:58.261-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:50:58.260-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:50:58.262-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:50:58.261-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:50:58.263-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:50:58.262-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:50:58.264-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:50:58.263-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:50:58.264-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:50:58.264-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:50:58.265-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:50:58.265-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T18:50:58.266-0300] {processor.py:211} ERROR - Got an exception! Propagating...
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 207, in _run_file_processor
    _handle_dag_file_processing()
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 188, in _handle_dag_file_processing
    result: tuple[int, int, int] = dag_file_processor.process_file(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 942, in process_file
    serialize_errors = DagFileProcessor.save_dag_to_db(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/api_internal/internal_api_call.py", line 139, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 982, in save_dag_to_db
    import_errors = DagBag._sync_to_db(dags=dags, processor_subdir=dag_directory, session=session)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 707, in _sync_to_db
    for attempt in run_with_db_retries(logger=log):
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 443, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 723, in _sync_to_db
    DAG.bulk_write_to_db(dags.values(), processor_subdir=processor_subdir, session=session)
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dag.py", line 3242, in bulk_write_to_db
    orm_dags: list[DagModel] = session.scalars(query).unique().all()
                               ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1778, in scalars
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:52:11.844-0300] {processor.py:186} INFO - Started process (PID=172051) to work on /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T18:52:11.844-0300] {processor.py:914} INFO - Processing file /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py for tasks to queue
[2024-09-08T18:52:11.845-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:52:11.845-0300] {dagbag.py:587} INFO - Filling up the DagBag from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T18:52:11.856-0300] {processor.py:925} INFO - DAG(s) 'dataset_consumes_1', 'dataset_produces_2', 'consume_1_or_2_with_dataset_expressions', 'dataset_consumes_1_and_2', 'conditional_dataset_and_time_based_timetable', 'dataset_consumes_unknown_never_scheduled', 'consume_1_or_both_2_and_3_with_dataset_expressions', 'dataset_produces_1', 'dataset_consumes_1_never_scheduled', 'consume_1_and_2_with_dataset_expressions' retrieved from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T18:52:12.023-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:52:12.022-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T18:52:12.030-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:52:12.030-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_2_with_dataset_expressions
[2024-09-08T18:52:12.031-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:52:12.031-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_never_scheduled
[2024-09-08T18:52:12.031-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:52:12.031-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1
[2024-09-08T18:52:12.032-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:52:12.031-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_both_2_and_3_with_dataset_expressions
[2024-09-08T18:52:12.032-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:52:12.032-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_and_2_with_dataset_expressions
[2024-09-08T18:52:12.032-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:52:12.032-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_2
[2024-09-08T18:52:12.033-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:52:12.033-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_and_2
[2024-09-08T18:52:12.033-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:52:12.033-0300] {dag.py:3252} INFO - Creating ORM DAG for conditional_dataset_and_time_based_timetable
[2024-09-08T18:52:12.034-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:52:12.033-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_1
[2024-09-08T18:52:12.034-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:52:12.034-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_unknown_never_scheduled
[2024-09-08T18:52:12.041-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:52:12.041-0300] {dag.py:4156} INFO - Setting next_dagrun for conditional_dataset_and_time_based_timetable to 2024-09-04 01:00:00+00:00, run_after=2024-09-04 01:00:00+00:00
[2024-09-08T18:52:12.041-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:52:12.041-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_and_2_with_dataset_expressions to None, run_after=None
[2024-09-08T18:52:12.041-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:52:12.041-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_2_with_dataset_expressions to None, run_after=None
[2024-09-08T18:52:12.042-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:52:12.042-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_both_2_and_3_with_dataset_expressions to None, run_after=None
[2024-09-08T18:52:12.042-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:52:12.042-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1 to None, run_after=None
[2024-09-08T18:52:12.043-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:52:12.042-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_and_2 to None, run_after=None
[2024-09-08T18:52:12.043-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:52:12.043-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_never_scheduled to None, run_after=None
[2024-09-08T18:52:12.043-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:52:12.043-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_unknown_never_scheduled to None, run_after=None
[2024-09-08T18:52:12.045-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:52:12.044-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_1 to 2024-09-07 00:00:00+00:00, run_after=2024-09-08 00:00:00+00:00
[2024-09-08T18:52:12.045-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:52:12.045-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_2 to None, run_after=None
[2024-09-08T18:52:12.091-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:52:12.089-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:52:12.092-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:52:12.091-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:52:12.092-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:52:12.092-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:52:12.093-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:52:12.093-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:52:12.094-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:52:12.094-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:52:12.095-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:52:12.095-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:52:12.096-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:52:12.096-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:52:12.097-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:52:12.097-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:52:12.098-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:52:12.098-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:52:12.099-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:52:12.099-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:52:12.100-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:52:12.100-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T18:52:12.101-0300] {processor.py:211} ERROR - Got an exception! Propagating...
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 207, in _run_file_processor
    _handle_dag_file_processing()
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 188, in _handle_dag_file_processing
    result: tuple[int, int, int] = dag_file_processor.process_file(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 942, in process_file
    serialize_errors = DagFileProcessor.save_dag_to_db(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/api_internal/internal_api_call.py", line 139, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 982, in save_dag_to_db
    import_errors = DagBag._sync_to_db(dags=dags, processor_subdir=dag_directory, session=session)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 707, in _sync_to_db
    for attempt in run_with_db_retries(logger=log):
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 443, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 723, in _sync_to_db
    DAG.bulk_write_to_db(dags.values(), processor_subdir=processor_subdir, session=session)
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dag.py", line 3242, in bulk_write_to_db
    orm_dags: list[DagModel] = session.scalars(query).unique().all()
                               ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1778, in scalars
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:53:37.894-0300] {processor.py:186} INFO - Started process (PID=172726) to work on /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T18:53:37.895-0300] {processor.py:914} INFO - Processing file /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py for tasks to queue
[2024-09-08T18:53:37.896-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:53:37.896-0300] {dagbag.py:587} INFO - Filling up the DagBag from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T18:53:37.906-0300] {processor.py:925} INFO - DAG(s) 'consume_1_or_both_2_and_3_with_dataset_expressions', 'dataset_consumes_unknown_never_scheduled', 'consume_1_and_2_with_dataset_expressions', 'conditional_dataset_and_time_based_timetable', 'dataset_consumes_1_never_scheduled', 'dataset_consumes_1_and_2', 'dataset_consumes_1', 'dataset_produces_1', 'dataset_produces_2', 'consume_1_or_2_with_dataset_expressions' retrieved from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T18:53:38.068-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:53:38.068-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T18:53:38.075-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:53:38.075-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_2_with_dataset_expressions
[2024-09-08T18:53:38.076-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:53:38.076-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_never_scheduled
[2024-09-08T18:53:38.076-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:53:38.076-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1
[2024-09-08T18:53:38.077-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:53:38.077-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_both_2_and_3_with_dataset_expressions
[2024-09-08T18:53:38.077-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:53:38.077-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_and_2_with_dataset_expressions
[2024-09-08T18:53:38.077-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:53:38.077-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_and_2
[2024-09-08T18:53:38.078-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:53:38.078-0300] {dag.py:3252} INFO - Creating ORM DAG for conditional_dataset_and_time_based_timetable
[2024-09-08T18:53:38.078-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:53:38.078-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_1
[2024-09-08T18:53:38.078-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:53:38.078-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_2
[2024-09-08T18:53:38.079-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:53:38.079-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_unknown_never_scheduled
[2024-09-08T18:53:38.085-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:53:38.085-0300] {dag.py:4156} INFO - Setting next_dagrun for conditional_dataset_and_time_based_timetable to 2024-09-04 01:00:00+00:00, run_after=2024-09-04 01:00:00+00:00
[2024-09-08T18:53:38.086-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:53:38.086-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_and_2_with_dataset_expressions to None, run_after=None
[2024-09-08T18:53:38.086-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:53:38.086-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_2_with_dataset_expressions to None, run_after=None
[2024-09-08T18:53:38.087-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:53:38.086-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_both_2_and_3_with_dataset_expressions to None, run_after=None
[2024-09-08T18:53:38.087-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:53:38.087-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1 to None, run_after=None
[2024-09-08T18:53:38.087-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:53:38.087-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_and_2 to None, run_after=None
[2024-09-08T18:53:38.087-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:53:38.087-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_never_scheduled to None, run_after=None
[2024-09-08T18:53:38.088-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:53:38.088-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_unknown_never_scheduled to None, run_after=None
[2024-09-08T18:53:38.089-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:53:38.089-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_1 to 2024-09-07 00:00:00+00:00, run_after=2024-09-08 00:00:00+00:00
[2024-09-08T18:53:38.090-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:53:38.090-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_2 to None, run_after=None
[2024-09-08T18:53:38.585-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:53:38.583-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:53:38.586-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:53:38.585-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:53:38.588-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:53:38.587-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:53:38.589-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:53:38.589-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:53:38.591-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:53:38.590-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:53:38.592-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:53:38.592-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:53:38.594-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:53:38.593-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:53:38.595-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:53:38.594-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:53:38.596-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:53:38.595-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:53:38.597-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:53:38.596-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:53:38.597-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:53:38.597-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T18:53:38.598-0300] {processor.py:211} ERROR - Got an exception! Propagating...
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 207, in _run_file_processor
    _handle_dag_file_processing()
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 188, in _handle_dag_file_processing
    result: tuple[int, int, int] = dag_file_processor.process_file(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 942, in process_file
    serialize_errors = DagFileProcessor.save_dag_to_db(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/api_internal/internal_api_call.py", line 139, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 982, in save_dag_to_db
    import_errors = DagBag._sync_to_db(dags=dags, processor_subdir=dag_directory, session=session)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 707, in _sync_to_db
    for attempt in run_with_db_retries(logger=log):
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 443, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 723, in _sync_to_db
    DAG.bulk_write_to_db(dags.values(), processor_subdir=processor_subdir, session=session)
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dag.py", line 3242, in bulk_write_to_db
    orm_dags: list[DagModel] = session.scalars(query).unique().all()
                               ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1778, in scalars
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:54:52.445-0300] {processor.py:186} INFO - Started process (PID=173317) to work on /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T18:54:52.446-0300] {processor.py:914} INFO - Processing file /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py for tasks to queue
[2024-09-08T18:54:52.447-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:54:52.446-0300] {dagbag.py:587} INFO - Filling up the DagBag from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T18:54:52.457-0300] {processor.py:925} INFO - DAG(s) 'dataset_produces_1', 'dataset_consumes_1', 'conditional_dataset_and_time_based_timetable', 'dataset_produces_2', 'dataset_consumes_1_and_2', 'consume_1_and_2_with_dataset_expressions', 'consume_1_or_2_with_dataset_expressions', 'consume_1_or_both_2_and_3_with_dataset_expressions', 'dataset_consumes_1_never_scheduled', 'dataset_consumes_unknown_never_scheduled' retrieved from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T18:54:52.612-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:54:52.612-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T18:54:52.620-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:54:52.620-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_2_with_dataset_expressions
[2024-09-08T18:54:52.620-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:54:52.620-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_never_scheduled
[2024-09-08T18:54:52.621-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:54:52.621-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1
[2024-09-08T18:54:52.621-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:54:52.621-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_and_2_with_dataset_expressions
[2024-09-08T18:54:52.622-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:54:52.621-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_both_2_and_3_with_dataset_expressions
[2024-09-08T18:54:52.622-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:54:52.622-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_1
[2024-09-08T18:54:52.622-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:54:52.622-0300] {dag.py:3252} INFO - Creating ORM DAG for conditional_dataset_and_time_based_timetable
[2024-09-08T18:54:52.623-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:54:52.623-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_2
[2024-09-08T18:54:52.623-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:54:52.623-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_and_2
[2024-09-08T18:54:52.623-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:54:52.623-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_unknown_never_scheduled
[2024-09-08T18:54:52.630-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:54:52.630-0300] {dag.py:4156} INFO - Setting next_dagrun for conditional_dataset_and_time_based_timetable to 2024-09-04 01:00:00+00:00, run_after=2024-09-04 01:00:00+00:00
[2024-09-08T18:54:52.631-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:54:52.630-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_and_2_with_dataset_expressions to None, run_after=None
[2024-09-08T18:54:52.631-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:54:52.631-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_2_with_dataset_expressions to None, run_after=None
[2024-09-08T18:54:52.631-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:54:52.631-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_both_2_and_3_with_dataset_expressions to None, run_after=None
[2024-09-08T18:54:52.631-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:54:52.631-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1 to None, run_after=None
[2024-09-08T18:54:52.632-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:54:52.632-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_and_2 to None, run_after=None
[2024-09-08T18:54:52.632-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:54:52.632-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_never_scheduled to None, run_after=None
[2024-09-08T18:54:52.632-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:54:52.632-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_unknown_never_scheduled to None, run_after=None
[2024-09-08T18:54:52.633-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:54:52.633-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_1 to 2024-09-07 00:00:00+00:00, run_after=2024-09-08 00:00:00+00:00
[2024-09-08T18:54:52.634-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:54:52.634-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_2 to None, run_after=None
[2024-09-08T18:54:52.928-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:54:52.926-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:54:52.929-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:54:52.928-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:54:52.930-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:54:52.929-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:54:52.931-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:54:52.930-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:54:52.932-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:54:52.931-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:54:52.933-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:54:52.932-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:54:52.933-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:54:52.933-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:54:52.934-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:54:52.934-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:54:52.935-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:54:52.935-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:54:52.936-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:54:52.936-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:54:52.937-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:54:52.937-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T18:54:52.938-0300] {processor.py:211} ERROR - Got an exception! Propagating...
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 207, in _run_file_processor
    _handle_dag_file_processing()
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 188, in _handle_dag_file_processing
    result: tuple[int, int, int] = dag_file_processor.process_file(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 942, in process_file
    serialize_errors = DagFileProcessor.save_dag_to_db(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/api_internal/internal_api_call.py", line 139, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 982, in save_dag_to_db
    import_errors = DagBag._sync_to_db(dags=dags, processor_subdir=dag_directory, session=session)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 707, in _sync_to_db
    for attempt in run_with_db_retries(logger=log):
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 443, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 723, in _sync_to_db
    DAG.bulk_write_to_db(dags.values(), processor_subdir=processor_subdir, session=session)
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dag.py", line 3242, in bulk_write_to_db
    orm_dags: list[DagModel] = session.scalars(query).unique().all()
                               ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1778, in scalars
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:56:05.092-0300] {processor.py:186} INFO - Started process (PID=173895) to work on /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T18:56:05.092-0300] {processor.py:914} INFO - Processing file /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py for tasks to queue
[2024-09-08T18:56:05.093-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:56:05.093-0300] {dagbag.py:587} INFO - Filling up the DagBag from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T18:56:05.104-0300] {processor.py:925} INFO - DAG(s) 'consume_1_or_2_with_dataset_expressions', 'dataset_consumes_1', 'dataset_consumes_1_never_scheduled', 'dataset_consumes_1_and_2', 'consume_1_and_2_with_dataset_expressions', 'conditional_dataset_and_time_based_timetable', 'dataset_consumes_unknown_never_scheduled', 'consume_1_or_both_2_and_3_with_dataset_expressions', 'dataset_produces_2', 'dataset_produces_1' retrieved from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T18:56:05.267-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:56:05.267-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T18:56:05.276-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:56:05.275-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_2_with_dataset_expressions
[2024-09-08T18:56:05.276-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:56:05.276-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_never_scheduled
[2024-09-08T18:56:05.276-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:56:05.276-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1
[2024-09-08T18:56:05.277-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:56:05.277-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_and_2_with_dataset_expressions
[2024-09-08T18:56:05.277-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:56:05.277-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_both_2_and_3_with_dataset_expressions
[2024-09-08T18:56:05.278-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:56:05.277-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_and_2
[2024-09-08T18:56:05.278-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:56:05.278-0300] {dag.py:3252} INFO - Creating ORM DAG for conditional_dataset_and_time_based_timetable
[2024-09-08T18:56:05.278-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:56:05.278-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_2
[2024-09-08T18:56:05.279-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:56:05.279-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_1
[2024-09-08T18:56:05.279-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:56:05.279-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_unknown_never_scheduled
[2024-09-08T18:56:05.285-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:56:05.285-0300] {dag.py:4156} INFO - Setting next_dagrun for conditional_dataset_and_time_based_timetable to 2024-09-04 01:00:00+00:00, run_after=2024-09-04 01:00:00+00:00
[2024-09-08T18:56:05.286-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:56:05.286-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_and_2_with_dataset_expressions to None, run_after=None
[2024-09-08T18:56:05.286-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:56:05.286-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_2_with_dataset_expressions to None, run_after=None
[2024-09-08T18:56:05.287-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:56:05.286-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_both_2_and_3_with_dataset_expressions to None, run_after=None
[2024-09-08T18:56:05.287-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:56:05.287-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1 to None, run_after=None
[2024-09-08T18:56:05.287-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:56:05.287-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_and_2 to None, run_after=None
[2024-09-08T18:56:05.288-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:56:05.288-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_never_scheduled to None, run_after=None
[2024-09-08T18:56:05.288-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:56:05.288-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_unknown_never_scheduled to None, run_after=None
[2024-09-08T18:56:05.289-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:56:05.289-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_1 to 2024-09-07 00:00:00+00:00, run_after=2024-09-08 00:00:00+00:00
[2024-09-08T18:56:05.290-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:56:05.290-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_2 to None, run_after=None
[2024-09-08T18:56:05.686-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:56:05.685-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:56:05.687-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:56:05.687-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:56:05.689-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:56:05.688-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:56:05.690-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:56:05.689-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:56:05.691-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:56:05.690-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:56:05.692-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:56:05.691-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:56:05.693-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:56:05.692-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:56:05.694-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:56:05.693-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:56:05.695-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:56:05.694-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:56:05.696-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:56:05.695-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:56:05.696-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:56:05.696-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T18:56:05.697-0300] {processor.py:211} ERROR - Got an exception! Propagating...
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 207, in _run_file_processor
    _handle_dag_file_processing()
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 188, in _handle_dag_file_processing
    result: tuple[int, int, int] = dag_file_processor.process_file(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 942, in process_file
    serialize_errors = DagFileProcessor.save_dag_to_db(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/api_internal/internal_api_call.py", line 139, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 982, in save_dag_to_db
    import_errors = DagBag._sync_to_db(dags=dags, processor_subdir=dag_directory, session=session)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 707, in _sync_to_db
    for attempt in run_with_db_retries(logger=log):
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 443, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 723, in _sync_to_db
    DAG.bulk_write_to_db(dags.values(), processor_subdir=processor_subdir, session=session)
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dag.py", line 3242, in bulk_write_to_db
    orm_dags: list[DagModel] = session.scalars(query).unique().all()
                               ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1778, in scalars
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:57:25.039-0300] {processor.py:186} INFO - Started process (PID=174532) to work on /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T18:57:25.040-0300] {processor.py:914} INFO - Processing file /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py for tasks to queue
[2024-09-08T18:57:25.040-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:57:25.040-0300] {dagbag.py:587} INFO - Filling up the DagBag from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T18:57:25.051-0300] {processor.py:925} INFO - DAG(s) 'dataset_consumes_1', 'consume_1_and_2_with_dataset_expressions', 'consume_1_or_2_with_dataset_expressions', 'dataset_consumes_1_never_scheduled', 'dataset_consumes_unknown_never_scheduled', 'dataset_produces_2', 'dataset_consumes_1_and_2', 'consume_1_or_both_2_and_3_with_dataset_expressions', 'dataset_produces_1', 'conditional_dataset_and_time_based_timetable' retrieved from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T18:57:25.202-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:57:25.201-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T18:57:25.209-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:57:25.209-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_2_with_dataset_expressions
[2024-09-08T18:57:25.209-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:57:25.209-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_never_scheduled
[2024-09-08T18:57:25.210-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:57:25.210-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1
[2024-09-08T18:57:25.210-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:57:25.210-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_and_2_with_dataset_expressions
[2024-09-08T18:57:25.211-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:57:25.210-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_both_2_and_3_with_dataset_expressions
[2024-09-08T18:57:25.211-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:57:25.211-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_2
[2024-09-08T18:57:25.211-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:57:25.211-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_and_2
[2024-09-08T18:57:25.212-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:57:25.211-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_1
[2024-09-08T18:57:25.212-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:57:25.212-0300] {dag.py:3252} INFO - Creating ORM DAG for conditional_dataset_and_time_based_timetable
[2024-09-08T18:57:25.212-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:57:25.212-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_unknown_never_scheduled
[2024-09-08T18:57:25.219-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:57:25.218-0300] {dag.py:4156} INFO - Setting next_dagrun for conditional_dataset_and_time_based_timetable to 2024-09-04 01:00:00+00:00, run_after=2024-09-04 01:00:00+00:00
[2024-09-08T18:57:25.219-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:57:25.219-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_and_2_with_dataset_expressions to None, run_after=None
[2024-09-08T18:57:25.220-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:57:25.220-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_2_with_dataset_expressions to None, run_after=None
[2024-09-08T18:57:25.220-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:57:25.220-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_both_2_and_3_with_dataset_expressions to None, run_after=None
[2024-09-08T18:57:25.220-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:57:25.220-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1 to None, run_after=None
[2024-09-08T18:57:25.221-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:57:25.221-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_and_2 to None, run_after=None
[2024-09-08T18:57:25.221-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:57:25.221-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_never_scheduled to None, run_after=None
[2024-09-08T18:57:25.221-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:57:25.221-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_unknown_never_scheduled to None, run_after=None
[2024-09-08T18:57:25.223-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:57:25.222-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_1 to 2024-09-07 00:00:00+00:00, run_after=2024-09-08 00:00:00+00:00
[2024-09-08T18:57:25.223-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:57:25.223-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_2 to None, run_after=None
[2024-09-08T18:57:25.431-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:57:25.430-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:57:25.433-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:57:25.432-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:57:25.434-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:57:25.434-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:57:25.435-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:57:25.435-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:57:25.436-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:57:25.435-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:57:25.437-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:57:25.436-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:57:25.438-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:57:25.437-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:57:25.439-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:57:25.438-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:57:25.440-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:57:25.439-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:57:25.440-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:57:25.440-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:57:25.441-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:57:25.441-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T18:57:25.442-0300] {processor.py:211} ERROR - Got an exception! Propagating...
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 207, in _run_file_processor
    _handle_dag_file_processing()
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 188, in _handle_dag_file_processing
    result: tuple[int, int, int] = dag_file_processor.process_file(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 942, in process_file
    serialize_errors = DagFileProcessor.save_dag_to_db(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/api_internal/internal_api_call.py", line 139, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 982, in save_dag_to_db
    import_errors = DagBag._sync_to_db(dags=dags, processor_subdir=dag_directory, session=session)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 707, in _sync_to_db
    for attempt in run_with_db_retries(logger=log):
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 443, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 723, in _sync_to_db
    DAG.bulk_write_to_db(dags.values(), processor_subdir=processor_subdir, session=session)
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dag.py", line 3242, in bulk_write_to_db
    orm_dags: list[DagModel] = session.scalars(query).unique().all()
                               ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1778, in scalars
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:58:46.706-0300] {processor.py:186} INFO - Started process (PID=175161) to work on /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T18:58:46.713-0300] {processor.py:914} INFO - Processing file /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py for tasks to queue
[2024-09-08T18:58:46.714-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:58:46.714-0300] {dagbag.py:587} INFO - Filling up the DagBag from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T18:58:46.724-0300] {processor.py:925} INFO - DAG(s) 'dataset_consumes_1_and_2', 'dataset_consumes_1', 'dataset_consumes_unknown_never_scheduled', 'dataset_produces_2', 'consume_1_and_2_with_dataset_expressions', 'dataset_consumes_1_never_scheduled', 'consume_1_or_both_2_and_3_with_dataset_expressions', 'dataset_produces_1', 'conditional_dataset_and_time_based_timetable', 'consume_1_or_2_with_dataset_expressions' retrieved from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T18:58:46.894-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:58:46.893-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T18:58:46.902-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:58:46.902-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_2_with_dataset_expressions
[2024-09-08T18:58:46.903-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:58:46.903-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_never_scheduled
[2024-09-08T18:58:46.903-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:58:46.903-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1
[2024-09-08T18:58:46.904-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:58:46.904-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_and_2_with_dataset_expressions
[2024-09-08T18:58:46.904-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:58:46.904-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_both_2_and_3_with_dataset_expressions
[2024-09-08T18:58:46.904-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:58:46.904-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_and_2
[2024-09-08T18:58:46.905-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:58:46.905-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_2
[2024-09-08T18:58:46.905-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:58:46.905-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_1
[2024-09-08T18:58:46.906-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:58:46.905-0300] {dag.py:3252} INFO - Creating ORM DAG for conditional_dataset_and_time_based_timetable
[2024-09-08T18:58:46.906-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:58:46.906-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_unknown_never_scheduled
[2024-09-08T18:58:46.913-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:58:46.913-0300] {dag.py:4156} INFO - Setting next_dagrun for conditional_dataset_and_time_based_timetable to 2024-09-04 01:00:00+00:00, run_after=2024-09-04 01:00:00+00:00
[2024-09-08T18:58:46.914-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:58:46.914-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_and_2_with_dataset_expressions to None, run_after=None
[2024-09-08T18:58:46.914-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:58:46.914-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_2_with_dataset_expressions to None, run_after=None
[2024-09-08T18:58:46.915-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:58:46.914-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_both_2_and_3_with_dataset_expressions to None, run_after=None
[2024-09-08T18:58:46.915-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:58:46.915-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1 to None, run_after=None
[2024-09-08T18:58:46.915-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:58:46.915-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_and_2 to None, run_after=None
[2024-09-08T18:58:46.916-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:58:46.915-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_never_scheduled to None, run_after=None
[2024-09-08T18:58:46.916-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:58:46.916-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_unknown_never_scheduled to None, run_after=None
[2024-09-08T18:58:46.917-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:58:46.917-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_1 to 2024-09-07 00:00:00+00:00, run_after=2024-09-08 00:00:00+00:00
[2024-09-08T18:58:46.918-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:58:46.917-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_2 to None, run_after=None
[2024-09-08T18:58:47.099-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:58:47.097-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:58:47.100-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:58:47.099-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:58:47.101-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:58:47.100-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:58:47.102-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:58:47.101-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:58:47.103-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:58:47.102-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:58:47.103-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:58:47.103-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:58:47.104-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:58:47.104-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:58:47.105-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:58:47.105-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:58:47.106-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:58:47.106-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:58:47.107-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:58:47.107-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T18:58:47.108-0300] {logging_mixin.py:190} INFO - [2024-09-08T18:58:47.108-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T18:58:47.109-0300] {processor.py:211} ERROR - Got an exception! Propagating...
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 207, in _run_file_processor
    _handle_dag_file_processing()
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 188, in _handle_dag_file_processing
    result: tuple[int, int, int] = dag_file_processor.process_file(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 942, in process_file
    serialize_errors = DagFileProcessor.save_dag_to_db(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/api_internal/internal_api_call.py", line 139, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 982, in save_dag_to_db
    import_errors = DagBag._sync_to_db(dags=dags, processor_subdir=dag_directory, session=session)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 707, in _sync_to_db
    for attempt in run_with_db_retries(logger=log):
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 443, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 723, in _sync_to_db
    DAG.bulk_write_to_db(dags.values(), processor_subdir=processor_subdir, session=session)
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dag.py", line 3242, in bulk_write_to_db
    orm_dags: list[DagModel] = session.scalars(query).unique().all()
                               ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1778, in scalars
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T19:00:09.068-0300] {processor.py:186} INFO - Started process (PID=176229) to work on /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T19:00:09.069-0300] {processor.py:914} INFO - Processing file /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py for tasks to queue
[2024-09-08T19:00:09.070-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:00:09.070-0300] {dagbag.py:587} INFO - Filling up the DagBag from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T19:00:09.080-0300] {processor.py:925} INFO - DAG(s) 'dataset_consumes_1_never_scheduled', 'dataset_consumes_unknown_never_scheduled', 'dataset_consumes_1_and_2', 'dataset_produces_2', 'dataset_produces_1', 'consume_1_and_2_with_dataset_expressions', 'consume_1_or_both_2_and_3_with_dataset_expressions', 'conditional_dataset_and_time_based_timetable', 'dataset_consumes_1', 'consume_1_or_2_with_dataset_expressions' retrieved from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T19:00:09.233-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:00:09.233-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T19:00:09.240-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:00:09.240-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_2_with_dataset_expressions
[2024-09-08T19:00:09.241-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:00:09.241-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_never_scheduled
[2024-09-08T19:00:09.241-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:00:09.241-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1
[2024-09-08T19:00:09.241-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:00:09.241-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_and_2_with_dataset_expressions
[2024-09-08T19:00:09.242-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:00:09.242-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_both_2_and_3_with_dataset_expressions
[2024-09-08T19:00:09.242-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:00:09.242-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_and_2
[2024-09-08T19:00:09.243-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:00:09.242-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_2
[2024-09-08T19:00:09.243-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:00:09.243-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_1
[2024-09-08T19:00:09.243-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:00:09.243-0300] {dag.py:3252} INFO - Creating ORM DAG for conditional_dataset_and_time_based_timetable
[2024-09-08T19:00:09.244-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:00:09.243-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_unknown_never_scheduled
[2024-09-08T19:00:09.250-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:00:09.250-0300] {dag.py:4156} INFO - Setting next_dagrun for conditional_dataset_and_time_based_timetable to 2024-09-04 01:00:00+00:00, run_after=2024-09-04 01:00:00+00:00
[2024-09-08T19:00:09.250-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:00:09.250-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_and_2_with_dataset_expressions to None, run_after=None
[2024-09-08T19:00:09.251-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:00:09.251-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_2_with_dataset_expressions to None, run_after=None
[2024-09-08T19:00:09.251-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:00:09.251-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_both_2_and_3_with_dataset_expressions to None, run_after=None
[2024-09-08T19:00:09.251-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:00:09.251-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1 to None, run_after=None
[2024-09-08T19:00:09.251-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:00:09.251-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_and_2 to None, run_after=None
[2024-09-08T19:00:09.252-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:00:09.252-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_never_scheduled to None, run_after=None
[2024-09-08T19:00:09.252-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:00:09.252-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_unknown_never_scheduled to None, run_after=None
[2024-09-08T19:00:09.253-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:00:09.253-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_1 to 2024-09-07 00:00:00+00:00, run_after=2024-09-08 00:00:00+00:00
[2024-09-08T19:00:09.254-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:00:09.253-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_2 to None, run_after=None
[2024-09-08T19:00:09.585-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:00:09.584-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T19:00:09.586-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:00:09.586-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T19:00:09.588-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:00:09.587-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T19:00:09.589-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:00:09.588-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T19:00:09.590-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:00:09.589-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T19:00:09.590-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:00:09.590-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T19:00:09.592-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:00:09.591-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T19:00:09.593-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:00:09.592-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T19:00:09.594-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:00:09.593-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T19:00:09.595-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:00:09.594-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T19:00:09.595-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:00:09.595-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T19:00:09.596-0300] {processor.py:211} ERROR - Got an exception! Propagating...
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 207, in _run_file_processor
    _handle_dag_file_processing()
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 188, in _handle_dag_file_processing
    result: tuple[int, int, int] = dag_file_processor.process_file(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 942, in process_file
    serialize_errors = DagFileProcessor.save_dag_to_db(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/api_internal/internal_api_call.py", line 139, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 982, in save_dag_to_db
    import_errors = DagBag._sync_to_db(dags=dags, processor_subdir=dag_directory, session=session)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 707, in _sync_to_db
    for attempt in run_with_db_retries(logger=log):
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 443, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 723, in _sync_to_db
    DAG.bulk_write_to_db(dags.values(), processor_subdir=processor_subdir, session=session)
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dag.py", line 3242, in bulk_write_to_db
    orm_dags: list[DagModel] = session.scalars(query).unique().all()
                               ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1778, in scalars
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T19:01:32.522-0300] {processor.py:186} INFO - Started process (PID=176916) to work on /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T19:01:32.522-0300] {processor.py:914} INFO - Processing file /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py for tasks to queue
[2024-09-08T19:01:32.523-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:01:32.523-0300] {dagbag.py:587} INFO - Filling up the DagBag from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T19:01:32.534-0300] {processor.py:925} INFO - DAG(s) 'dataset_produces_1', 'dataset_consumes_1_never_scheduled', 'dataset_produces_2', 'consume_1_or_both_2_and_3_with_dataset_expressions', 'dataset_consumes_1_and_2', 'conditional_dataset_and_time_based_timetable', 'consume_1_and_2_with_dataset_expressions', 'consume_1_or_2_with_dataset_expressions', 'dataset_consumes_1', 'dataset_consumes_unknown_never_scheduled' retrieved from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T19:01:32.707-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:01:32.707-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T19:01:32.716-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:01:32.716-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_2_with_dataset_expressions
[2024-09-08T19:01:32.716-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:01:32.716-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_never_scheduled
[2024-09-08T19:01:32.717-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:01:32.717-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1
[2024-09-08T19:01:32.717-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:01:32.717-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_both_2_and_3_with_dataset_expressions
[2024-09-08T19:01:32.717-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:01:32.717-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_and_2_with_dataset_expressions
[2024-09-08T19:01:32.718-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:01:32.718-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_1
[2024-09-08T19:01:32.718-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:01:32.718-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_2
[2024-09-08T19:01:32.718-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:01:32.718-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_and_2
[2024-09-08T19:01:32.719-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:01:32.719-0300] {dag.py:3252} INFO - Creating ORM DAG for conditional_dataset_and_time_based_timetable
[2024-09-08T19:01:32.719-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:01:32.719-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_unknown_never_scheduled
[2024-09-08T19:01:32.726-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:01:32.726-0300] {dag.py:4156} INFO - Setting next_dagrun for conditional_dataset_and_time_based_timetable to 2024-09-04 01:00:00+00:00, run_after=2024-09-04 01:00:00+00:00
[2024-09-08T19:01:32.726-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:01:32.726-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_and_2_with_dataset_expressions to None, run_after=None
[2024-09-08T19:01:32.727-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:01:32.727-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_2_with_dataset_expressions to None, run_after=None
[2024-09-08T19:01:32.727-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:01:32.727-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_both_2_and_3_with_dataset_expressions to None, run_after=None
[2024-09-08T19:01:32.727-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:01:32.727-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1 to None, run_after=None
[2024-09-08T19:01:32.727-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:01:32.727-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_and_2 to None, run_after=None
[2024-09-08T19:01:32.728-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:01:32.728-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_never_scheduled to None, run_after=None
[2024-09-08T19:01:32.728-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:01:32.728-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_unknown_never_scheduled to None, run_after=None
[2024-09-08T19:01:32.730-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:01:32.730-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_1 to 2024-09-07 00:00:00+00:00, run_after=2024-09-08 00:00:00+00:00
[2024-09-08T19:01:32.730-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:01:32.730-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_2 to None, run_after=None
[2024-09-08T19:01:32.961-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:01:32.960-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T19:01:32.962-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:01:32.962-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T19:01:32.963-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:01:32.963-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T19:01:32.964-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:01:32.964-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T19:01:32.966-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:01:32.965-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T19:01:32.967-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:01:32.966-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T19:01:32.968-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:01:32.968-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T19:01:32.970-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:01:32.969-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T19:01:32.971-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:01:32.971-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T19:01:32.973-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:01:32.972-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T19:01:32.974-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:01:32.973-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T19:01:32.975-0300] {processor.py:211} ERROR - Got an exception! Propagating...
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 207, in _run_file_processor
    _handle_dag_file_processing()
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 188, in _handle_dag_file_processing
    result: tuple[int, int, int] = dag_file_processor.process_file(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 942, in process_file
    serialize_errors = DagFileProcessor.save_dag_to_db(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/api_internal/internal_api_call.py", line 139, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 982, in save_dag_to_db
    import_errors = DagBag._sync_to_db(dags=dags, processor_subdir=dag_directory, session=session)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 707, in _sync_to_db
    for attempt in run_with_db_retries(logger=log):
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 443, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 723, in _sync_to_db
    DAG.bulk_write_to_db(dags.values(), processor_subdir=processor_subdir, session=session)
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dag.py", line 3242, in bulk_write_to_db
    orm_dags: list[DagModel] = session.scalars(query).unique().all()
                               ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1778, in scalars
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T19:02:56.016-0300] {processor.py:186} INFO - Started process (PID=177710) to work on /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T19:02:56.016-0300] {processor.py:914} INFO - Processing file /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py for tasks to queue
[2024-09-08T19:02:56.017-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:02:56.017-0300] {dagbag.py:587} INFO - Filling up the DagBag from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T19:02:56.028-0300] {processor.py:925} INFO - DAG(s) 'consume_1_or_2_with_dataset_expressions', 'conditional_dataset_and_time_based_timetable', 'dataset_consumes_1', 'consume_1_or_both_2_and_3_with_dataset_expressions', 'dataset_consumes_unknown_never_scheduled', 'dataset_produces_1', 'dataset_consumes_1_never_scheduled', 'dataset_produces_2', 'consume_1_and_2_with_dataset_expressions', 'dataset_consumes_1_and_2' retrieved from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T19:02:56.187-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:02:56.187-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T19:02:56.196-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:02:56.196-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_2_with_dataset_expressions
[2024-09-08T19:02:56.197-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:02:56.197-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_never_scheduled
[2024-09-08T19:02:56.197-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:02:56.197-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1
[2024-09-08T19:02:56.198-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:02:56.198-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_both_2_and_3_with_dataset_expressions
[2024-09-08T19:02:56.198-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:02:56.198-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_and_2_with_dataset_expressions
[2024-09-08T19:02:56.198-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:02:56.198-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_1
[2024-09-08T19:02:56.199-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:02:56.199-0300] {dag.py:3252} INFO - Creating ORM DAG for conditional_dataset_and_time_based_timetable
[2024-09-08T19:02:56.199-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:02:56.199-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_2
[2024-09-08T19:02:56.200-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:02:56.200-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_and_2
[2024-09-08T19:02:56.200-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:02:56.200-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_unknown_never_scheduled
[2024-09-08T19:02:56.208-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:02:56.208-0300] {dag.py:4156} INFO - Setting next_dagrun for conditional_dataset_and_time_based_timetable to 2024-09-04 01:00:00+00:00, run_after=2024-09-04 01:00:00+00:00
[2024-09-08T19:02:56.209-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:02:56.209-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_and_2_with_dataset_expressions to None, run_after=None
[2024-09-08T19:02:56.209-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:02:56.209-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_2_with_dataset_expressions to None, run_after=None
[2024-09-08T19:02:56.209-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:02:56.209-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_both_2_and_3_with_dataset_expressions to None, run_after=None
[2024-09-08T19:02:56.210-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:02:56.210-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1 to None, run_after=None
[2024-09-08T19:02:56.210-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:02:56.210-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_and_2 to None, run_after=None
[2024-09-08T19:02:56.210-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:02:56.210-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_never_scheduled to None, run_after=None
[2024-09-08T19:02:56.211-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:02:56.211-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_unknown_never_scheduled to None, run_after=None
[2024-09-08T19:02:56.213-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:02:56.212-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_1 to 2024-09-07 00:00:00+00:00, run_after=2024-09-08 00:00:00+00:00
[2024-09-08T19:02:56.213-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:02:56.213-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_2 to None, run_after=None
[2024-09-08T19:02:56.681-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:02:56.679-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T19:02:56.682-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:02:56.681-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T19:02:56.683-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:02:56.682-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T19:02:56.683-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:02:56.683-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T19:02:56.684-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:02:56.684-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T19:02:56.685-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:02:56.685-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T19:02:56.687-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:02:56.686-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T19:02:56.688-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:02:56.687-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T19:02:56.689-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:02:56.688-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T19:02:56.690-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:02:56.689-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T19:02:56.690-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:02:56.690-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T19:02:56.691-0300] {processor.py:211} ERROR - Got an exception! Propagating...
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 207, in _run_file_processor
    _handle_dag_file_processing()
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 188, in _handle_dag_file_processing
    result: tuple[int, int, int] = dag_file_processor.process_file(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 942, in process_file
    serialize_errors = DagFileProcessor.save_dag_to_db(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/api_internal/internal_api_call.py", line 139, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 982, in save_dag_to_db
    import_errors = DagBag._sync_to_db(dags=dags, processor_subdir=dag_directory, session=session)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 707, in _sync_to_db
    for attempt in run_with_db_retries(logger=log):
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 443, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 723, in _sync_to_db
    DAG.bulk_write_to_db(dags.values(), processor_subdir=processor_subdir, session=session)
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dag.py", line 3242, in bulk_write_to_db
    orm_dags: list[DagModel] = session.scalars(query).unique().all()
                               ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1778, in scalars
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T19:04:18.930-0300] {processor.py:186} INFO - Started process (PID=178413) to work on /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T19:04:18.931-0300] {processor.py:914} INFO - Processing file /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py for tasks to queue
[2024-09-08T19:04:18.932-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:04:18.932-0300] {dagbag.py:587} INFO - Filling up the DagBag from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T19:04:18.945-0300] {processor.py:925} INFO - DAG(s) 'consume_1_and_2_with_dataset_expressions', 'dataset_consumes_unknown_never_scheduled', 'consume_1_or_both_2_and_3_with_dataset_expressions', 'conditional_dataset_and_time_based_timetable', 'dataset_consumes_1_and_2', 'dataset_produces_2', 'dataset_produces_1', 'consume_1_or_2_with_dataset_expressions', 'dataset_consumes_1', 'dataset_consumes_1_never_scheduled' retrieved from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T19:04:19.118-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:04:19.118-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T19:04:19.126-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:04:19.126-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_2_with_dataset_expressions
[2024-09-08T19:04:19.126-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:04:19.126-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_never_scheduled
[2024-09-08T19:04:19.126-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:04:19.126-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1
[2024-09-08T19:04:19.127-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:04:19.127-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_and_2_with_dataset_expressions
[2024-09-08T19:04:19.127-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:04:19.127-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_both_2_and_3_with_dataset_expressions
[2024-09-08T19:04:19.128-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:04:19.127-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_and_2
[2024-09-08T19:04:19.128-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:04:19.128-0300] {dag.py:3252} INFO - Creating ORM DAG for conditional_dataset_and_time_based_timetable
[2024-09-08T19:04:19.128-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:04:19.128-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_2
[2024-09-08T19:04:19.129-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:04:19.129-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_1
[2024-09-08T19:04:19.129-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:04:19.129-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_unknown_never_scheduled
[2024-09-08T19:04:19.138-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:04:19.137-0300] {dag.py:4156} INFO - Setting next_dagrun for conditional_dataset_and_time_based_timetable to 2024-09-04 01:00:00+00:00, run_after=2024-09-04 01:00:00+00:00
[2024-09-08T19:04:19.138-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:04:19.138-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_and_2_with_dataset_expressions to None, run_after=None
[2024-09-08T19:04:19.138-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:04:19.138-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_2_with_dataset_expressions to None, run_after=None
[2024-09-08T19:04:19.139-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:04:19.138-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_both_2_and_3_with_dataset_expressions to None, run_after=None
[2024-09-08T19:04:19.139-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:04:19.139-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1 to None, run_after=None
[2024-09-08T19:04:19.139-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:04:19.139-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_and_2 to None, run_after=None
[2024-09-08T19:04:19.140-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:04:19.139-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_never_scheduled to None, run_after=None
[2024-09-08T19:04:19.140-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:04:19.140-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_unknown_never_scheduled to None, run_after=None
[2024-09-08T19:04:19.141-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:04:19.141-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_1 to 2024-09-07 00:00:00+00:00, run_after=2024-09-08 00:00:00+00:00
[2024-09-08T19:04:19.142-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:04:19.142-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_2 to None, run_after=None
[2024-09-08T19:04:19.464-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:04:19.462-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T19:04:19.465-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:04:19.464-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T19:04:19.466-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:04:19.466-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T19:04:19.467-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:04:19.467-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T19:04:19.469-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:04:19.468-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T19:04:19.470-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:04:19.469-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T19:04:19.471-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:04:19.470-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T19:04:19.472-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:04:19.471-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T19:04:19.473-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:04:19.472-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T19:04:19.474-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:04:19.473-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T19:04:19.474-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:04:19.474-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T19:04:19.475-0300] {processor.py:211} ERROR - Got an exception! Propagating...
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 207, in _run_file_processor
    _handle_dag_file_processing()
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 188, in _handle_dag_file_processing
    result: tuple[int, int, int] = dag_file_processor.process_file(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 942, in process_file
    serialize_errors = DagFileProcessor.save_dag_to_db(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/api_internal/internal_api_call.py", line 139, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 982, in save_dag_to_db
    import_errors = DagBag._sync_to_db(dags=dags, processor_subdir=dag_directory, session=session)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 707, in _sync_to_db
    for attempt in run_with_db_retries(logger=log):
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 443, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 723, in _sync_to_db
    DAG.bulk_write_to_db(dags.values(), processor_subdir=processor_subdir, session=session)
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dag.py", line 3242, in bulk_write_to_db
    orm_dags: list[DagModel] = session.scalars(query).unique().all()
                               ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1778, in scalars
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T19:05:41.469-0300] {processor.py:186} INFO - Started process (PID=179050) to work on /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T19:05:41.470-0300] {processor.py:914} INFO - Processing file /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py for tasks to queue
[2024-09-08T19:05:41.472-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:05:41.471-0300] {dagbag.py:587} INFO - Filling up the DagBag from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T19:05:41.487-0300] {processor.py:925} INFO - DAG(s) 'dataset_consumes_1_never_scheduled', 'dataset_produces_1', 'dataset_produces_2', 'conditional_dataset_and_time_based_timetable', 'dataset_consumes_1_and_2', 'consume_1_or_both_2_and_3_with_dataset_expressions', 'consume_1_or_2_with_dataset_expressions', 'consume_1_and_2_with_dataset_expressions', 'dataset_consumes_1', 'dataset_consumes_unknown_never_scheduled' retrieved from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T19:05:41.690-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:05:41.690-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T19:05:41.700-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:05:41.700-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_2_with_dataset_expressions
[2024-09-08T19:05:41.701-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:05:41.701-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_never_scheduled
[2024-09-08T19:05:41.701-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:05:41.701-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1
[2024-09-08T19:05:41.701-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:05:41.701-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_both_2_and_3_with_dataset_expressions
[2024-09-08T19:05:41.702-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:05:41.702-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_and_2_with_dataset_expressions
[2024-09-08T19:05:41.702-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:05:41.702-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_1
[2024-09-08T19:05:41.702-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:05:41.702-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_2
[2024-09-08T19:05:41.703-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:05:41.703-0300] {dag.py:3252} INFO - Creating ORM DAG for conditional_dataset_and_time_based_timetable
[2024-09-08T19:05:41.703-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:05:41.703-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_and_2
[2024-09-08T19:05:41.704-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:05:41.703-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_unknown_never_scheduled
[2024-09-08T19:05:41.712-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:05:41.712-0300] {dag.py:4156} INFO - Setting next_dagrun for conditional_dataset_and_time_based_timetable to 2024-09-04 01:00:00+00:00, run_after=2024-09-04 01:00:00+00:00
[2024-09-08T19:05:41.713-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:05:41.713-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_and_2_with_dataset_expressions to None, run_after=None
[2024-09-08T19:05:41.713-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:05:41.713-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_2_with_dataset_expressions to None, run_after=None
[2024-09-08T19:05:41.715-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:05:41.713-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_both_2_and_3_with_dataset_expressions to None, run_after=None
[2024-09-08T19:05:41.715-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:05:41.715-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1 to None, run_after=None
[2024-09-08T19:05:41.716-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:05:41.715-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_and_2 to None, run_after=None
[2024-09-08T19:05:41.716-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:05:41.716-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_never_scheduled to None, run_after=None
[2024-09-08T19:05:41.716-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:05:41.716-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_unknown_never_scheduled to None, run_after=None
[2024-09-08T19:05:41.717-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:05:41.717-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_1 to 2024-09-07 00:00:00+00:00, run_after=2024-09-08 00:00:00+00:00
[2024-09-08T19:05:41.718-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:05:41.718-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_2 to None, run_after=None
[2024-09-08T19:05:42.193-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:05:42.192-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T19:05:42.194-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:05:42.194-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T19:05:42.195-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:05:42.195-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T19:05:42.197-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:05:42.196-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T19:05:42.198-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:05:42.197-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T19:05:42.199-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:05:42.198-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T19:05:42.200-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:05:42.199-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T19:05:42.201-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:05:42.200-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T19:05:42.202-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:05:42.202-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T19:05:42.203-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:05:42.203-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T19:05:42.203-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:05:42.203-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T19:05:42.204-0300] {processor.py:211} ERROR - Got an exception! Propagating...
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 207, in _run_file_processor
    _handle_dag_file_processing()
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 188, in _handle_dag_file_processing
    result: tuple[int, int, int] = dag_file_processor.process_file(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 942, in process_file
    serialize_errors = DagFileProcessor.save_dag_to_db(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/api_internal/internal_api_call.py", line 139, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 982, in save_dag_to_db
    import_errors = DagBag._sync_to_db(dags=dags, processor_subdir=dag_directory, session=session)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 707, in _sync_to_db
    for attempt in run_with_db_retries(logger=log):
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 443, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 723, in _sync_to_db
    DAG.bulk_write_to_db(dags.values(), processor_subdir=processor_subdir, session=session)
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dag.py", line 3242, in bulk_write_to_db
    orm_dags: list[DagModel] = session.scalars(query).unique().all()
                               ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1778, in scalars
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T19:07:01.358-0300] {processor.py:186} INFO - Started process (PID=179687) to work on /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T19:07:01.359-0300] {processor.py:914} INFO - Processing file /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py for tasks to queue
[2024-09-08T19:07:01.360-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:07:01.359-0300] {dagbag.py:587} INFO - Filling up the DagBag from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T19:07:01.370-0300] {processor.py:925} INFO - DAG(s) 'dataset_produces_2', 'consume_1_and_2_with_dataset_expressions', 'consume_1_or_both_2_and_3_with_dataset_expressions', 'dataset_consumes_1_never_scheduled', 'dataset_consumes_unknown_never_scheduled', 'consume_1_or_2_with_dataset_expressions', 'dataset_consumes_1_and_2', 'conditional_dataset_and_time_based_timetable', 'dataset_consumes_1', 'dataset_produces_1' retrieved from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T19:07:01.534-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:07:01.534-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T19:07:01.543-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:07:01.543-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_2_with_dataset_expressions
[2024-09-08T19:07:01.544-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:07:01.543-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_never_scheduled
[2024-09-08T19:07:01.544-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:07:01.544-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1
[2024-09-08T19:07:01.544-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:07:01.544-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_and_2_with_dataset_expressions
[2024-09-08T19:07:01.545-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:07:01.545-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_both_2_and_3_with_dataset_expressions
[2024-09-08T19:07:01.545-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:07:01.545-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_2
[2024-09-08T19:07:01.546-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:07:01.545-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_and_2
[2024-09-08T19:07:01.546-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:07:01.546-0300] {dag.py:3252} INFO - Creating ORM DAG for conditional_dataset_and_time_based_timetable
[2024-09-08T19:07:01.546-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:07:01.546-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_1
[2024-09-08T19:07:01.547-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:07:01.547-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_unknown_never_scheduled
[2024-09-08T19:07:01.554-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:07:01.554-0300] {dag.py:4156} INFO - Setting next_dagrun for conditional_dataset_and_time_based_timetable to 2024-09-04 01:00:00+00:00, run_after=2024-09-04 01:00:00+00:00
[2024-09-08T19:07:01.554-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:07:01.554-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_and_2_with_dataset_expressions to None, run_after=None
[2024-09-08T19:07:01.554-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:07:01.554-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_2_with_dataset_expressions to None, run_after=None
[2024-09-08T19:07:01.555-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:07:01.555-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_both_2_and_3_with_dataset_expressions to None, run_after=None
[2024-09-08T19:07:01.555-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:07:01.555-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1 to None, run_after=None
[2024-09-08T19:07:01.556-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:07:01.555-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_and_2 to None, run_after=None
[2024-09-08T19:07:01.556-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:07:01.556-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_never_scheduled to None, run_after=None
[2024-09-08T19:07:01.556-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:07:01.556-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_unknown_never_scheduled to None, run_after=None
[2024-09-08T19:07:01.558-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:07:01.557-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_1 to 2024-09-07 00:00:00+00:00, run_after=2024-09-08 00:00:00+00:00
[2024-09-08T19:07:01.558-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:07:01.558-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_2 to None, run_after=None
[2024-09-08T19:07:01.895-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:07:01.893-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T19:07:01.896-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:07:01.895-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T19:07:01.897-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:07:01.896-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T19:07:01.898-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:07:01.897-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T19:07:01.899-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:07:01.898-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T19:07:01.900-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:07:01.899-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T19:07:01.901-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:07:01.900-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T19:07:01.902-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:07:01.902-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T19:07:01.903-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:07:01.903-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T19:07:01.904-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:07:01.904-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T19:07:01.905-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:07:01.905-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T19:07:01.906-0300] {processor.py:211} ERROR - Got an exception! Propagating...
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 207, in _run_file_processor
    _handle_dag_file_processing()
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 188, in _handle_dag_file_processing
    result: tuple[int, int, int] = dag_file_processor.process_file(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 942, in process_file
    serialize_errors = DagFileProcessor.save_dag_to_db(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/api_internal/internal_api_call.py", line 139, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 982, in save_dag_to_db
    import_errors = DagBag._sync_to_db(dags=dags, processor_subdir=dag_directory, session=session)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 707, in _sync_to_db
    for attempt in run_with_db_retries(logger=log):
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 443, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 723, in _sync_to_db
    DAG.bulk_write_to_db(dags.values(), processor_subdir=processor_subdir, session=session)
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dag.py", line 3242, in bulk_write_to_db
    orm_dags: list[DagModel] = session.scalars(query).unique().all()
                               ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1778, in scalars
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T19:08:21.169-0300] {processor.py:186} INFO - Started process (PID=180719) to work on /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T19:08:21.170-0300] {processor.py:914} INFO - Processing file /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py for tasks to queue
[2024-09-08T19:08:21.171-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:08:21.170-0300] {dagbag.py:587} INFO - Filling up the DagBag from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T19:08:21.182-0300] {processor.py:925} INFO - DAG(s) 'dataset_consumes_1', 'dataset_produces_1', 'dataset_consumes_unknown_never_scheduled', 'dataset_produces_2', 'consume_1_and_2_with_dataset_expressions', 'dataset_consumes_1_never_scheduled', 'consume_1_or_both_2_and_3_with_dataset_expressions', 'dataset_consumes_1_and_2', 'consume_1_or_2_with_dataset_expressions', 'conditional_dataset_and_time_based_timetable' retrieved from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T19:08:21.336-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:08:21.335-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T19:08:21.343-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:08:21.343-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_2_with_dataset_expressions
[2024-09-08T19:08:21.343-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:08:21.343-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_never_scheduled
[2024-09-08T19:08:21.344-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:08:21.344-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1
[2024-09-08T19:08:21.344-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:08:21.344-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_and_2_with_dataset_expressions
[2024-09-08T19:08:21.344-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:08:21.344-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_both_2_and_3_with_dataset_expressions
[2024-09-08T19:08:21.345-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:08:21.345-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_1
[2024-09-08T19:08:21.345-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:08:21.345-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_2
[2024-09-08T19:08:21.345-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:08:21.345-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_and_2
[2024-09-08T19:08:21.346-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:08:21.346-0300] {dag.py:3252} INFO - Creating ORM DAG for conditional_dataset_and_time_based_timetable
[2024-09-08T19:08:21.346-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:08:21.346-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_unknown_never_scheduled
[2024-09-08T19:08:21.353-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:08:21.353-0300] {dag.py:4156} INFO - Setting next_dagrun for conditional_dataset_and_time_based_timetable to 2024-09-04 01:00:00+00:00, run_after=2024-09-04 01:00:00+00:00
[2024-09-08T19:08:21.354-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:08:21.354-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_and_2_with_dataset_expressions to None, run_after=None
[2024-09-08T19:08:21.354-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:08:21.354-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_2_with_dataset_expressions to None, run_after=None
[2024-09-08T19:08:21.354-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:08:21.354-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_both_2_and_3_with_dataset_expressions to None, run_after=None
[2024-09-08T19:08:21.355-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:08:21.355-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1 to None, run_after=None
[2024-09-08T19:08:21.355-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:08:21.355-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_and_2 to None, run_after=None
[2024-09-08T19:08:21.355-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:08:21.355-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_never_scheduled to None, run_after=None
[2024-09-08T19:08:21.356-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:08:21.356-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_unknown_never_scheduled to None, run_after=None
[2024-09-08T19:08:21.357-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:08:21.357-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_1 to 2024-09-07 00:00:00+00:00, run_after=2024-09-08 00:00:00+00:00
[2024-09-08T19:08:21.357-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:08:21.357-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_2 to None, run_after=None
[2024-09-08T19:08:21.862-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:08:21.860-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T19:08:21.863-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:08:21.862-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T19:08:21.864-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:08:21.863-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T19:08:21.865-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:08:21.864-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T19:08:21.866-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:08:21.865-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T19:08:21.866-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:08:21.866-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T19:08:21.867-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:08:21.867-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T19:08:21.868-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:08:21.868-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T19:08:21.869-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:08:21.869-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T19:08:21.870-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:08:21.870-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T19:08:21.871-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:08:21.871-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T19:08:21.872-0300] {processor.py:211} ERROR - Got an exception! Propagating...
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 207, in _run_file_processor
    _handle_dag_file_processing()
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 188, in _handle_dag_file_processing
    result: tuple[int, int, int] = dag_file_processor.process_file(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 942, in process_file
    serialize_errors = DagFileProcessor.save_dag_to_db(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/api_internal/internal_api_call.py", line 139, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 982, in save_dag_to_db
    import_errors = DagBag._sync_to_db(dags=dags, processor_subdir=dag_directory, session=session)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 707, in _sync_to_db
    for attempt in run_with_db_retries(logger=log):
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 443, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 723, in _sync_to_db
    DAG.bulk_write_to_db(dags.values(), processor_subdir=processor_subdir, session=session)
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dag.py", line 3242, in bulk_write_to_db
    orm_dags: list[DagModel] = session.scalars(query).unique().all()
                               ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1778, in scalars
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T19:09:42.596-0300] {processor.py:186} INFO - Started process (PID=181590) to work on /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T19:09:42.597-0300] {processor.py:914} INFO - Processing file /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py for tasks to queue
[2024-09-08T19:09:42.598-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:09:42.598-0300] {dagbag.py:587} INFO - Filling up the DagBag from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T19:09:42.609-0300] {processor.py:925} INFO - DAG(s) 'conditional_dataset_and_time_based_timetable', 'dataset_produces_2', 'consume_1_or_both_2_and_3_with_dataset_expressions', 'consume_1_or_2_with_dataset_expressions', 'consume_1_and_2_with_dataset_expressions', 'dataset_consumes_1', 'dataset_consumes_unknown_never_scheduled', 'dataset_produces_1', 'dataset_consumes_1_and_2', 'dataset_consumes_1_never_scheduled' retrieved from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T19:09:42.777-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:09:42.776-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T19:09:42.785-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:09:42.785-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_2_with_dataset_expressions
[2024-09-08T19:09:42.785-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:09:42.785-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_never_scheduled
[2024-09-08T19:09:42.786-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:09:42.786-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1
[2024-09-08T19:09:42.786-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:09:42.786-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_both_2_and_3_with_dataset_expressions
[2024-09-08T19:09:42.787-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:09:42.787-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_and_2_with_dataset_expressions
[2024-09-08T19:09:42.787-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:09:42.787-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_2
[2024-09-08T19:09:42.787-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:09:42.787-0300] {dag.py:3252} INFO - Creating ORM DAG for conditional_dataset_and_time_based_timetable
[2024-09-08T19:09:42.788-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:09:42.788-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_1
[2024-09-08T19:09:42.788-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:09:42.788-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_and_2
[2024-09-08T19:09:42.788-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:09:42.788-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_unknown_never_scheduled
[2024-09-08T19:09:42.796-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:09:42.795-0300] {dag.py:4156} INFO - Setting next_dagrun for conditional_dataset_and_time_based_timetable to 2024-09-04 01:00:00+00:00, run_after=2024-09-04 01:00:00+00:00
[2024-09-08T19:09:42.796-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:09:42.796-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_and_2_with_dataset_expressions to None, run_after=None
[2024-09-08T19:09:42.796-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:09:42.796-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_2_with_dataset_expressions to None, run_after=None
[2024-09-08T19:09:42.797-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:09:42.796-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_both_2_and_3_with_dataset_expressions to None, run_after=None
[2024-09-08T19:09:42.797-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:09:42.797-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1 to None, run_after=None
[2024-09-08T19:09:42.797-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:09:42.797-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_and_2 to None, run_after=None
[2024-09-08T19:09:42.798-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:09:42.798-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_never_scheduled to None, run_after=None
[2024-09-08T19:09:42.798-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:09:42.798-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_unknown_never_scheduled to None, run_after=None
[2024-09-08T19:09:42.800-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:09:42.800-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_1 to 2024-09-07 00:00:00+00:00, run_after=2024-09-08 00:00:00+00:00
[2024-09-08T19:09:42.800-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:09:42.800-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_2 to None, run_after=None
[2024-09-08T19:09:43.247-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:09:43.245-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T19:09:43.248-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:09:43.247-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T19:09:43.249-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:09:43.249-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T19:09:43.250-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:09:43.250-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T19:09:43.252-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:09:43.251-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T19:09:43.254-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:09:43.253-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T19:09:43.255-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:09:43.254-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T19:09:43.256-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:09:43.256-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T19:09:43.257-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:09:43.257-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T19:09:43.258-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:09:43.258-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T19:09:43.258-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:09:43.258-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T19:09:43.259-0300] {processor.py:211} ERROR - Got an exception! Propagating...
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 207, in _run_file_processor
    _handle_dag_file_processing()
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 188, in _handle_dag_file_processing
    result: tuple[int, int, int] = dag_file_processor.process_file(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 942, in process_file
    serialize_errors = DagFileProcessor.save_dag_to_db(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/api_internal/internal_api_call.py", line 139, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 982, in save_dag_to_db
    import_errors = DagBag._sync_to_db(dags=dags, processor_subdir=dag_directory, session=session)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 707, in _sync_to_db
    for attempt in run_with_db_retries(logger=log):
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 443, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 723, in _sync_to_db
    DAG.bulk_write_to_db(dags.values(), processor_subdir=processor_subdir, session=session)
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dag.py", line 3242, in bulk_write_to_db
    orm_dags: list[DagModel] = session.scalars(query).unique().all()
                               ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1778, in scalars
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T19:11:01.145-0300] {processor.py:186} INFO - Started process (PID=182119) to work on /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T19:11:01.146-0300] {processor.py:914} INFO - Processing file /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py for tasks to queue
[2024-09-08T19:11:01.147-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:11:01.147-0300] {dagbag.py:587} INFO - Filling up the DagBag from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T19:11:01.157-0300] {processor.py:925} INFO - DAG(s) 'dataset_consumes_1', 'conditional_dataset_and_time_based_timetable', 'consume_1_or_2_with_dataset_expressions', 'dataset_consumes_unknown_never_scheduled', 'dataset_produces_2', 'consume_1_or_both_2_and_3_with_dataset_expressions', 'dataset_produces_1', 'consume_1_and_2_with_dataset_expressions', 'dataset_consumes_1_never_scheduled', 'dataset_consumes_1_and_2' retrieved from /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
[2024-09-08T19:11:01.339-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:11:01.339-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T19:11:01.347-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:11:01.347-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_2_with_dataset_expressions
[2024-09-08T19:11:01.348-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:11:01.347-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_never_scheduled
[2024-09-08T19:11:01.348-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:11:01.348-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1
[2024-09-08T19:11:01.348-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:11:01.348-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_or_both_2_and_3_with_dataset_expressions
[2024-09-08T19:11:01.349-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:11:01.349-0300] {dag.py:3252} INFO - Creating ORM DAG for consume_1_and_2_with_dataset_expressions
[2024-09-08T19:11:01.349-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:11:01.349-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_2
[2024-09-08T19:11:01.350-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:11:01.349-0300] {dag.py:3252} INFO - Creating ORM DAG for conditional_dataset_and_time_based_timetable
[2024-09-08T19:11:01.350-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:11:01.350-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_produces_1
[2024-09-08T19:11:01.350-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:11:01.350-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_1_and_2
[2024-09-08T19:11:01.351-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:11:01.351-0300] {dag.py:3252} INFO - Creating ORM DAG for dataset_consumes_unknown_never_scheduled
[2024-09-08T19:11:01.357-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:11:01.357-0300] {dag.py:4156} INFO - Setting next_dagrun for conditional_dataset_and_time_based_timetable to 2024-09-04 01:00:00+00:00, run_after=2024-09-04 01:00:00+00:00
[2024-09-08T19:11:01.358-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:11:01.358-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_and_2_with_dataset_expressions to None, run_after=None
[2024-09-08T19:11:01.358-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:11:01.358-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_2_with_dataset_expressions to None, run_after=None
[2024-09-08T19:11:01.358-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:11:01.358-0300] {dag.py:4156} INFO - Setting next_dagrun for consume_1_or_both_2_and_3_with_dataset_expressions to None, run_after=None
[2024-09-08T19:11:01.359-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:11:01.358-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1 to None, run_after=None
[2024-09-08T19:11:01.359-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:11:01.359-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_and_2 to None, run_after=None
[2024-09-08T19:11:01.359-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:11:01.359-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_1_never_scheduled to None, run_after=None
[2024-09-08T19:11:01.360-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:11:01.359-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_consumes_unknown_never_scheduled to None, run_after=None
[2024-09-08T19:11:01.361-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:11:01.361-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_1 to 2024-09-07 00:00:00+00:00, run_after=2024-09-08 00:00:00+00:00
[2024-09-08T19:11:01.361-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:11:01.361-0300] {dag.py:4156} INFO - Setting next_dagrun for dataset_produces_2 to None, run_after=None
[2024-09-08T19:11:01.739-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:11:01.737-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T19:11:01.740-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:11:01.739-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T19:11:01.741-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:11:01.740-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T19:11:01.741-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:11:01.741-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T19:11:01.742-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:11:01.742-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T19:11:01.743-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:11:01.743-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T19:11:01.744-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:11:01.744-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T19:11:01.745-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:11:01.745-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T19:11:01.746-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:11:01.746-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T19:11:01.747-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:11:01.747-0300] {dagbag.py:697} ERROR - Failed to write serialized DAG: /home/kasten/.local/lib/python3.12/site-packages/airflow/example_dags/example_datasets.py
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 685, in _serialize_dag_capturing_errors
    dag_was_updated = SerializedDagModel.write_dag(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/serialized_dag.py", line 160, in write_dag
    if session.scalar(
       ^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
[2024-09-08T19:11:01.747-0300] {logging_mixin.py:190} INFO - [2024-09-08T19:11:01.747-0300] {dag.py:3229} INFO - Sync 10 DAGs
[2024-09-08T19:11:01.748-0300] {processor.py:211} ERROR - Got an exception! Propagating...
Traceback (most recent call last):
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 207, in _run_file_processor
    _handle_dag_file_processing()
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 188, in _handle_dag_file_processing
    result: tuple[int, int, int] = dag_file_processor.process_file(
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 942, in process_file
    serialize_errors = DagFileProcessor.save_dag_to_db(
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/api_internal/internal_api_call.py", line 139, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/dag_processing/processor.py", line 982, in save_dag_to_db
    import_errors = DagBag._sync_to_db(dags=dags, processor_subdir=dag_directory, session=session)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 707, in _sync_to_db
    for attempt in run_with_db_retries(logger=log):
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 443, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/tenacity/__init__.py", line 398, in <lambda>
    self._add_action_func(lambda rs: rs.outcome.result())
                                     ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dagbag.py", line 723, in _sync_to_db
    DAG.bulk_write_to_db(dags.values(), processor_subdir=processor_subdir, session=session)
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/airflow/models/dag.py", line 3242, in bulk_write_to_db
    orm_dags: list[DagModel] = session.scalars(query).unique().all()
                               ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1778, in scalars
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 724, in _connection_for_bind
    self._assert_active()
  File "/home/kasten/.local/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 604, in _assert_active
    raise sa_exc.PendingRollbackError(
sqlalchemy.exc.PendingRollbackError: This Session's transaction has been rolled back due to a previous exception during flush. To begin a new transaction with this Session, first issue Session.rollback(). Original exception was: (sqlite3.IntegrityError) UNIQUE constraint failed: dag_tag.name, dag_tag.dag_id
[SQL: INSERT INTO dag_tag (name, dag_id) VALUES (?, ?)]
[parameters: (('dataset-time-based-timetable', 'conditional_dataset_and_time_based_timetable'), ('dataset-scheduled', 'dataset_consumes_1'), ('consumes', 'dataset_consumes_1'), ('dataset-scheduled', 'dataset_consumes_1_and_2'), ('consumes', 'dataset_consumes_1_and_2'), ('dataset-scheduled', 'dataset_consumes_1_never_scheduled'), ('consumes', 'dataset_consumes_1_never_scheduled'), ('dataset-scheduled', 'dataset_consumes_unknown_never_scheduled')  ... displaying 10 of 12 total bound parameter sets ...  ('produces', 'dataset_produces_2'), ('dataset-scheduled', 'dataset_produces_2'))]
(Background on this error at: https://sqlalche.me/e/14/gkpj) (Background on this error at: https://sqlalche.me/e/14/7s2a)
